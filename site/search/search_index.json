{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ChukMCPServer Documentation","text":"<p>Welcome to the ChukMCPServer documentation! ChukMCPServer is the fastest, most developer-friendly Model Context Protocol (MCP) server framework for Python.</p>"},{"location":"#what-is-chukmcpserver","title":"What is ChukMCPServer?","text":"<p>ChukMCPServer lets you build production-ready MCP servers in minutes with:</p> <ul> <li>Decorator-based API - Define tools with simple <code>@tool</code> decorators</li> <li>Zero Configuration - Smart defaults detect everything automatically</li> <li>World-Class Performance - 36,000+ requests/second, &lt;3ms overhead</li> <li>OAuth 2.1 Built-In - Full authentication with <code>@requires_auth</code></li> <li>Cloud Native - Auto-detects GCP, AWS, Azure, Vercel</li> <li>Dual Transport - STDIO (Claude Desktop) + HTTP (Web APIs)</li> </ul> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef add(a: int, b: int) -&gt; int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n\nrun()  # That's it! Production-ready server\n</code></pre>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li> <p>:material-rocket-launch: Getting Started</p> <p>Install ChukMCPServer and create your first server in 30 seconds</p> </li> <li> <p>:material-hammer-wrench: Building Tools</p> <p>Learn how to create powerful tools for Claude</p> </li> <li> <p>:material-shield-lock: OAuth &amp; Auth</p> <p>Add OAuth 2.1 authentication to your servers</p> </li> <li> <p>:material-cloud-upload: Deployment</p> <p>Deploy to production with HTTP, Docker, or cloud platforms</p> </li> <li> <p>:material-speedometer: Performance</p> <p>See benchmark results and optimization guides</p> </li> <li> <p>:material-code-braces: API Reference</p> <p>Complete API documentation</p> </li> </ul>"},{"location":"#features-at-a-glance","title":"Features at a Glance","text":""},{"location":"#core-features","title":"\ud83c\udfaf Core Features","text":"Feature Description @tool Define callable tools for Claude @resource Expose data and configurations @prompt Create reusable prompt templates @requires_auth Add OAuth protection to tools Context Management Track sessions and users Type Safety Automatic validation from type hints"},{"location":"#transport-modes","title":"\ud83d\ude80 Transport Modes","text":"Transport Use Case Performance STDIO Claude Desktop integration N/A (local) HTTP Web APIs, production deployment 36,000+ RPS"},{"location":"#cloud-support","title":"\u2601\ufe0f Cloud Support","text":"<p>Auto-detects and optimizes for:</p> <ul> <li>Google Cloud Platform (Cloud Functions, Cloud Run)</li> <li>AWS (Lambda, ECS, Fargate)</li> <li>Azure (Functions, Container Apps)</li> <li>Vercel, Netlify, Cloudflare Workers</li> <li>Docker, Kubernetes</li> </ul>"},{"location":"#oauth-21","title":"\ud83d\udd10 OAuth 2.1","text":"<p>Full OAuth 2.1 implementation with:</p> <ul> <li>PKCE support (RFC 7636)</li> <li>Authorization Server Discovery (RFC 8414)</li> <li>Protected Resource Metadata (RFC 9728)</li> <li>Built-in Google Drive provider</li> <li>Custom provider support</li> </ul>"},{"location":"#why-choose-chukmcpserver","title":"Why Choose ChukMCPServer?","text":"PerformanceDeveloper ExperienceProduction ReadyEcosystem <p>36,000+ requests/second with &lt;3ms overhead per tool call</p> <ul> <li>Built on uvloop and Starlette</li> <li>Pre-cached schema generation</li> <li>Optimized JSON-RPC handling</li> <li>Zero-copy operations where possible</li> </ul> <p>Write less code, ship faster</p> <ul> <li>Decorator-based API (FastAPI-style)</li> <li>Zero configuration required</li> <li>Automatic type validation</li> <li>Built-in scaffolder</li> </ul> <p>Deploy with confidence</p> <ul> <li>Cloud platform auto-detection</li> <li>OAuth 2.1 authentication</li> <li>Comprehensive error handling</li> <li>88% test coverage</li> </ul> <p>Integrates with everything</p> <ul> <li>Claude Desktop (zero config)</li> <li>HTTP APIs (REST-friendly)</li> <li>Docker &amp; Kubernetes</li> <li>Cloud platforms (GCP, AWS, Azure)</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Ready to build your first MCP server?</p> <ol> <li>Install ChukMCPServer - Get up and running in minutes</li> <li>Create Your First Server - Build a simple calculator</li> <li>Add to Claude Desktop - Connect to Claude</li> <li>Build Real Tools - Create production tools</li> </ol>"},{"location":"#example-servers","title":"Example Servers","text":"<p>See real-world examples:</p> <ul> <li>chuk-mcp-linkedin - LinkedIn OAuth integration</li> <li>chuk-mcp-stage - 3D scene management with Google Drive</li> </ul>"},{"location":"#community-support","title":"Community &amp; Support","text":"<ul> <li>GitHub Issues - Report bugs or request features</li> <li>GitHub Discussions - Ask questions</li> <li>Contributing Guide - Help improve ChukMCPServer</li> </ul>"},{"location":"#license","title":"License","text":"<p>ChukMCPServer is released under the MIT License.</p>"},{"location":"COMPOSITION/","title":"Server Composition &amp; Deployment","text":"<p>ChukMCPServer supports composing multiple MCP servers into a single unified server through configuration. This enables you to aggregate tools, resources, and prompts from multiple sources without writing code.</p>"},{"location":"COMPOSITION/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Quick Start</li> <li>Configuration</li> <li>Docker Deployment</li> <li>Composition Strategies</li> <li>Examples</li> </ul>"},{"location":"COMPOSITION/#quick-start","title":"Quick Start","text":""},{"location":"COMPOSITION/#1-configuration-only-deployment","title":"1. Configuration-Only Deployment","text":"<p>Create a <code>config.yaml</code> file:</p> <pre><code>server:\n  name: \"my-composed-server\"\n  transport: \"http\"\n  http:\n    host: \"0.0.0.0\"\n    port: 8000\n\ncomposition:\n  import:\n    - name: \"github\"\n      enabled: true\n      type: \"stdio\"\n      command: \"npx\"\n      args: [\"-y\", \"@modelcontextprotocol/server-github\"]\n      prefix: \"github\"\n      env:\n        GITHUB_PERSONAL_ACCESS_TOKEN: \"${GITHUB_TOKEN}\"\n\n    - name: \"weather\"\n      enabled: true\n      type: \"stdio\"\n      command: \"python\"\n      args: [\"-m\", \"mcp_server_weather\"]\n      prefix: \"weather\"\n</code></pre>"},{"location":"COMPOSITION/#2-deploy-with-docker","title":"2. Deploy with Docker","text":"<pre><code># One-time setup\n./deploy.sh setup\n\n# Edit .env with your credentials\nvim .env\n\n# Start the server\n./deploy.sh start\n\n# View logs\n./deploy.sh logs\n</code></pre> <p>Your composed server is now running at <code>http://localhost:8000</code> with tools from both GitHub and Weather servers!</p>"},{"location":"COMPOSITION/#configuration","title":"Configuration","text":""},{"location":"COMPOSITION/#server-section","title":"Server Section","text":"<pre><code>server:\n  name: \"my-server\"           # Server name\n  version: \"1.0.0\"            # Version\n  description: \"My Server\"    # Description\n  transport: \"http\"           # \"http\" or \"stdio\"\n\n  # HTTP configuration\n  http:\n    host: \"0.0.0.0\"\n    port: 8000\n    workers: 4\n\n  # STDIO configuration\n  stdio:\n    log_to_stderr: true\n</code></pre>"},{"location":"COMPOSITION/#composition-section","title":"Composition Section","text":"<p>The <code>composition</code> section defines how to combine multiple servers:</p>"},{"location":"COMPOSITION/#import-static-copy","title":"Import (Static Copy)","text":"<p>Import creates a one-time copy of components from another server. Changes to the source server after import won't be reflected.</p> <pre><code>composition:\n  import:\n    - name: \"github\"                    # Server identifier\n      enabled: true                     # Enable/disable\n      type: \"stdio\"                     # \"stdio\", \"http\", or \"sse\"\n      command: \"npx\"                    # Command to run\n      args: [\"-y\", \"@modelcontextprotocol/server-github\"]\n      prefix: \"github\"                  # Namespace prefix\n      components: [\"tools\", \"resources\"] # What to import\n      tags: [\"public\"]                  # Optional tag filtering\n      env:                              # Environment variables\n        GITHUB_PERSONAL_ACCESS_TOKEN: \"${GITHUB_TOKEN}\"\n</code></pre> <p>Supported Types: - <code>stdio</code>: Standard MCP protocol over stdin/stdout - <code>http</code>: HTTP-based MCP server - <code>sse</code>: Server-Sent Events transport</p>"},{"location":"COMPOSITION/#mount-dynamic-delegation","title":"Mount (Dynamic Delegation)","text":"<p>Mount creates a live link to another server. Changes are reflected in real-time.</p> <pre><code>composition:\n  mount:\n    - name: \"api_service\"\n      enabled: true\n      type: \"http\"\n      url: \"http://api.example.com/mcp\"\n      prefix: \"api\"\n      as_proxy: true\n      timeout: 30\n      headers:\n        Authorization: \"Bearer ${API_TOKEN}\"\n</code></pre>"},{"location":"COMPOSITION/#modules-section","title":"Modules Section","text":"<p>Load Python modules with tools directly:</p> <pre><code>modules:\n  math:\n    enabled: true\n    location: \"./modules\"\n    module: \"math_tools.tools\"\n    namespace: \"math\"\n\n  database:\n    enabled: false\n    location: \"./modules\"\n    module: \"db_tools.tools\"\n    namespace: \"db\"\n</code></pre>"},{"location":"COMPOSITION/#logging-section","title":"Logging Section","text":"<pre><code>logging:\n  level: \"INFO\"  # DEBUG, INFO, WARNING, ERROR\n  format: \"%(asctime)s - %(name)s - %(levelname)s - %(message)s\"\n\n  # Per-logger configuration\n  loggers:\n    \"chuk_mcp_server.proxy\": \"WARNING\"\n    \"chuk_mcp_server.composition\": \"INFO\"\n</code></pre>"},{"location":"COMPOSITION/#docker-deployment","title":"Docker Deployment","text":""},{"location":"COMPOSITION/#single-server","title":"Single Server","text":"<pre><code># Build and start\ndocker-compose up -d mcp-server\n\n# View logs\ndocker-compose logs -f mcp-server\n\n# Stop\ndocker-compose down\n</code></pre>"},{"location":"COMPOSITION/#multiple-profiles","title":"Multiple Profiles","text":"<pre><code># Production with Nginx\ndocker-compose --profile production up -d\n\n# Development with hot reload\ndocker-compose --profile dev up\n\n# With Redis cache\ndocker-compose --profile cache up -d\n</code></pre>"},{"location":"COMPOSITION/#custom-dockerfile-build","title":"Custom Dockerfile Build","text":"<pre><code># Build\ndocker build -t my-mcp-server .\n\n# Run\ndocker run -d \\\n  -p 8000:8000 \\\n  -v $(pwd)/config.yaml:/app/config.yaml \\\n  -v $(pwd)/.env:/app/.env \\\n  --name mcp-server \\\n  my-mcp-server\n</code></pre>"},{"location":"COMPOSITION/#composition-strategies","title":"Composition Strategies","text":""},{"location":"COMPOSITION/#1-aggregation-pattern","title":"1. Aggregation Pattern","text":"<p>Combine multiple specialized servers into one unified API:</p> <pre><code>composition:\n  import:\n    - name: \"github\"\n      prefix: \"github\"\n      ...\n    - name: \"slack\"\n      prefix: \"slack\"\n      ...\n    - name: \"notion\"\n      prefix: \"notion\"\n      ...\n</code></pre> <p>Result: Single server with <code>github.*</code>, <code>slack.*</code>, and <code>notion.*</code> tools.</p>"},{"location":"COMPOSITION/#2-gateway-pattern","title":"2. Gateway Pattern","text":"<p>Mount remote servers as proxy for centralized access:</p> <pre><code>composition:\n  mount:\n    - name: \"team_a_server\"\n      url: \"http://team-a.internal:8000\"\n      prefix: \"team_a\"\n      as_proxy: true\n\n    - name: \"team_b_server\"\n      url: \"http://team-b.internal:8000\"\n      prefix: \"team_b\"\n      as_proxy: true\n</code></pre> <p>Result: Gateway server that delegates to team servers.</p>"},{"location":"COMPOSITION/#3-hybrid-pattern","title":"3. Hybrid Pattern","text":"<p>Mix imported and mounted servers:</p> <pre><code>composition:\n  import:\n    # Static servers (stable, version-controlled)\n    - name: \"core_tools\"\n      type: \"stdio\"\n      ...\n\n  mount:\n    # Dynamic servers (frequently updated)\n    - name: \"experimental_features\"\n      url: \"http://dev.internal:8000\"\n      as_proxy: true\n</code></pre>"},{"location":"COMPOSITION/#examples","title":"Examples","text":""},{"location":"COMPOSITION/#example-1-developer-productivity-suite","title":"Example 1: Developer Productivity Suite","text":"<p>Combine GitHub, Slack, and Jira:</p> <pre><code>server:\n  name: \"dev-productivity\"\n  transport: \"http\"\n\ncomposition:\n  import:\n    - name: \"github\"\n      type: \"stdio\"\n      command: \"npx\"\n      args: [\"-y\", \"@modelcontextprotocol/server-github\"]\n      prefix: \"github\"\n      env:\n        GITHUB_PERSONAL_ACCESS_TOKEN: \"${GITHUB_TOKEN}\"\n\n    - name: \"slack\"\n      type: \"stdio\"\n      command: \"npx\"\n      args: [\"-y\", \"@modelcontextprotocol/server-slack\"]\n      prefix: \"slack\"\n      env:\n        SLACK_BOT_TOKEN: \"${SLACK_TOKEN}\"\n\nmodules:\n  jira:\n    enabled: true\n    location: \"./modules\"\n    module: \"jira_tools.tools\"\n    namespace: \"jira\"\n</code></pre> <p>Deploy:</p> <pre><code># Set tokens in .env\nexport GITHUB_TOKEN=ghp_yourtoken\nexport SLACK_TOKEN=xoxb-yourtoken\n\n# Start\n./deploy.sh start\n</code></pre>"},{"location":"COMPOSITION/#example-2-multi-region-api-gateway","title":"Example 2: Multi-Region API Gateway","text":"<pre><code>server:\n  name: \"api-gateway\"\n  transport: \"http\"\n\ncomposition:\n  mount:\n    - name: \"us_east\"\n      url: \"http://us-east-api.internal\"\n      prefix: \"us_east\"\n      as_proxy: true\n\n    - name: \"eu_west\"\n      url: \"http://eu-west-api.internal\"\n      prefix: \"eu_west\"\n      as_proxy: true\n\n    - name: \"ap_south\"\n      url: \"http://ap-south-api.internal\"\n      prefix: \"ap_south\"\n      as_proxy: true\n</code></pre>"},{"location":"COMPOSITION/#example-3-microservices-aggregator","title":"Example 3: Microservices Aggregator","text":"<pre><code>composition:\n  mount:\n    - name: \"user_service\"\n      url: \"http://users:8000\"\n      prefix: \"users\"\n\n    - name: \"payment_service\"\n      url: \"http://payments:8000\"\n      prefix: \"payments\"\n\n    - name: \"notification_service\"\n      url: \"http://notifications:8000\"\n      prefix: \"notifications\"\n</code></pre>"},{"location":"COMPOSITION/#environment-variables","title":"Environment Variables","text":"<p>Use <code>${VAR_NAME}</code> syntax in configuration:</p> <pre><code>composition:\n  import:\n    - name: \"github\"\n      env:\n        GITHUB_PERSONAL_ACCESS_TOKEN: \"${GITHUB_TOKEN}\"\n        API_URL: \"${GITHUB_API_URL:-https://api.github.com}\"\n</code></pre> <p>Create <code>.env</code> file:</p> <pre><code>GITHUB_TOKEN=ghp_yourtoken\nGITHUB_API_URL=https://api.github.com\n</code></pre>"},{"location":"COMPOSITION/#programmatic-usage","title":"Programmatic Usage","text":"<p>Use the composition API in Python:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.composition import load_from_config\n\n# Create server\nmcp = ChukMCPServer()\n\n# Load composition from config\nconfig, stats = load_from_config(\"config.yaml\", mcp.composition)\n\nprint(f\"Loaded: {stats}\")\n# {\"imported\": 2, \"mounted\": 1, \"modules\": 1}\n\n# Run server\nmcp.run()\n</code></pre>"},{"location":"COMPOSITION/#best-practices","title":"Best Practices","text":""},{"location":"COMPOSITION/#1-namespacing","title":"1. Namespacing","text":"<p>Always use prefixes to avoid name collisions:</p> <pre><code>composition:\n  import:\n    - name: \"github\"\n      prefix: \"github\"  # Tools: github.create_issue\n\n    - name: \"gitlab\"\n      prefix: \"gitlab\"  # Tools: gitlab.create_issue\n</code></pre>"},{"location":"COMPOSITION/#2-security","title":"2. Security","text":"<ul> <li>Store secrets in <code>.env</code> files</li> <li>Never commit <code>.env</code> to version control</li> <li>Use environment-specific configurations</li> </ul> <pre><code># Production config.yaml\ncomposition:\n  import:\n    - name: \"github\"\n      env:\n        GITHUB_TOKEN: \"${PROD_GITHUB_TOKEN}\"\n\n# Development config.yaml\ncomposition:\n  import:\n    - name: \"github\"\n      env:\n        GITHUB_TOKEN: \"${DEV_GITHUB_TOKEN}\"\n</code></pre>"},{"location":"COMPOSITION/#3-resource-management","title":"3. Resource Management","text":"<p>Enable only what you need:</p> <pre><code>composition:\n  import:\n    - name: \"large_server\"\n      enabled: false  # Disable when not needed\n      components: [\"tools\"]  # Only import tools, not resources\n</code></pre>"},{"location":"COMPOSITION/#4-health-monitoring","title":"4. Health Monitoring","text":"<p>Use health checks in production:</p> <pre><code># docker-compose.yaml\nservices:\n  mcp-server:\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n</code></pre>"},{"location":"COMPOSITION/#troubleshooting","title":"Troubleshooting","text":""},{"location":"COMPOSITION/#server-wont-start","title":"Server Won't Start","text":"<ol> <li> <p>Check configuration syntax:    <pre><code>python -c \"import yaml; yaml.safe_load(open('config.yaml'))\"\n</code></pre></p> </li> <li> <p>Check logs:    <pre><code>./deploy.sh logs\n</code></pre></p> </li> <li> <p>Verify environment variables:    <pre><code>grep -v '^#' .env | grep -v '^$'\n</code></pre></p> </li> </ol>"},{"location":"COMPOSITION/#tool-not-found","title":"Tool Not Found","text":"<ol> <li>Check prefix is correct</li> <li>Verify server is enabled in config</li> <li>Check import/mount succeeded in logs</li> </ol>"},{"location":"COMPOSITION/#connection-issues","title":"Connection Issues","text":"<ol> <li>Verify URL is accessible</li> <li>Check firewall rules</li> <li>Verify credentials in <code>.env</code></li> </ol>"},{"location":"COMPOSITION/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Reference</li> <li>Security Guide</li> <li>Performance Tuning</li> <li>Examples</li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/","title":"Context Architecture for chuk-mcp-server","text":""},{"location":"CONTEXT_ARCHITECTURE/#overview","title":"Overview","text":"<p>The context management system provides thread-safe, async-safe storage for request-scoped data across the MCP server framework and consumer applications.</p>"},{"location":"CONTEXT_ARCHITECTURE/#architecture-layers","title":"Architecture Layers","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Consumer Applications (chuk-mcp-linkedin, etc.)             \u2502\n\u2502 \u251c\u2500 Import: from chuk_mcp_server import require_user_id     \u2502\n\u2502 \u2514\u2500 Usage: user_id = require_user_id()                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u25b2\n                            \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 chuk-mcp-server Framework                                   \u2502\n\u2502 \u251c\u2500 context.py: Generic context management                  \u2502\n\u2502 \u2502  \u251c\u2500 Session ID (MCP session)                            \u2502\n\u2502 \u2502  \u251c\u2500 User ID (OAuth user)                                \u2502\n\u2502 \u2502  \u251c\u2500 Progress Token                                       \u2502\n\u2502 \u2502  \u2514\u2500 Metadata                                             \u2502\n\u2502 \u2514\u2500 protocol.py: Sets context on each request              \u2502\n\u2502    \u251c\u2500 set_session_id() on initialize                      \u2502\n\u2502    \u2514\u2500 set_user_id() after OAuth validation                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u25b2\n                            \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Python contextvars (stdlib)                                 \u2502\n\u2502 \u2514\u2500 Thread-safe, async-safe context isolation               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#context-variables","title":"Context Variables","text":""},{"location":"CONTEXT_ARCHITECTURE/#session-context","title":"Session Context","text":"<ul> <li>Purpose: Identify the MCP session</li> <li>Set by: Protocol handler during initialization</li> <li>Used by: Server infrastructure, logging, session management</li> <li>Functions: <code>get_session_id()</code>, <code>set_session_id()</code>, <code>require_session_id()</code></li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#user-context","title":"User Context","text":"<ul> <li>Purpose: Identify the authenticated OAuth user</li> <li>Set by: Protocol handler after OAuth token validation</li> <li>Used by: Consumer tools/resources that need user-specific data</li> <li>Functions: <code>get_user_id()</code>, <code>set_user_id()</code>, <code>require_user_id()</code></li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#progress-token","title":"Progress Token","text":"<ul> <li>Purpose: Enable progress notifications to clients</li> <li>Set by: Protocol handler from request params</li> <li>Used by: Long-running tools to report progress</li> <li>Functions: <code>get_progress_token()</code>, <code>set_progress_token()</code></li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#metadata","title":"Metadata","text":"<ul> <li>Purpose: Store arbitrary request-scoped data</li> <li>Set by: Any layer that needs to pass context</li> <li>Used by: Extensions, middleware, custom features</li> <li>Functions: <code>get_metadata()</code>, <code>set_metadata()</code>, <code>update_metadata()</code></li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#usage-patterns","title":"Usage Patterns","text":""},{"location":"CONTEXT_ARCHITECTURE/#in-protocol-handler-chuk-mcp-server","title":"In Protocol Handler (chuk-mcp-server)","text":"<pre><code># protocol.py\nfrom .context import set_session_id, set_user_id\n\nasync def handle_request(self, message, session_id=None, oauth_token=None):\n    # Set session context\n    if session_id:\n        set_session_id(session_id)\n\n    # After OAuth validation\n    if user_id:\n        set_user_id(user_id)\n\n    # Handle request...\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#in-consumer-tools-chuk-mcp-linkedin","title":"In Consumer Tools (chuk-mcp-linkedin)","text":"<pre><code># LinkedIn tool\nfrom chuk_mcp_server import require_user_id, get_session_id\n\n@mcp.tool()\nasync def create_linkedin_post(content: str):\n    # Require authentication\n    user_id = require_user_id()  # Raises PermissionError if not authenticated\n\n    # Optional: get session for logging\n    session_id = get_session_id()  # Returns None if not in session\n\n    # Use user-scoped manager\n    manager = get_manager_for_user(user_id)\n    return manager.create_draft(content)\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#with-context-manager-for-complex-scenarios","title":"With Context Manager (for complex scenarios)","text":"<pre><code>from chuk_mcp_server import RequestContext\n\nasync with RequestContext(\n    session_id=\"abc123\",\n    user_id=\"user456\",\n    progress_token=1,\n    metadata={\"source\": \"api\"}\n):\n    # Context is set for this block\n    await handle_tool_call()\n    # Context is automatically restored on exit\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#comparison-with-chuk-mcp-runtime","title":"Comparison with chuk-mcp-runtime","text":"<p>The <code>chuk-mcp-server</code> context is inspired by <code>chuk-mcp-runtime</code> but adapted for the server framework:</p>"},{"location":"CONTEXT_ARCHITECTURE/#similarities","title":"Similarities","text":"<ul> <li>Both use Python <code>contextvars</code> for thread/async safety</li> <li>Both provide context manager pattern for lifecycle management</li> <li>Both support nested contexts with restoration</li> <li>Both include progress notification support</li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#differences","title":"Differences","text":"<ul> <li>chuk-mcp-server: Generic server framework (session + user + metadata)</li> <li>chuk-mcp-runtime: Client runtime focused on progress notifications</li> <li>chuk-mcp-server: Provides <code>require_user_id()</code> for auth enforcement</li> <li>chuk-mcp-runtime: Provides <code>send_progress()</code> convenience function</li> </ul>"},{"location":"CONTEXT_ARCHITECTURE/#migration-from-chuk-mcp-linkedinauth","title":"Migration from chuk-mcp-linkedin.auth","text":"<p>Consumer applications should migrate from local auth context to generic server context:</p>"},{"location":"CONTEXT_ARCHITECTURE/#before-chuk-mcp-linkedin-specific","title":"Before (chuk-mcp-linkedin specific)","text":"<pre><code>from chuk_mcp_linkedin.auth import get_current_user_id, set_current_user\n\nuser_id = get_current_user_id()\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#after-generic-chuk-mcp-server","title":"After (generic chuk-mcp-server)","text":"<pre><code>from chuk_mcp_server import require_user_id, set_user_id\n\nuser_id = require_user_id()\n</code></pre>"},{"location":"CONTEXT_ARCHITECTURE/#benefits","title":"Benefits","text":"<ol> <li>Generic: Reusable across all chuk-mcp consumer applications</li> <li>Consistent: Same patterns as chuk-mcp-runtime</li> <li>Type-safe: Full type hints and IDE support</li> <li>Thread-safe: Built on contextvars stdlib</li> <li>Async-safe: Works correctly with async/await</li> <li>Nestable: Supports nested contexts with proper restoration</li> <li>Extensible: Metadata system for custom data</li> </ol>"},{"location":"CONTEXT_ARCHITECTURE/#future-enhancements","title":"Future Enhancements","text":"<p>Potential additions to consider:</p> <ol> <li>Progress notifications: Add <code>send_progress()</code> helper (like chuk-mcp-runtime)</li> <li>Request ID: Add unique ID for each request for tracing</li> <li>Timing: Add request start time for performance tracking</li> <li>Cancellation: Add cancellation token support</li> <li>Logging: Add structured logging context helpers</li> </ol>"},{"location":"MCP_CLIENT_SETUP/","title":"MCP Client Setup Guide","text":"<p>This guide shows how to configure ChukMCPServer with various MCP clients using both stdio and HTTP transport modes.</p>"},{"location":"MCP_CLIENT_SETUP/#quick-start-with-uvx","title":"Quick Start with uvx","text":"<p>The easiest way to run ChukMCPServer is using <code>uvx</code> (comes with <code>uv</code>):</p> <pre><code># Install uv if you haven't already\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Run in STDIO mode (for MCP clients)\nuvx chuk-mcp-server stdio\n\n# Run in HTTP mode with SSE streaming\nuvx chuk-mcp-server http\n\n# Run on a specific port\nuvx chuk-mcp-server http --port 9000\n\n# Run with debug logging\nuvx chuk-mcp-server stdio --debug\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#claude-desktop-configuration","title":"Claude Desktop Configuration","text":""},{"location":"MCP_CLIENT_SETUP/#stdio-mode-recommended-for-claude-desktop","title":"STDIO Mode (Recommended for Claude Desktop)","text":"<p>Add to your Claude Desktop configuration file:</p> <p>macOS: <code>~/Library/Application Support/Claude/claude_desktop_config.json</code> Windows: <code>%APPDATA%\\Claude\\claude_desktop_config.json</code> Linux: <code>~/.config/claude/claude_desktop_config.json</code></p> <pre><code>{\n  \"mcpServers\": {\n    \"chuk-mcp\": {\n      \"command\": \"uvx\",\n      \"args\": [\"chuk-mcp-server\", \"stdio\"],\n      \"env\": {\n        \"MCP_SERVER_NAME\": \"chuk-mcp-production\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#with-custom-tools","title":"With Custom Tools","text":"<p>Create a Python file <code>my_tools.py</code>:</p> <pre><code>#!/usr/bin/env python3\nfrom chuk_mcp_server import ChukMCPServer\n\n# Create server\nmcp = ChukMCPServer(name=\"my-tools\")\n\n# Add your custom tools\n@mcp.tool\ndef search_files(pattern: str, directory: str = \".\") -&gt; list[str]:\n    \"\"\"Search for files matching a pattern.\"\"\"\n    import glob\n    import os\n    search_path = os.path.join(directory, \"**\", pattern)\n    return glob.glob(search_path, recursive=True)\n\n@mcp.tool\ndef read_file(filepath: str) -&gt; str:\n    \"\"\"Read contents of a file.\"\"\"\n    with open(filepath, 'r') as f:\n        return f.read()\n\n@mcp.tool\ndef write_file(filepath: str, content: str) -&gt; str:\n    \"\"\"Write content to a file.\"\"\"\n    with open(filepath, 'w') as f:\n        f.write(content)\n    return f\"Written {len(content)} bytes to {filepath}\"\n\n# Run in stdio mode\nif __name__ == \"__main__\":\n    import sys\n    import os\n    # Check if running via stdio\n    if not sys.stdin.isatty() or os.environ.get(\"MCP_STDIO\"):\n        mcp.run(stdio=True)\n    else:\n        mcp.run()  # HTTP mode for testing\n</code></pre> <p>Then configure Claude Desktop:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-tools\": {\n      \"command\": \"python\",\n      \"args\": [\"/path/to/my_tools.py\"],\n      \"env\": {\n        \"MCP_STDIO\": \"1\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#http-mode-configuration","title":"HTTP Mode Configuration","text":""},{"location":"MCP_CLIENT_SETUP/#for-web-based-mcp-clients","title":"For Web-based MCP Clients","text":"<pre><code>{\n  \"mcpServers\": {\n    \"chuk-mcp-http\": {\n      \"url\": \"http://localhost:8000/mcp\",\n      \"transport\": \"http\",\n      \"streaming\": true\n    }\n  }\n}\n</code></pre> <p>Start the server:</p> <pre><code># Using uvx\nuvx chuk-mcp-server http --port 8000\n\n# Or run in background\nnohup uvx chuk-mcp-server http --port 8000 &gt; server.log 2&gt;&amp;1 &amp;\n\n# Or using systemd (see below)\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#advanced-configurations","title":"Advanced Configurations","text":""},{"location":"MCP_CLIENT_SETUP/#multiple-servers-with-different-modes","title":"Multiple Servers with Different Modes","text":"<pre><code>{\n  \"mcpServers\": {\n    \"chuk-stdio\": {\n      \"command\": \"uvx\",\n      \"args\": [\"chuk-mcp-server\", \"stdio\"],\n      \"env\": {\n        \"MCP_SERVER_NAME\": \"stdio-server\"\n      }\n    },\n    \"chuk-http\": {\n      \"url\": \"http://localhost:8000/mcp\",\n      \"transport\": \"http\"\n    },\n    \"custom-tools\": {\n      \"command\": \"python\",\n      \"args\": [\"/home/user/my_mcp_tools.py\"],\n      \"env\": {\n        \"MCP_STDIO\": \"1\",\n        \"PYTHONPATH\": \"/home/user/libs\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#docker-container","title":"Docker Container","text":"<pre><code>FROM python:3.11-slim\n\nRUN pip install --no-cache-dir chuk-mcp-server\n\n# For STDIO mode\nCMD [\"chuk-mcp-server\", \"stdio\"]\n\n# For HTTP mode\n# CMD [\"chuk-mcp-server\", \"http\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\n</code></pre> <p>Run with Docker:</p> <pre><code># STDIO mode\ndocker run -i chuk-mcp\n\n# HTTP mode\ndocker run -p 8000:8000 chuk-mcp chuk-mcp-server http --host 0.0.0.0\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#systemd-service-http-mode","title":"Systemd Service (HTTP Mode)","text":"<p>Create <code>/etc/systemd/system/chuk-mcp.service</code>:</p> <pre><code>[Unit]\nDescription=ChukMCP Server\nAfter=network.target\n\n[Service]\nType=simple\nUser=www-data\nWorkingDirectory=/var/lib/chuk-mcp\nExecStart=/usr/local/bin/uvx chuk-mcp-server http --port 8000\nRestart=always\nRestartSec=10\nEnvironment=\"MCP_SERVER_NAME=production-mcp\"\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Enable and start:</p> <pre><code>sudo systemctl enable chuk-mcp\nsudo systemctl start chuk-mcp\nsudo systemctl status chuk-mcp\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#environment-variables","title":"Environment Variables","text":"<p>Configure the server behavior using environment variables:</p> <pre><code># Server identification\nexport MCP_SERVER_NAME=\"my-custom-server\"\nexport MCP_SERVER_VERSION=\"1.0.0\"\n\n# Force transport mode\nexport MCP_TRANSPORT=\"stdio\"  # or \"http\"\nexport MCP_STDIO=1            # Force stdio mode\nexport USE_STDIO=1            # Alternative to MCP_STDIO\n\n# Performance tuning (HTTP mode)\nexport MCP_WORKERS=8\nexport MCP_MAX_CONNECTIONS=5000\nexport MCP_PERFORMANCE_MODE=\"high_performance\"\n\n# Run with configuration\nuvx chuk-mcp-server auto\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#testing-your-configuration","title":"Testing Your Configuration","text":""},{"location":"MCP_CLIENT_SETUP/#test-stdio-mode","title":"Test STDIO Mode","text":"<pre><code># Test with a simple request\necho '{\"jsonrpc\":\"2.0\",\"method\":\"tools/list\",\"id\":1}' | uvx chuk-mcp-server stdio\n\n# Expected output (on stdout):\n# {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"tools\":[...]}}\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#test-http-mode","title":"Test HTTP Mode","text":"<pre><code># Start server\nuvx chuk-mcp-server http --port 8000 &amp;\n\n# Test health endpoint\ncurl http://localhost:8000/health\n\n# Test MCP endpoint\ncurl -X POST http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jsonrpc\":\"2.0\",\"method\":\"tools/list\",\"id\":1}'\n\n# Test SSE streaming\ncurl -N -H \"Accept: text/event-stream\" \\\n  -X POST http://localhost:8000/mcp \\\n  -d '{\"jsonrpc\":\"2.0\",\"method\":\"initialize\",\"params\":{\"clientInfo\":{\"name\":\"test\"}},\"id\":1}'\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#platform-specific-examples","title":"Platform-Specific Examples","text":""},{"location":"MCP_CLIENT_SETUP/#macos-with-homebrew","title":"macOS with Homebrew","text":"<pre><code># Install uv\nbrew install uv\n\n# Add to Claude Desktop config\ncat &lt;&lt; 'EOF' &gt; ~/Library/Application\\ Support/Claude/claude_desktop_config.json\n{\n  \"mcpServers\": {\n    \"chuk\": {\n      \"command\": \"uvx\",\n      \"args\": [\"chuk-mcp-server\", \"stdio\"]\n    }\n  }\n}\nEOF\n\n# Restart Claude Desktop\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#windows-with-powershell","title":"Windows with PowerShell","text":"<pre><code># Install uv\nirm https://astral.sh/uv/install.ps1 | iex\n\n# Add to Claude Desktop config\n$config = @{\n  mcpServers = @{\n    chuk = @{\n      command = \"uvx\"\n      args = @(\"chuk-mcp-server\", \"stdio\")\n    }\n  }\n}\n$config | ConvertTo-Json | Set-Content \"$env:APPDATA\\Claude\\claude_desktop_config.json\"\n\n# Restart Claude Desktop\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#linux","title":"Linux","text":"<pre><code># Install uv\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Add to config\nmkdir -p ~/.config/claude\ncat &lt;&lt; 'EOF' &gt; ~/.config/claude/claude_desktop_config.json\n{\n  \"mcpServers\": {\n    \"chuk\": {\n      \"command\": \"uvx\",\n      \"args\": [\"chuk-mcp-server\", \"stdio\"]\n    }\n  }\n}\nEOF\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#troubleshooting","title":"Troubleshooting","text":""},{"location":"MCP_CLIENT_SETUP/#check-if-server-is-working","title":"Check if server is working","text":"<pre><code># STDIO mode test\necho '{\"jsonrpc\":\"2.0\",\"method\":\"initialize\",\"params\":{\"clientInfo\":{\"name\":\"test\"}},\"id\":1}' | \\\n  uvx chuk-mcp-server stdio 2&gt;/dev/null | jq .\n\n# HTTP mode test\nuvx chuk-mcp-server http --port 8000 &amp;\nsleep 2\ncurl -s http://localhost:8000/health | jq .\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#enable-debug-logging","title":"Enable debug logging","text":"<pre><code># STDIO mode with debug\nuvx chuk-mcp-server stdio --debug\n\n# HTTP mode with debug  \nuvx chuk-mcp-server http --debug --port 8000\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#common-issues","title":"Common Issues","text":"<ol> <li> <p>\"command not found: uvx\" - Install uv first: <code>curl -LsSf https://astral.sh/uv/install.sh | sh</code></p> </li> <li> <p>\"Connection refused\" in HTTP mode - Check if port is already in use: <code>lsof -i :8000</code></p> </li> <li> <p>No output in STDIO mode - Make sure to set <code>MCP_STDIO=1</code> or use the <code>stdio</code> subcommand</p> </li> <li> <p>Claude Desktop not connecting - Check config file location and JSON syntax</p> </li> </ol>"},{"location":"MCP_CLIENT_SETUP/#performance-tips","title":"Performance Tips","text":""},{"location":"MCP_CLIENT_SETUP/#for-high-volume-usage","title":"For High-Volume Usage","text":"<pre><code># HTTP mode with performance settings\nMCP_PERFORMANCE_MODE=high_performance \\\nMCP_WORKERS=8 \\\nMCP_MAX_CONNECTIONS=10000 \\\nuvx chuk-mcp-server http --port 8000\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#for-low-latency-requirements","title":"For Low-Latency Requirements","text":"<pre><code># STDIO mode (lowest latency)\nuvx chuk-mcp-server stdio\n</code></pre>"},{"location":"MCP_CLIENT_SETUP/#for-production-deployment","title":"For Production Deployment","text":"<pre><code># HTTP mode with monitoring\nuvx chuk-mcp-server http --port 8000 2&gt;&amp;1 | \\\n  tee -a /var/log/mcp-server.log | \\\n  grep -E \"(ERROR|WARNING)\" | \\\n  mail -s \"MCP Server Alert\" admin@example.com\n</code></pre>"},{"location":"OAUTH/","title":"OAuth 2.1 Support","text":"<p>ChukMCPServer provides a complete OAuth 2.1 authorization server implementation with support for external OAuth providers (LinkedIn, GitHub, Google, etc.).</p>"},{"location":"OAUTH/#features","title":"Features","text":"<ul> <li>OAuth 2.1 compliant with PKCE (RFC 7636)</li> <li>Dynamic client registration (RFC 7591)</li> <li>Pluggable provider support - Integrate any OAuth provider</li> <li>Session-based token storage via chuk-sessions</li> <li>Production-ready - Memory backend for dev, Redis for production</li> <li>Multi-tenant - Sandbox isolation for token storage</li> </ul>"},{"location":"OAUTH/#quick-start","title":"Quick Start","text":""},{"location":"OAUTH/#1-install-dependencies","title":"1. Install Dependencies","text":"<pre><code># OAuth support is built into chuk-mcp-server\npip install chuk-mcp-server\n\n# For production, install Redis backend\npip install chuk-sessions[redis]\n</code></pre>"},{"location":"OAUTH/#2-implement-your-oauth-provider","title":"2. Implement Your OAuth Provider","text":"<p>Create a provider that implements <code>BaseOAuthProvider</code>:</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider, TokenStore\nfrom typing import Dict, Any, Optional\n\nclass MyOAuthProvider(BaseOAuthProvider):\n    \"\"\"OAuth provider for MyService.\"\"\"\n\n    def __init__(\n        self,\n        client_id: str,\n        client_secret: str,\n        redirect_uri: str,\n        oauth_server_url: str = \"http://localhost:8000\",\n        sandbox_id: str = \"my-service\",\n    ):\n        self.oauth_server_url = oauth_server_url\n        self.token_store = TokenStore(sandbox_id=sandbox_id)\n\n        # Initialize your service's OAuth client\n        self.service_client = MyServiceOAuthClient(\n            client_id=client_id,\n            client_secret=client_secret,\n            redirect_uri=redirect_uri,\n        )\n\n        # Track pending authorization flows\n        self._pending_authorizations: Dict[str, Dict[str, Any]] = {}\n\n    async def authorize(self, params) -&gt; Dict[str, Any]:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        # Validate MCP client\n        if not await self.token_store.validate_client(\n            params.client_id,\n            redirect_uri=params.redirect_uri,\n        ):\n            raise AuthorizeError(\n                error=\"invalid_client\",\n                error_description=\"Invalid client_id or redirect_uri\",\n            )\n\n        # Check if user already has token\n        # ... implementation ...\n\n        # Need external authorization - redirect to your service\n        import secrets\n        state = secrets.token_urlsafe(32)\n\n        # Store pending authorization details\n        self._pending_authorizations[state] = {\n            \"mcp_client_id\": params.client_id,\n            \"mcp_redirect_uri\": params.redirect_uri,\n            \"mcp_state\": params.state,\n            \"mcp_scope\": params.scope,\n            \"mcp_code_challenge\": params.code_challenge,\n            \"mcp_code_challenge_method\": params.code_challenge_method,\n        }\n\n        # Generate authorization URL for your service\n        auth_url = self.service_client.get_authorization_url(state=state)\n\n        return {\n            \"authorization_url\": auth_url,\n            \"state\": state,\n            \"requires_external_authorization\": True,\n        }\n\n    async def handle_external_callback(\n        self,\n        code: str,\n        state: str,\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Handle callback from external service.\"\"\"\n        # Get pending authorization\n        pending = self._pending_authorizations.get(state)\n        if not pending:\n            raise ValueError(\"Invalid or expired state parameter\")\n\n        # Exchange service code for token\n        service_token = await self.service_client.exchange_code_for_token(code)\n\n        # Get user info\n        user_info = await self.service_client.get_user_info(\n            service_token[\"access_token\"]\n        )\n        user_id = user_info[\"sub\"]\n\n        # Store service token\n        await self.token_store.link_external_token(\n            user_id=user_id,\n            access_token=service_token[\"access_token\"],\n            refresh_token=service_token.get(\"refresh_token\"),\n            expires_in=service_token.get(\"expires_in\", 3600),\n        )\n\n        # Create MCP authorization code\n        mcp_code = await self.token_store.create_authorization_code(\n            user_id=user_id,\n            client_id=pending[\"mcp_client_id\"],\n            redirect_uri=pending[\"mcp_redirect_uri\"],\n            scope=pending[\"mcp_scope\"],\n            code_challenge=pending[\"mcp_code_challenge\"],\n            code_challenge_method=pending[\"mcp_code_challenge_method\"],\n        )\n\n        # Clean up\n        del self._pending_authorizations[state]\n\n        return {\n            \"code\": mcp_code,\n            \"state\": pending[\"mcp_state\"],\n            \"redirect_uri\": pending[\"mcp_redirect_uri\"],\n        }\n\n    # Implement other required methods:\n    # - exchange_authorization_code\n    # - exchange_refresh_token\n    # - validate_access_token\n    # - register_client\n</code></pre>"},{"location":"OAUTH/#3-add-oauth-middleware-to-your-server","title":"3. Add OAuth Middleware to Your Server","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.oauth import OAuthMiddleware\n\n# Create your MCP server\nmcp = ChukMCPServer(\"my-service\")\n\n# ... register your tools ...\n\ndef setup_oauth():\n    \"\"\"Set up OAuth middleware.\"\"\"\n    # Create your OAuth provider\n    provider = MyOAuthProvider(\n        client_id=\"your_service_client_id\",\n        client_secret=\"your_service_client_secret\",\n        redirect_uri=\"http://localhost:8000/oauth/callback\",\n        oauth_server_url=\"http://localhost:8000\",\n    )\n\n    # Add OAuth middleware\n    oauth = OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        callback_path=\"/oauth/callback\",\n        scopes_supported=[\n            \"your.scope.1\",\n            \"your.scope.2\",\n        ],\n        service_documentation=\"https://github.com/yourusername/your-mcp-server\",\n        provider_name=\"Your Service Name\",\n    )\n\n    return oauth\n\n# Run server with OAuth\nmcp.run(\n    host=\"0.0.0.0\",\n    port=8000,\n    post_register_hook=setup_oauth,\n)\n</code></pre>"},{"location":"OAUTH/#oauth-endpoints","title":"OAuth Endpoints","text":"<p>When OAuth is enabled, these endpoints are automatically registered:</p>"},{"location":"OAUTH/#discovery-endpoint","title":"Discovery Endpoint","text":"<pre><code>GET /.well-known/oauth-authorization-server\n</code></pre> <p>Returns OAuth server metadata (RFC 8414): <pre><code>{\n  \"issuer\": \"http://localhost:8000\",\n  \"authorization_endpoint\": \"http://localhost:8000/oauth/authorize\",\n  \"token_endpoint\": \"http://localhost:8000/oauth/token\",\n  \"registration_endpoint\": \"http://localhost:8000/oauth/register\",\n  \"grant_types_supported\": [\"authorization_code\", \"refresh_token\"],\n  \"response_types_supported\": [\"code\"],\n  \"code_challenge_methods_supported\": [\"S256\", \"plain\"],\n  \"scopes_supported\": [\"your.scope.1\", \"your.scope.2\"]\n}\n</code></pre></p>"},{"location":"OAUTH/#authorization-endpoint","title":"Authorization Endpoint","text":"<pre><code>GET /oauth/authorize?client_id={id}&amp;redirect_uri={uri}&amp;response_type=code&amp;code_challenge={challenge}&amp;code_challenge_method=S256&amp;state={state}\n</code></pre> <p>Initiates OAuth flow. May redirect to external provider for authentication.</p>"},{"location":"OAUTH/#token-endpoint","title":"Token Endpoint","text":"<pre><code>POST /oauth/token\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&amp;code={code}&amp;client_id={id}&amp;redirect_uri={uri}&amp;code_verifier={verifier}\n</code></pre> <p>Exchanges authorization code for access token with PKCE validation.</p>"},{"location":"OAUTH/#client-registration-endpoint","title":"Client Registration Endpoint","text":"<pre><code>POST /oauth/register\nContent-Type: application/json\n\n{\n  \"client_name\": \"My MCP Client\",\n  \"redirect_uris\": [\"http://localhost:8080/callback\"]\n}\n</code></pre> <p>Registers a new MCP client (RFC 7591).</p>"},{"location":"OAUTH/#external-provider-callback","title":"External Provider Callback","text":"<pre><code>GET /oauth/callback?code={code}&amp;state={state}\n</code></pre> <p>Handles callback from external OAuth provider.</p>"},{"location":"OAUTH/#token-storage","title":"Token Storage","text":""},{"location":"OAUTH/#development-memory-backend","title":"Development (Memory Backend)","text":"<p>By default, tokens are stored in memory:</p> <pre><code># No configuration needed - works out of the box\nprovider = MyOAuthProvider(...)\n</code></pre>"},{"location":"OAUTH/#production-redis-backend","title":"Production (Redis Backend)","text":"<p>For production, use Redis for persistent, scalable token storage:</p> <pre><code># Install Redis backend\npip install chuk-sessions[redis]\n\n# Set environment variables\nexport SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379/0\n</code></pre> <p>Tokens are automatically stored in Redis with proper TTLs.</p>"},{"location":"OAUTH/#token-ttl-configuration","title":"Token TTL Configuration","text":"<p>All token expiration times can be configured via environment variables (values in seconds):</p> <pre><code># Authorization code lifetime (default: 300 = 5 minutes)\n# Short-lived codes exchanged for access tokens during OAuth flow\n# Keep short for security - user should complete OAuth flow quickly\nexport OAUTH_AUTH_CODE_TTL=300\n\n# Access token lifetime (default: 900 = 15 minutes)\n# Used by MCP clients to authenticate API requests\n# Should be short-lived and refreshed regularly for security\nexport OAUTH_ACCESS_TOKEN_TTL=900\n\n# Refresh token lifetime (default: 86400 = 1 day)\n# Tokens that obtain new access tokens without re-authentication\n# Short lifetime requires daily re-authorization for maximum security\nexport OAUTH_REFRESH_TOKEN_TTL=86400\n\n# Client registration lifetime (default: 31536000 = 1 year)\n# How long dynamically registered MCP clients remain valid\n# Can be longer since clients are typically persistent\nexport OAUTH_CLIENT_REGISTRATION_TTL=31536000\n\n# External provider token lifetime (default: 86400 = 1 day)\n# Access and refresh tokens from external providers (LinkedIn, GitHub, etc.)\n# Stored server-side and auto-refreshed when expired\n# Short lifetime minimizes risk if tokens are compromised\nexport OAUTH_EXTERNAL_TOKEN_TTL=86400\n</code></pre> <p>Example for even shorter-lived tokens in high-security environments:</p> <pre><code># 2 minute auth codes\nexport OAUTH_AUTH_CODE_TTL=120\n\n# 5 minute access tokens (very aggressive refresh)\nexport OAUTH_ACCESS_TOKEN_TTL=300\n\n# 12 hour refresh tokens (force re-auth twice daily)\nexport OAUTH_REFRESH_TOKEN_TTL=43200\n</code></pre>"},{"location":"OAUTH/#security-features","title":"Security Features","text":""},{"location":"OAUTH/#pkce-proof-key-for-code-exchange","title":"PKCE (Proof Key for Code Exchange)","text":"<p>All authorization flows support PKCE (RFC 7636) with S256 and plain methods:</p> <pre><code># MCP client generates code verifier\nimport secrets\nimport hashlib\nimport base64\n\ncode_verifier = secrets.token_urlsafe(32)\ncode_challenge = base64.urlsafe_b64encode(\n    hashlib.sha256(code_verifier.encode()).digest()\n).decode().rstrip('=')\n\n# Request authorization with code_challenge\n# ...\n\n# Exchange code with code_verifier\n# Token endpoint validates PKCE automatically\n</code></pre>"},{"location":"OAUTH/#multi-tenant-isolation","title":"Multi-Tenant Isolation","text":"<p>Use sandbox IDs to isolate tokens between tenants:</p> <pre><code>provider = MyOAuthProvider(\n    sandbox_id=\"tenant-123\",  # All tokens prefixed with this ID\n    ...\n)\n</code></pre>"},{"location":"OAUTH/#token-expiration","title":"Token Expiration","text":"<p>Default TTLs (all configurable via environment variables - see Token TTL Configuration):</p> <ul> <li>Authorization codes: 5 minutes (<code>OAUTH_AUTH_CODE_TTL</code>)</li> <li>Access tokens: 15 minutes (<code>OAUTH_ACCESS_TOKEN_TTL</code>)</li> <li>Refresh tokens: 1 day (<code>OAUTH_REFRESH_TOKEN_TTL</code>)</li> <li>Client registrations: 1 year (<code>OAUTH_CLIENT_REGISTRATION_TTL</code>)</li> <li>External provider tokens: 1 day (<code>OAUTH_EXTERNAL_TOKEN_TTL</code>)</li> </ul>"},{"location":"OAUTH/#examples","title":"Examples","text":"<p>See working examples:</p> <ul> <li>LinkedIn OAuth: chuk-mcp-linkedin</li> <li>Full LinkedIn OAuth integration</li> <li>Production-ready implementation</li> <li>Shows complete provider implementation</li> </ul>"},{"location":"OAUTH/#api-reference","title":"API Reference","text":""},{"location":"OAUTH/#oauthmiddleware","title":"OAuthMiddleware","text":"<pre><code>class OAuthMiddleware:\n    def __init__(\n        self,\n        mcp_server: ChukMCPServer,\n        provider: BaseOAuthProvider,\n        oauth_server_url: str = \"http://localhost:8000\",\n        callback_path: str = \"/oauth/callback\",\n        scopes_supported: Optional[list[str]] = None,\n        service_documentation: Optional[str] = None,\n        provider_name: str = \"OAuth Provider\",\n    ):\n        \"\"\"\n        Generic OAuth middleware for ChukMCPServer.\n\n        Args:\n            mcp_server: ChukMCPServer instance\n            provider: OAuth provider instance (implements BaseOAuthProvider)\n            oauth_server_url: OAuth server base URL\n            callback_path: Path for external provider callback\n            scopes_supported: List of supported scopes for metadata\n            service_documentation: URL to service documentation\n            provider_name: Human-readable name of the OAuth provider\n        \"\"\"\n</code></pre>"},{"location":"OAUTH/#tokenstore","title":"TokenStore","text":"<pre><code>class TokenStore(BaseTokenStore):\n    def __init__(self, sandbox_id: str = \"default\"):\n        \"\"\"\n        Session-based token store with automatic TTL.\n\n        Args:\n            sandbox_id: Sandbox ID for multi-tenant isolation\n\n        Backend Configuration:\n            Memory (default):\n                - No configuration needed\n                - Great for development\n\n            Redis (production):\n                - Set SESSION_PROVIDER=redis\n                - Set SESSION_REDIS_URL=redis://localhost:6379/0\n        \"\"\"\n</code></pre>"},{"location":"OAUTH/#baseoauthprovider","title":"BaseOAuthProvider","text":"<pre><code>class BaseOAuthProvider:\n    \"\"\"Base interface for OAuth providers.\"\"\"\n\n    async def authorize(\n        self, params: AuthorizationParams\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        raise NotImplementedError\n\n    async def exchange_authorization_code(\n        self, code: str, client_id: str, redirect_uri: str, code_verifier: Optional[str]\n    ) -&gt; OAuthToken:\n        \"\"\"Exchange authorization code for access token.\"\"\"\n        raise NotImplementedError\n\n    async def exchange_refresh_token(\n        self, refresh_token: str, client_id: str, scope: Optional[str]\n    ) -&gt; OAuthToken:\n        \"\"\"Refresh access token using refresh token.\"\"\"\n        raise NotImplementedError\n\n    async def validate_access_token(\n        self, token: str\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Validate and load access token.\"\"\"\n        raise NotImplementedError\n\n    async def register_client(\n        self, client_metadata: Dict[str, Any]\n    ) -&gt; OAuthClientInfo:\n        \"\"\"Register a new MCP client.\"\"\"\n        raise NotImplementedError\n\n    async def handle_external_callback(\n        self, code: str, state: str\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Handle callback from external OAuth provider.\"\"\"\n        raise NotImplementedError\n</code></pre>"},{"location":"OAUTH/#troubleshooting","title":"Troubleshooting","text":""},{"location":"OAUTH/#oauth-discovery-fails","title":"OAuth Discovery Fails","text":"<p>Problem: <code>404 Not Found</code> on <code>/.well-known/oauth-authorization-server</code></p> <p>Solution: Ensure OAuth middleware is registered via <code>post_register_hook</code>:</p> <pre><code>mcp.run(post_register_hook=setup_oauth)  # \u2713 Correct\n# NOT: setup_oauth() at module level before mcp.run()\n</code></pre>"},{"location":"OAUTH/#token-exchange-fails-with-400","title":"Token Exchange Fails with 400","text":"<p>Problem: <code>invalid_grant: Invalid or expired authorization code</code></p> <p>Possible causes: 1. PKCE validation failing - check code_verifier matches code_challenge 2. Redirect URI mismatch - must match exactly 3. Authorization code expired (5 min TTL by default) 4. Code already used (one-time use)</p>"},{"location":"OAUTH/#external-callback-not-working","title":"External Callback Not Working","text":"<p>Problem: External provider redirects to wrong URL</p> <p>Solution: Check redirect_uri in your service client initialization:</p> <pre><code># Should match your OAuth server's callback\nservice_client = MyServiceOAuthClient(\n    redirect_uri=\"http://localhost:8000/oauth/callback\",  # \u2713 OAuth server\n    # NOT: \"http://localhost:8080/callback\"  # \u2717 MCP client\n)\n</code></pre>"},{"location":"OAUTH/#best-practices","title":"Best Practices","text":"<ol> <li>Use PKCE - Always require code_challenge for public clients</li> <li>Validate redirect URIs - Only allow registered redirect URIs</li> <li>Use Redis in production - Memory backend is for development only</li> <li>Set proper TTLs - Short-lived access tokens (15min), daily refresh tokens for security</li> <li>Log OAuth flows - Aid debugging with detailed logging</li> <li>Handle token refresh - Automatically refresh expired external tokens</li> <li>Sandbox isolation - Use unique sandbox IDs for multi-tenancy</li> </ol>"},{"location":"OAUTH/#license","title":"License","text":"<p>MIT - See LICENSE</p>"},{"location":"OAUTH_PROVIDERS/","title":"OAuth Providers","text":"<p>ChukMCPServer provides pluggable OAuth providers that can be reused across different MCP servers. Instead of implementing OAuth from scratch for each service, you can use pre-built providers or create your own.</p>"},{"location":"OAUTH_PROVIDERS/#available-providers","title":"Available Providers","text":""},{"location":"OAUTH_PROVIDERS/#google-drive-provider","title":"Google Drive Provider","text":"<p>OAuth 2.1 integration with Google Drive API, providing secure access to user's Google Drive storage.</p> <p>Installation:</p> <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre> <p>Quick Setup (Using Helper):</p> <pre><code>from chuk_mcp_server import ChukMCPServer, run\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\nmcp = ChukMCPServer(\"my-server\")\n\n# ... register your tools ...\n\n# Setup Google Drive OAuth (reads from environment variables)\noauth_hook = setup_google_drive_oauth(mcp)\n\n# Run server with OAuth\nrun(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre> <p>Environment Variables:</p> <pre><code># Required\nexport GOOGLE_CLIENT_ID=\"your-client-id.apps.googleusercontent.com\"\nexport GOOGLE_CLIENT_SECRET=\"your-client-secret\"\n\n# Optional (with defaults)\nexport GOOGLE_REDIRECT_URI=\"http://localhost:8000/oauth/callback\"\nexport OAUTH_SERVER_URL=\"http://localhost:8000\"\nexport GOOGLE_DRIVE_ROOT_FOLDER=\"CHUK\"  # Folder in user's Drive\n</code></pre> <p>Manual Setup (Full Control):</p> <pre><code>from chuk_mcp_server import ChukMCPServer, run\nfrom chuk_mcp_server.oauth import OAuthMiddleware\nfrom chuk_mcp_server.oauth.providers import GoogleDriveOAuthProvider\n\nmcp = ChukMCPServer(\"my-server\")\n\ndef setup_oauth():\n    \"\"\"Set up Google Drive OAuth.\"\"\"\n    provider = GoogleDriveOAuthProvider(\n        google_client_id=\"your-client-id\",\n        google_client_secret=\"your-client-secret\",\n        google_redirect_uri=\"http://localhost:8000/oauth/callback\",\n        oauth_server_url=\"http://localhost:8000\",\n        sandbox_id=\"my-server-sandbox\",\n    )\n\n    oauth = OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        callback_path=\"/oauth/callback\",\n        scopes_supported=[\"drive.file\", \"userinfo.profile\"],\n        service_documentation=\"https://github.com/yourusername/my-server\",\n        provider_name=\"Google Drive\",\n    )\n\n    return oauth\n\nrun(transport=\"http\", port=8000, post_register_hook=setup_oauth)\n</code></pre> <p>Accessing Google Drive from Tools:</p> <pre><code>from chuk_mcp_server.oauth.helpers import configure_storage_from_oauth\nfrom chuk_virtual_fs.providers import GoogleDriveProvider\n\n# In your tool that requires authentication\n@tool\nasync def my_tool():\n    \"\"\"Tool that needs Google Drive access.\"\"\"\n    # Get token from request context (automatically injected by OAuth middleware)\n    access_token = get_access_token()  # From your request context\n\n    # Validate token and get user credentials\n    token_data = await oauth_provider.validate_access_token(access_token)\n\n    # Configure storage from OAuth token\n    storage_config = configure_storage_from_oauth(token_data)\n\n    # Create Google Drive provider\n    drive = GoogleDriveProvider(\n        credentials=storage_config[\"credentials\"],\n        root_folder=storage_config[\"root_folder\"],\n    )\n\n    await drive.initialize()\n\n    # Use Google Drive...\n    await drive.write_file(\"/myfile.txt\", b\"content\")\n</code></pre> <p>How It Works:</p> <ol> <li>Two-Layer Authentication:</li> <li>MCP Layer: Claude Desktop \u2194 Your MCP Server (OAuth tokens)</li> <li> <p>Google Layer: Your MCP Server \u2194 Google Drive (Google tokens)</p> </li> <li> <p>Token Management:</p> </li> <li>MCP client gets short-lived access tokens (15 min) and refresh tokens (1 day)</li> <li>Google Drive tokens stored server-side, auto-refreshed when expired</li> <li> <p>User only authorizes once via browser</p> </li> <li> <p>OAuth Flow: <pre><code>Claude Desktop \u2192 /oauth/authorize \u2192 Redirect to Google\nUser authorizes on Google \u2192 Google callback \u2192 Token exchange\nServer stores Google token \u2192 Returns MCP auth code \u2192 Claude gets access token\n</code></pre></p> </li> </ol> <p>Creating Google OAuth Credentials:</p> <ol> <li>Go to https://console.cloud.google.com/</li> <li>Create project (or select existing)</li> <li>Enable Google Drive API</li> <li>OAuth consent screen:</li> <li>User Type: External</li> <li>Add test users</li> <li>Credentials \u2192 Create OAuth 2.0 Client ID:</li> <li>Application type: Web application</li> <li>Authorized redirect URIs: <code>http://localhost:8000/oauth/callback</code></li> <li>Copy Client ID and Client Secret</li> </ol>"},{"location":"OAUTH_PROVIDERS/#creating-custom-providers","title":"Creating Custom Providers","text":"<p>You can create your own OAuth provider for any service (GitHub, LinkedIn, Dropbox, etc.).</p> <p>Example: Custom Provider</p> <pre><code>from chuk_mcp_server.oauth import (\n    BaseOAuthProvider,\n    AuthorizationParams,\n    OAuthToken,\n    OAuthClientInfo,\n    TokenStore,\n)\n\nclass MyServiceOAuthProvider(BaseOAuthProvider):\n    \"\"\"OAuth provider for MyService.\"\"\"\n\n    def __init__(\n        self,\n        service_client_id: str,\n        service_client_secret: str,\n        service_redirect_uri: str,\n        oauth_server_url: str = \"http://localhost:8000\",\n        sandbox_id: str = \"my-service\",\n    ):\n        self.oauth_server_url = oauth_server_url\n        self.token_store = TokenStore(sandbox_id=sandbox_id)\n\n        # Initialize your service's OAuth client\n        self.service_client = MyServiceOAuthClient(\n            client_id=service_client_id,\n            client_secret=service_client_secret,\n            redirect_uri=service_redirect_uri,\n        )\n\n        self._pending_authorizations = {}\n\n    async def authorize(self, params: AuthorizationParams) -&gt; dict:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        # Validate MCP client\n        if not await self.token_store.validate_client(\n            params.client_id,\n            redirect_uri=params.redirect_uri,\n        ):\n            raise AuthorizeError(\n                error=\"invalid_client\",\n                error_description=\"Invalid client_id or redirect_uri\",\n            )\n\n        # Check if user has external token\n        # ... (similar to Google Drive provider)\n\n        # Need external authorization - redirect to your service\n        import secrets\n        state = secrets.token_urlsafe(32)\n\n        self._pending_authorizations[state] = {\n            \"mcp_client_id\": params.client_id,\n            \"mcp_redirect_uri\": params.redirect_uri,\n            \"mcp_state\": params.state,\n            \"mcp_scope\": params.scope,\n            \"mcp_code_challenge\": params.code_challenge,\n            \"mcp_code_challenge_method\": params.code_challenge_method,\n        }\n\n        auth_url = self.service_client.get_authorization_url(state=state)\n\n        return {\n            \"authorization_url\": auth_url,\n            \"state\": state,\n            \"requires_external_authorization\": True,\n        }\n\n    async def handle_external_callback(self, code: str, state: str) -&gt; dict:\n        \"\"\"Handle callback from external service.\"\"\"\n        pending = self._pending_authorizations.get(state)\n        if not pending:\n            raise ValueError(\"Invalid or expired state parameter\")\n\n        # Exchange service code for token\n        service_token = await self.service_client.exchange_code_for_token(code)\n\n        # Get user info\n        user_info = await self.service_client.get_user_info(\n            service_token[\"access_token\"]\n        )\n        user_id = user_info[\"id\"]  # Or \"sub\" for OIDC\n\n        # Store service token\n        await self.token_store.link_external_token(\n            user_id=user_id,\n            access_token=service_token[\"access_token\"],\n            refresh_token=service_token.get(\"refresh_token\"),\n            expires_in=service_token.get(\"expires_in\", 3600),\n            provider=\"my-service\",\n        )\n\n        # Create MCP authorization code\n        mcp_code = await self.token_store.create_authorization_code(\n            user_id=user_id,\n            client_id=pending[\"mcp_client_id\"],\n            redirect_uri=pending[\"mcp_redirect_uri\"],\n            scope=pending[\"mcp_scope\"],\n            code_challenge=pending[\"mcp_code_challenge\"],\n            code_challenge_method=pending[\"mcp_code_challenge_method\"],\n        )\n\n        del self._pending_authorizations[state]\n\n        return {\n            \"code\": mcp_code,\n            \"state\": pending[\"mcp_state\"],\n            \"redirect_uri\": pending[\"mcp_redirect_uri\"],\n        }\n\n    # Implement other required methods:\n    # - exchange_authorization_code\n    # - exchange_refresh_token\n    # - validate_access_token\n    # - register_client\n</code></pre> <p>See OAUTH.md for complete OAuth implementation guide.</p>"},{"location":"OAUTH_PROVIDERS/#examples","title":"Examples","text":"<p>chuk-mcp-stage: Uses Google Drive provider for persistent scene storage - See: https://github.com/chrishayuk/chuk-mcp-stage</p> <p>chuk-mcp-linkedin: Uses custom LinkedIn provider for profile/post access - See: https://github.com/chrishayuk/chuk-mcp-linkedin</p>"},{"location":"OAUTH_PROVIDERS/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Use PKCE - Always require code_challenge for public clients</li> <li>Validate Redirect URIs - Only allow registered redirect URIs</li> <li>Short-Lived Tokens - MCP access tokens expire in 15 minutes</li> <li>Auto-Refresh - External provider tokens refreshed automatically</li> <li>Sandbox Isolation - Use unique sandbox IDs for multi-tenancy</li> <li>Environment Variables - Never hardcode credentials</li> <li>HTTPS in Production - Use HTTPS for all OAuth endpoints</li> </ol>"},{"location":"OAUTH_PROVIDERS/#troubleshooting","title":"Troubleshooting","text":"<p>OAuth provider not loading: <pre><code>ImportError: cannot import name 'GoogleDriveOAuthProvider'\n</code></pre> Fix: Install the google_drive extra: <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre></p> <p>Browser doesn't open during OAuth flow: - OAuth only works in HTTP mode (not STDIO) - Run server with: <code>uv run my-server http</code> - Check that port 8000 is not blocked</p> <p>Invalid redirect URI error: - Ensure redirect URI in Google Cloud Console matches exactly - Should be: <code>http://localhost:8000/oauth/callback</code> - Protocol (http vs https) must match</p> <p>Token expired errors: - Tokens auto-refresh, but may need manual re-authorization - Check server logs for refresh errors - User may need to re-authorize via browser</p>"},{"location":"OAUTH_PROVIDERS/#license","title":"License","text":"<p>MIT - See LICENSE</p>"},{"location":"OAUTH_TYPES/","title":"OAuth Types and Exports","text":"<p>Complete reference for OAuth types, classes, and functions exported from chuk-mcp-server.</p>"},{"location":"OAUTH_TYPES/#core-oauth-module","title":"Core OAuth Module","text":""},{"location":"OAUTH_TYPES/#importing-oauth-components","title":"Importing OAuth Components","text":"<pre><code># Import OAuth components from oauth module\nfrom chuk_mcp_server.oauth import (\n    OAuthMiddleware,          # OAuth middleware for MCP server\n    TokenStore,               # Session-based token storage\n    BaseOAuthProvider,        # Base class for OAuth providers\n    BaseTokenStore,           # Base class for token stores\n\n    # OAuth models\n    AuthorizationParams,      # Authorization request parameters\n    OAuthToken,               # OAuth token response\n    OAuthClientInfo,          # Client registration info\n\n    # OAuth errors\n    AuthorizeError,           # Authorization errors\n    TokenError,               # Token errors\n    RegistrationError,        # Client registration errors\n\n    # Helper functions\n    setup_google_drive_oauth,       # One-line Google Drive OAuth setup\n    configure_storage_from_oauth,   # Convert OAuth tokens to storage config\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauth-provider-types","title":"OAuth Provider Types","text":""},{"location":"OAUTH_TYPES/#baseoauthprovider","title":"BaseOAuthProvider","text":"<p>Abstract base class for implementing OAuth providers.</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider, AuthorizationParams, OAuthToken\n\nclass MyOAuthProvider(BaseOAuthProvider):\n    async def authorize(self, params: AuthorizationParams) -&gt; dict[str, Any]:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        ...\n\n    async def exchange_authorization_code(\n        self,\n        code: str,\n        client_id: str,\n        redirect_uri: str,\n        code_verifier: str | None = None,\n    ) -&gt; OAuthToken:\n        \"\"\"Exchange authorization code for access token.\"\"\"\n        ...\n\n    async def exchange_refresh_token(\n        self,\n        refresh_token: str,\n        client_id: str,\n        scope: str | None = None,\n    ) -&gt; OAuthToken:\n        \"\"\"Refresh access token.\"\"\"\n        ...\n\n    async def validate_access_token(self, token: str) -&gt; dict[str, Any]:\n        \"\"\"Validate and load access token.\"\"\"\n        ...\n\n    async def register_client(self, client_metadata: dict[str, Any]) -&gt; OAuthClientInfo:\n        \"\"\"Register a new MCP client.\"\"\"\n        ...\n\n    async def handle_external_callback(self, code: str, state: str) -&gt; dict[str, Any]:\n        \"\"\"Handle callback from external OAuth provider.\"\"\"\n        ...\n</code></pre>"},{"location":"OAUTH_TYPES/#google-drive-provider-optional","title":"Google Drive Provider (Optional)","text":"<p>Available when <code>google_drive</code> extra is installed.</p> <pre><code>from chuk_mcp_server.oauth.providers import (\n    GoogleDriveOAuthProvider,    # Google Drive OAuth provider\n    GoogleDriveOAuthClient,      # Google Drive OAuth client\n)\n\n# Create provider\nprovider = GoogleDriveOAuthProvider(\n    google_client_id=\"...\",\n    google_client_secret=\"...\",\n    google_redirect_uri=\"http://localhost:8000/oauth/callback\",\n    oauth_server_url=\"http://localhost:8000\",\n    sandbox_id=\"my-app\",\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauth-model-types","title":"OAuth Model Types","text":""},{"location":"OAUTH_TYPES/#authorizationparams","title":"AuthorizationParams","text":"<p>Parameters for OAuth authorization requests.</p> <pre><code>from chuk_mcp_server.oauth import AuthorizationParams\n\nparams = AuthorizationParams(\n    response_type: str,                           # \"code\"\n    client_id: str,                               # Client ID\n    redirect_uri: str,                            # Redirect URI\n    scope: str | None = None,                     # Requested scopes\n    state: str | None = None,                     # CSRF protection\n    code_challenge: str | None = None,            # PKCE challenge\n    code_challenge_method: Literal[\"S256\", \"plain\"] | None = None,\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauthtoken","title":"OAuthToken","text":"<p>OAuth token response.</p> <pre><code>from chuk_mcp_server.oauth import OAuthToken\n\ntoken = OAuthToken(\n    access_token: str,           # Access token\n    token_type: str,             # \"Bearer\"\n    expires_in: int,             # Expiration time in seconds\n    refresh_token: str | None,   # Refresh token (optional)\n    scope: str | None,           # Granted scopes (optional)\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauthclientinfo","title":"OAuthClientInfo","text":"<p>Client registration information.</p> <pre><code>from chuk_mcp_server.oauth import OAuthClientInfo\n\nclient_info = OAuthClientInfo(\n    client_id: str,              # Client ID\n    client_secret: str,          # Client secret\n    client_name: str,            # Client name\n    redirect_uris: list[str],    # Registered redirect URIs\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauth-error-types","title":"OAuth Error Types","text":""},{"location":"OAUTH_TYPES/#authorizeerror","title":"AuthorizeError","text":"<p>Raised during authorization flow.</p> <pre><code>from chuk_mcp_server.oauth import AuthorizeError\n\nraise AuthorizeError(\n    error: str,                  # Error code (\"invalid_client\", etc.)\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#tokenerror","title":"TokenError","text":"<p>Raised during token operations.</p> <pre><code>from chuk_mcp_server.oauth import TokenError\n\nraise TokenError(\n    error: str,                  # Error code (\"invalid_grant\", etc.)\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#registrationerror","title":"RegistrationError","text":"<p>Raised during client registration.</p> <pre><code>from chuk_mcp_server.oauth import RegistrationError\n\nraise RegistrationError(\n    error: str,                  # Error code\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#oauth-middleware","title":"OAuth Middleware","text":""},{"location":"OAUTH_TYPES/#oauthmiddleware","title":"OAuthMiddleware","text":"<p>Adds OAuth endpoints to MCP server.</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.oauth import OAuthMiddleware, BaseOAuthProvider\n\nmcp = ChukMCPServer(\"my-server\")\nprovider: BaseOAuthProvider = ...  # Your OAuth provider\n\noauth = OAuthMiddleware(\n    mcp_server=mcp,\n    provider=provider,\n    oauth_server_url: str = \"http://localhost:8000\",\n    callback_path: str = \"/oauth/callback\",\n    scopes_supported: list[str] | None = None,\n    service_documentation: str | None = None,\n    provider_name: str = \"OAuth Provider\",\n)\n</code></pre> <p>Automatically registers these endpoints: - <code>GET /.well-known/oauth-authorization-server</code> - OAuth metadata - <code>GET /.well-known/oauth-protected-resource</code> - Protected resource metadata - <code>GET /oauth/authorize</code> - Authorization endpoint - <code>POST /oauth/token</code> - Token endpoint - <code>POST /oauth/register</code> - Client registration - <code>GET /oauth/callback</code> - External provider callback</p>"},{"location":"OAUTH_TYPES/#token-storage","title":"Token Storage","text":""},{"location":"OAUTH_TYPES/#tokenstore","title":"TokenStore","text":"<p>Session-based token storage using chuk-sessions.</p> <pre><code>from chuk_mcp_server.oauth import TokenStore\n\nstore = TokenStore(sandbox_id: str = \"default\")\n\n# Client management\nawait store.register_client(client_name, redirect_uris)\nawait store.validate_client(client_id, redirect_uri)\n\n# Authorization codes\nawait store.create_authorization_code(\n    user_id, client_id, redirect_uri, scope,\n    code_challenge, code_challenge_method\n)\nawait store.validate_authorization_code(\n    code, client_id, redirect_uri, code_verifier\n)\n\n# Access tokens\nawait store.create_access_token(user_id, client_id, scope)\nawait store.validate_access_token(token)\nawait store.refresh_access_token(refresh_token)\n\n# External provider tokens\nawait store.link_external_token(\n    user_id, access_token, refresh_token, expires_in, provider\n)\nawait store.get_external_token(user_id, provider)\nawait store.is_external_token_expired(user_id, provider)\nawait store.update_external_token(\n    user_id, access_token, refresh_token, expires_in, provider\n)\n</code></pre>"},{"location":"OAUTH_TYPES/#helper-functions","title":"Helper Functions","text":""},{"location":"OAUTH_TYPES/#setup_google_drive_oauth","title":"setup_google_drive_oauth()","text":"<p>One-line Google Drive OAuth setup.</p> <pre><code>from chuk_mcp_server import get_mcp_server, run\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\n# Setup OAuth (reads from environment)\noauth_hook = setup_google_drive_oauth(\n    mcp_server=get_mcp_server(),\n    client_id: str | None = None,        # Or env: GOOGLE_CLIENT_ID\n    client_secret: str | None = None,    # Or env: GOOGLE_CLIENT_SECRET\n    redirect_uri: str | None = None,     # Or env: GOOGLE_REDIRECT_URI\n    oauth_server_url: str | None = None, # Or env: OAUTH_SERVER_URL\n    sandbox_id: str | None = None,       # Defaults to server name\n)\n\n# Run with OAuth\nrun(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre> <p>Returns <code>None</code> if credentials not configured, or a callable that creates OAuth middleware.</p>"},{"location":"OAUTH_TYPES/#configure_storage_from_oauth","title":"configure_storage_from_oauth()","text":"<p>Convert OAuth token data to storage credentials.</p> <pre><code>from chuk_mcp_server.oauth.helpers import configure_storage_from_oauth\n\n# Get token data from OAuth provider\ntoken_data = await oauth_provider.validate_access_token(access_token)\n\n# Convert to storage config\nstorage_config = configure_storage_from_oauth(token_data)\n\n# Returns:\n{\n    \"credentials\": {\n        \"token\": \"...\",\n        \"refresh_token\": \"...\",\n        \"token_uri\": \"https://oauth2.googleapis.com/token\",\n        \"client_id\": \"...\",\n        \"client_secret\": \"...\",\n        \"scopes\": [\"...\"],\n    },\n    \"root_folder\": \"CHUK\",\n    \"user_id\": \"user-123\",\n}\n</code></pre>"},{"location":"OAUTH_TYPES/#mcp-server-helper","title":"MCP Server Helper","text":""},{"location":"OAUTH_TYPES/#get_mcp_server","title":"get_mcp_server()","text":"<p>Get the global MCP server instance.</p> <pre><code>from chuk_mcp_server import get_mcp_server\n\n# Get global server instance\nserver = get_mcp_server()\n\n# Use with OAuth setup\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\noauth_hook = setup_google_drive_oauth(get_mcp_server())\n</code></pre>"},{"location":"OAUTH_TYPES/#type-checking","title":"Type Checking","text":"<p>All OAuth types are fully typed and support static type checking:</p> <pre><code>from typing import TYPE_CHECKING\n\nif TYPE_CHECKING:\n    from chuk_mcp_server.oauth import (\n        BaseOAuthProvider,\n        OAuthToken,\n        AuthorizationParams,\n        OAuthClientInfo,\n    )\n</code></pre>"},{"location":"OAUTH_TYPES/#complete-example","title":"Complete Example","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool, run, get_mcp_server\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\n# Create MCP server\nmcp = ChukMCPServer(\"my-app\")\n\n# Register tools\n@mcp.tool\ndef my_tool(data: str) -&gt; dict:\n    \"\"\"Example tool.\"\"\"\n    return {\"data\": data}\n\n# Setup Google Drive OAuth (one line!)\noauth_hook = setup_google_drive_oauth(get_mcp_server())\n\n# Run server with OAuth\nif __name__ == \"__main__\":\n    run(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre>"},{"location":"OAUTH_TYPES/#environment-variables","title":"Environment Variables","text":"<p>Required for <code>setup_google_drive_oauth()</code>: <pre><code>export GOOGLE_CLIENT_ID=\"...\"\nexport GOOGLE_CLIENT_SECRET=\"...\"\n</code></pre></p> <p>Optional (with defaults): <pre><code>export GOOGLE_REDIRECT_URI=\"http://localhost:8000/oauth/callback\"\nexport OAUTH_SERVER_URL=\"http://localhost:8000\"\nexport GOOGLE_DRIVE_ROOT_FOLDER=\"CHUK\"\n</code></pre></p>"},{"location":"OAUTH_TYPES/#see-also","title":"See Also","text":"<ul> <li>OAUTH.md - Complete OAuth implementation guide</li> <li>OAUTH_PROVIDERS.md - Provider documentation</li> <li>API Reference - Full API docs</li> </ul>"},{"location":"STDIO_TRANSPORT/","title":"STDIO Transport Support","text":"<p>ChukMCPServer now supports both HTTP streaming and STDIO transport modes for the Model Context Protocol (MCP).</p>"},{"location":"STDIO_TRANSPORT/#overview","title":"Overview","text":"<p>The server can operate in two transport modes: - HTTP Mode (default): Server-based communication with SSE streaming support - STDIO Mode: Process-based communication via standard input/output</p>"},{"location":"STDIO_TRANSPORT/#using-stdio-mode","title":"Using STDIO Mode","text":""},{"location":"STDIO_TRANSPORT/#1-explicit-configuration","title":"1. Explicit Configuration","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef hello(name: str) -&gt; str:\n    return f\"Hello, {name}!\"\n\n# Run in stdio mode explicitly\nmcp.run(stdio=True)\n</code></pre>"},{"location":"STDIO_TRANSPORT/#2-environment-variables","title":"2. Environment Variables","text":"<pre><code># Using MCP_TRANSPORT\nMCP_TRANSPORT=stdio python my_server.py\n\n# Using MCP_STDIO flag\nMCP_STDIO=1 python my_server.py\n\n# Using USE_STDIO flag\nUSE_STDIO=1 python my_server.py\n</code></pre>"},{"location":"STDIO_TRANSPORT/#3-auto-detection","title":"3. Auto-Detection","text":"<p>The server automatically detects stdio mode when: - Input/output is piped or redirected - Running in a non-interactive environment (with explicit env vars)</p> <pre><code># Pipe mode (requires MCP_STDIO=1 to enable auto-detection)\necho '{\"jsonrpc\":\"2.0\",\"method\":\"initialize\",\"params\":{\"clientInfo\":{\"name\":\"test\"}},\"id\":1}' | MCP_STDIO=1 python my_server.py\n</code></pre>"},{"location":"STDIO_TRANSPORT/#protocol-communication","title":"Protocol Communication","text":""},{"location":"STDIO_TRANSPORT/#initialize-session","title":"Initialize Session","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"initialize\",\n  \"params\": {\n    \"clientInfo\": {\n      \"name\": \"my-client\",\n      \"version\": \"1.0.0\"\n    },\n    \"protocolVersion\": \"2025-03-26\"\n  },\n  \"id\": 1\n}\n</code></pre>"},{"location":"STDIO_TRANSPORT/#call-a-tool","title":"Call a Tool","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"hello\",\n    \"arguments\": {\n      \"name\": \"World\"\n    }\n  },\n  \"id\": 2\n}\n</code></pre>"},{"location":"STDIO_TRANSPORT/#list-available-tools","title":"List Available Tools","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"tools/list\",\n  \"id\": 3\n}\n</code></pre>"},{"location":"STDIO_TRANSPORT/#example-server","title":"Example Server","text":"<pre><code>#!/usr/bin/env python3\n\"\"\"\nMCP server with stdio transport support.\n\"\"\"\n\nimport argparse\nimport logging\nimport sys\n\nfrom chuk_mcp_server import ChukMCPServer\n\n# Configure logging to stderr to keep stdout clean\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\n    stream=sys.stderr\n)\n\ndef main():\n    parser = argparse.ArgumentParser()\n    parser.add_argument(\"--stdio\", action=\"store_true\", help=\"Run in stdio mode\")\n    parser.add_argument(\"--port\", type=int, default=8000, help=\"Port for HTTP mode\")\n    args = parser.parse_args()\n\n    # Create server\n    mcp = ChukMCPServer(name=\"example-server\")\n\n    # Register tools\n    @mcp.tool\n    def add(a: int, b: int) -&gt; int:\n        \"\"\"Add two numbers.\"\"\"\n        return a + b\n\n    @mcp.tool\n    def multiply(a: int, b: int) -&gt; int:\n        \"\"\"Multiply two numbers.\"\"\"\n        return a * b\n\n    # Register resources\n    @mcp.resource(\"example://data\")\n    def get_data() -&gt; str:\n        \"\"\"Get example data.\"\"\"\n        return \"Example data content\"\n\n    # Run server\n    if args.stdio:\n        print(\"Starting in stdio mode...\", file=sys.stderr)\n        mcp.run(stdio=True)\n    else:\n        print(f\"Starting in HTTP mode on port {args.port}...\", file=sys.stderr)\n        mcp.run(port=args.port, stdio=False)\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"STDIO_TRANSPORT/#testing-stdio-mode","title":"Testing STDIO Mode","text":""},{"location":"STDIO_TRANSPORT/#using-a-test-client","title":"Using a Test Client","text":"<pre><code>import subprocess\nimport json\n\n# Start the server in stdio mode\nproc = subprocess.Popen(\n    [\"python\", \"server.py\", \"--stdio\"],\n    stdin=subprocess.PIPE,\n    stdout=subprocess.PIPE,\n    stderr=subprocess.PIPE,\n    text=True\n)\n\n# Initialize\nrequest = {\n    \"jsonrpc\": \"2.0\",\n    \"method\": \"initialize\",\n    \"params\": {\n        \"clientInfo\": {\"name\": \"test-client\"}\n    },\n    \"id\": 1\n}\n\nproc.stdin.write(json.dumps(request) + \"\\n\")\nproc.stdin.flush()\n\n# Read response\nresponse = proc.stdout.readline()\nprint(json.loads(response))\n</code></pre>"},{"location":"STDIO_TRANSPORT/#manual-testing","title":"Manual Testing","text":"<pre><code># Start server in stdio mode\nMCP_STDIO=1 python server.py\n\n# In another terminal, send requests\necho '{\"jsonrpc\":\"2.0\",\"method\":\"tools/list\",\"id\":1}' | nc localhost &lt;stdin_pipe&gt;\n</code></pre>"},{"location":"STDIO_TRANSPORT/#configuration-detection","title":"Configuration Detection","text":"<p>The smart configuration system automatically detects the appropriate transport mode:</p> <ol> <li>Explicit Environment Variables (highest priority)</li> <li><code>MCP_TRANSPORT=stdio</code></li> <li><code>MCP_STDIO=1</code></li> <li> <p><code>USE_STDIO=1</code></p> </li> <li> <p>Auto-detection (requires explicit env var)</p> </li> <li>Piped input/output</li> <li> <p>Non-TTY environments</p> </li> <li> <p>Default (lowest priority)</p> </li> <li>HTTP mode with SSE streaming</li> </ol>"},{"location":"STDIO_TRANSPORT/#implementation-details","title":"Implementation Details","text":""},{"location":"STDIO_TRANSPORT/#architecture","title":"Architecture","text":"<ul> <li>StdioTransport: Handles async I/O for stdin/stdout communication</li> <li>MCPProtocolHandler: Shared protocol handler for both transports</li> <li>Smart Config: Auto-detects optimal transport mode</li> </ul>"},{"location":"STDIO_TRANSPORT/#features","title":"Features","text":"<ul> <li>Full MCP protocol support</li> <li>Session management</li> <li>Async message handling</li> <li>Error handling with proper JSON-RPC error codes</li> <li>Context manager support</li> <li>Logging to stderr (keeps stdout clean)</li> </ul>"},{"location":"STDIO_TRANSPORT/#performance","title":"Performance","text":"<ul> <li>Uses <code>orjson</code> for fast JSON serialization</li> <li>Async I/O for non-blocking operations</li> <li>Efficient buffer management</li> <li>Minimal overhead for message processing</li> </ul>"},{"location":"STDIO_TRANSPORT/#compatibility","title":"Compatibility","text":"<ul> <li>Works with all MCP clients that support stdio transport</li> <li>Compatible with Claude Desktop and other MCP-enabled applications</li> <li>Supports protocol version 2025-03-26</li> <li>Python 3.11+ required</li> </ul>"},{"location":"STDIO_TRANSPORT/#migration-from-http-only","title":"Migration from HTTP-only","text":"<p>If you have an existing HTTP-only server, migration is simple:</p> <ol> <li>Update to latest chuk-mcp-server version</li> <li>No code changes required for basic functionality</li> <li>Optionally add <code>stdio=True</code> parameter to <code>run()</code> for explicit stdio mode</li> <li>Set environment variables for auto-detection if desired</li> </ol> <p>The server maintains full backward compatibility with HTTP mode as the default.</p>"},{"location":"TRANSPORT_MODES/","title":"ChukMCPServer Transport Modes","text":"<p>ChukMCPServer supports two transport modes for the Model Context Protocol (MCP):</p>"},{"location":"TRANSPORT_MODES/#1-stdio-transport-process-based","title":"1. STDIO Transport (Process-based)","text":"<p>For direct integration with MCP clients like Claude Desktop via standard input/output streams.</p>"},{"location":"TRANSPORT_MODES/#quick-start","title":"Quick Start","text":"<pre><code># Install and run with uvx (recommended)\nuvx chuk-mcp-server stdio\n\n# Or with environment variable\nMCP_STDIO=1 uvx chuk-mcp-server auto\n</code></pre>"},{"location":"TRANSPORT_MODES/#claude-desktop-configuration","title":"Claude Desktop Configuration","text":"<pre><code>{\n  \"mcpServers\": {\n    \"chuk-mcp\": {\n      \"command\": \"uvx\",\n      \"args\": [\"chuk-mcp-server\", \"stdio\"]\n    }\n  }\n}\n</code></pre>"},{"location":"TRANSPORT_MODES/#features","title":"Features","text":"<ul> <li>Lowest latency communication</li> <li>Direct process integration</li> <li>JSON-RPC over stdin/stdout</li> <li>Clean separation (logs to stderr, data to stdout)</li> </ul>"},{"location":"TRANSPORT_MODES/#2-http-transport-with-sse-streaming","title":"2. HTTP Transport with SSE Streaming","text":"<p>For network-based communication with support for multiple concurrent clients.</p>"},{"location":"TRANSPORT_MODES/#quick-start_1","title":"Quick Start","text":"<pre><code># Run on default port (8000)\nuvx chuk-mcp-server http\n\n# Run on custom port\nuvx chuk-mcp-server http --port 9000\n</code></pre>"},{"location":"TRANSPORT_MODES/#client-configuration","title":"Client Configuration","text":"<pre><code>{\n  \"mcpServers\": {\n    \"chuk-http\": {\n      \"url\": \"http://localhost:8000/mcp\",\n      \"transport\": \"http\",\n      \"streaming\": true\n    }\n  }\n}\n</code></pre>"},{"location":"TRANSPORT_MODES/#features_1","title":"Features","text":"<ul> <li>Server-Sent Events (SSE) for real-time streaming</li> <li>Multiple concurrent connections</li> <li>REST API endpoints</li> <li>Web-based MCP Inspector compatibility</li> <li>High performance (39,000+ RPS)</li> </ul>"},{"location":"TRANSPORT_MODES/#auto-detection-mode","title":"Auto-Detection Mode","text":"<p>The server can automatically detect the appropriate transport:</p> <pre><code># Auto-detect from environment\nuvx chuk-mcp-server auto\n</code></pre> <p>Detection priority: 1. Environment variables (<code>MCP_TRANSPORT</code>, <code>MCP_STDIO</code>, <code>USE_STDIO</code>) 2. Piped I/O detection (requires explicit env var) 3. Default to HTTP mode</p>"},{"location":"TRANSPORT_MODES/#comparison","title":"Comparison","text":"Feature STDIO HTTP + SSE Latency Lowest Low Concurrent Clients Single Multiple Network Access No Yes Process Integration Direct Remote Debugging Via stderr Via browser/tools Best For Claude Desktop Web clients, APIs"},{"location":"TRANSPORT_MODES/#protocol-support","title":"Protocol Support","text":"<p>Both transports support the full MCP protocol: - <code>initialize</code> - Session initialization - <code>tools/list</code> - List available tools - <code>tools/call</code> - Execute tools - <code>resources/list</code> - List resources - <code>resources/read</code> - Read resource content - <code>prompts/list</code> - List prompts - <code>prompts/get</code> - Get prompt details - Notifications and subscriptions</p>"},{"location":"TRANSPORT_MODES/#examples","title":"Examples","text":""},{"location":"TRANSPORT_MODES/#custom-server-with-both-modes","title":"Custom Server with Both Modes","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\nimport sys\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef my_tool(input: str) -&gt; str:\n    return f\"Processed: {input}\"\n\n# Run based on command line argument\nif len(sys.argv) &gt; 1 and sys.argv[1] == \"stdio\":\n    mcp.run(stdio=True)\nelse:\n    mcp.run()  # HTTP mode\n</code></pre>"},{"location":"TRANSPORT_MODES/#testing","title":"Testing","text":"<pre><code># Test STDIO mode\necho '{\"jsonrpc\":\"2.0\",\"method\":\"tools/list\",\"id\":1}' | \\\n  uvx chuk-mcp-server stdio 2&gt;/dev/null | jq .\n\n# Test HTTP mode\nuvx chuk-mcp-server http --port 8000 &amp;\ncurl -X POST http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jsonrpc\":\"2.0\",\"method\":\"tools/list\",\"id\":1}'\n</code></pre>"},{"location":"TRANSPORT_MODES/#environment-variables","title":"Environment Variables","text":"<ul> <li><code>MCP_TRANSPORT</code>: Force transport mode (<code>stdio</code> or <code>http</code>)</li> <li><code>MCP_STDIO</code>: Set to <code>1</code> to enable stdio mode</li> <li><code>USE_STDIO</code>: Alternative to <code>MCP_STDIO</code></li> <li><code>MCP_SERVER_NAME</code>: Custom server name</li> <li><code>MCP_SERVER_VERSION</code>: Custom server version</li> </ul>"},{"location":"TRANSPORT_MODES/#performance-tuning","title":"Performance Tuning","text":""},{"location":"TRANSPORT_MODES/#stdio-mode","title":"STDIO Mode","text":"<ul> <li>Minimal overhead</li> <li>Direct process communication</li> <li>Best for single-client scenarios</li> </ul>"},{"location":"TRANSPORT_MODES/#http-mode","title":"HTTP Mode","text":"<pre><code># High-performance settings\nMCP_PERFORMANCE_MODE=high_performance \\\nMCP_WORKERS=8 \\\nMCP_MAX_CONNECTIONS=10000 \\\nuvx chuk-mcp-server http\n</code></pre>"},{"location":"TRANSPORT_MODES/#troubleshooting","title":"Troubleshooting","text":""},{"location":"TRANSPORT_MODES/#stdio-issues","title":"STDIO Issues","text":"<ul> <li>Ensure logs go to stderr: <code>logging.basicConfig(stream=sys.stderr)</code></li> <li>Check JSON formatting: Messages must end with newline</li> <li>Verify environment variables are set</li> </ul>"},{"location":"TRANSPORT_MODES/#http-issues","title":"HTTP Issues","text":"<ul> <li>Check port availability: <code>lsof -i :8000</code></li> <li>Verify CORS headers for browser clients</li> <li>Monitor SSE connections for timeouts</li> </ul>"},{"location":"TRANSPORT_MODES/#migration-guide","title":"Migration Guide","text":"<p>Existing HTTP-only servers automatically support STDIO with no code changes: 1. Update to latest version: <code>pip install -U chuk-mcp-server</code> 2. Use CLI or set environment variables 3. Both modes work with the same tool/resource definitions</p>"},{"location":"about/architecture/","title":"Architecture","text":"<p>Deep dive into ChukMCPServer's design and architecture.</p>"},{"location":"about/architecture/#high-level-architecture","title":"High-Level Architecture","text":"<p>ChukMCPServer is built on a modular, high-performance architecture that achieves 39,000+ RPS through intelligent design choices.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          ChukMCPServer (Core)               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502  \u2502   Decorator  \u2502  \u2502   Registry   \u2502        \u2502\n\u2502  \u2502     API      \u2502  \u2502    System    \u2502        \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502  \u2502      SmartConfig System          \u2502      \u2502\n\u2502  \u2502  Auto-detection &amp; Optimization   \u2502      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502                   \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502  HTTP         \u2502   \u2502  STDIO      \u2502\n    \u2502  Transport    \u2502   \u2502  Transport  \u2502\n    \u2502  (Starlette)  \u2502   \u2502  (Standard) \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"about/architecture/#core-components","title":"Core Components","text":""},{"location":"about/architecture/#1-smartconfig-system","title":"1. SmartConfig System","text":"<p>Modular detection system that auto-configures based on environment:</p> <pre><code>SmartConfig\n    \u251c\u2500\u2500 ProjectDetector      # Name from pyproject.toml/directory\n    \u251c\u2500\u2500 EnvironmentDetector  # Dev/prod/container/serverless\n    \u251c\u2500\u2500 NetworkDetector      # Optimal host/port\n    \u251c\u2500\u2500 SystemDetector       # Hardware optimization\n    \u251c\u2500\u2500 ContainerDetector    # Docker/K8s detection\n    \u2514\u2500\u2500 CloudDetector        # AWS/GCP/Azure/Edge\n</code></pre> <p>Zero Configuration: Every setting auto-detected with sensible defaults.</p>"},{"location":"about/architecture/#2-registry-system","title":"2. Registry System","text":"<p>Two-tier registry for tools and endpoints:</p> <pre><code># MCP Registry: Tools, Resources, Prompts\nmcp_registry.py\n    - Tool registration with schema caching\n    - Resource URI management\n    - Prompt template storage\n\n# Endpoint Registry: HTTP routes\nendpoint_registry.py\n    - Auto-registered HTTP endpoints\n    - CORS configuration\n    - SSE streaming support\n</code></pre> <p>Pre-Cached Schemas: Generated once at registration, zero overhead at runtime.</p>"},{"location":"about/architecture/#3-type-system","title":"3. Type System","text":"<p>Type-safe handlers with automatic validation:</p> <pre><code>src/chuk_mcp_server/types/\n    \u251c\u2500\u2500 tool_handler.py      # Tool execution\n    \u251c\u2500\u2500 resource_handler.py  # Resource access\n    \u2514\u2500\u2500 schema_generator.py  # JSON schema from types\n</code></pre> <p>Performance: Direct integration with underlying <code>chuk_mcp</code> library, orjson serialization.</p>"},{"location":"about/architecture/#4-transport-layer","title":"4. Transport Layer","text":"<p>Dual transport support:</p> <pre><code>src/chuk_mcp_server/transport/\n    \u251c\u2500\u2500 http.py    # Starlette + uvloop (39K+ RPS)\n    \u2514\u2500\u2500 stdio.py   # Standard MCP protocol\n</code></pre> <p>HTTP Transport: - Built on Starlette for ASGI performance - uvloop event loop (2-4x faster) - Automatic CORS support - SSE for streaming</p> <p>STDIO Transport: - Standard MCP protocol - Process-based communication - Zero network overhead</p>"},{"location":"about/architecture/#5-protocol-layer","title":"5. Protocol Layer","text":"<p>MCP JSON-RPC implementation:</p> <pre><code>protocol.py\n    - JSON-RPC request/response handling\n    - Session management\n    - Error handling\n    - Capability negotiation\n</code></pre>"},{"location":"about/architecture/#6-oauth-system","title":"6. OAuth System","text":"<p>Two-layer authentication:</p> <pre><code>src/chuk_mcp_server/oauth/\n    \u251c\u2500\u2500 middleware.py       # OAuth middleware\n    \u251c\u2500\u2500 models.py           # Data models\n    \u251c\u2500\u2500 token_store.py      # Secure storage\n    \u251c\u2500\u2500 helpers.py          # Setup helpers\n    \u2514\u2500\u2500 providers/\n        \u2514\u2500\u2500 google_drive.py # Provider implementations\n</code></pre> <p>Layer 1: MCP Layer (Claude \u2194 Your Server) Layer 2: Provider Layer (Your Server \u2194 External Service)</p>"},{"location":"about/architecture/#7-cloud-support","title":"7. Cloud Support","text":"<p>Platform-specific adapters:</p> <pre><code>src/chuk_mcp_server/cloud/\n    \u251c\u2500\u2500 base.py            # Base adapter\n    \u251c\u2500\u2500 gcp.py             # Google Cloud\n    \u251c\u2500\u2500 aws.py             # AWS Lambda\n    \u251c\u2500\u2500 azure.py           # Azure Functions\n    \u2514\u2500\u2500 edge.py            # Edge platforms\n</code></pre> <p>Auto-detects cloud environment and exports appropriate handler.</p>"},{"location":"about/architecture/#design-patterns","title":"Design Patterns","text":""},{"location":"about/architecture/#decorator-pattern","title":"Decorator Pattern","text":"<p>Clean, FastAPI-like API:</p> <pre><code>@tool\ndef my_tool():\n    ...\n\n# Translates to:\ndef my_tool():\n    ...\nmy_tool = tool(my_tool)\n</code></pre>"},{"location":"about/architecture/#registry-pattern","title":"Registry Pattern","text":"<p>Centralized component management:</p> <pre><code># Registration\nmcp.register_tool(\"add\", handler)\n\n# Retrieval\nhandler = mcp.get_tool(\"add\")\n\n# Discovery\ntools = mcp.list_tools()\n</code></pre>"},{"location":"about/architecture/#factory-pattern","title":"Factory Pattern","text":"<p>Dynamic handler creation:</p> <pre><code>def create_tool_handler(func):\n    \"\"\"Create optimized handler for function.\"\"\"\n    # Analyze function signature\n    # Generate schema\n    # Create wrapper\n    return handler\n</code></pre>"},{"location":"about/architecture/#middleware-pattern","title":"Middleware Pattern","text":"<p>Request/response processing:</p> <pre><code>@app.middleware(\"http\")\nasync def process_request(request, call_next):\n    # Pre-processing\n    response = await call_next(request)\n    # Post-processing\n    return response\n</code></pre>"},{"location":"about/architecture/#performance-architecture","title":"Performance Architecture","text":""},{"location":"about/architecture/#1-pre-caching","title":"1. Pre-Caching","text":"<p>Schemas generated once at registration:</p> <pre><code># At registration time\nschema = generate_schema(tool_func)\nregistry.cache_schema(tool_name, schema)\n\n# At runtime (zero overhead)\nschema = registry.get_cached_schema(tool_name)\n</code></pre>"},{"location":"about/architecture/#2-orjson-serialization","title":"2. orjson Serialization","text":"<p>2-3x faster JSON operations:</p> <pre><code>import orjson\n\n# Serialize\ndata = orjson.dumps(obj)\n\n# Deserialize\nobj = orjson.loads(data)\n</code></pre>"},{"location":"about/architecture/#3-uvloop-event-loop","title":"3. uvloop Event Loop","text":"<p>2-4x faster than standard asyncio:</p> <pre><code>import uvloop\n\nuvloop.install()\nasyncio.run(main())\n</code></pre>"},{"location":"about/architecture/#4-worker-optimization","title":"4. Worker Optimization","text":"<p>Intelligent worker count:</p> <pre><code># I/O bound (default)\nworkers = (cpu_count * 2) + 1\n\n# CPU bound\nworkers = cpu_count\n</code></pre>"},{"location":"about/architecture/#data-flow","title":"Data Flow","text":""},{"location":"about/architecture/#tool-execution-flow","title":"Tool Execution Flow","text":"<pre><code>1. HTTP Request \u2192 Starlette App\n2. JSON-RPC Parsing \u2192 Protocol Layer\n3. Tool Lookup \u2192 Registry\n4. Schema Validation \u2192 Type System\n5. Handler Execution \u2192 Tool Function\n6. Result Serialization \u2192 orjson\n7. HTTP Response \u2192 Client\n</code></pre>"},{"location":"about/architecture/#oauth-flow","title":"OAuth Flow","text":"<pre><code>1. Tool Call (requires auth)\n2. Check Token Store\n3. If expired: Refresh Token\n4. Call External API with Token\n5. Return Result\n</code></pre>"},{"location":"about/architecture/#extension-points","title":"Extension Points","text":""},{"location":"about/architecture/#1-custom-transports","title":"1. Custom Transports","text":"<p>Implement new transport layer:</p> <pre><code>from chuk_mcp_server.transport.base import Transport\n\nclass MyTransport(Transport):\n    async def start(self):\n        ...\n\n    async def handle_request(self, request):\n        ...\n</code></pre>"},{"location":"about/architecture/#2-custom-oauth-providers","title":"2. Custom OAuth Providers","text":"<p>Implement OAuth provider:</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider\n\nclass MyProvider(BaseOAuthProvider):\n    async def authorize(self, params):\n        ...\n\n    async def exchange_authorization_code(self, code):\n        ...\n</code></pre>"},{"location":"about/architecture/#3-custom-middleware","title":"3. Custom Middleware","text":"<p>Add custom processing:</p> <pre><code>@mcp.app.middleware(\"http\")\nasync def custom_middleware(request, call_next):\n    # Your logic\n    response = await call_next(request)\n    return response\n</code></pre>"},{"location":"about/architecture/#scalability","title":"Scalability","text":""},{"location":"about/architecture/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Deploy multiple instances behind load balancer:</p> <pre><code>Load Balancer\n    \u251c\u2500\u2500 Instance 1 (4 workers)\n    \u251c\u2500\u2500 Instance 2 (4 workers)\n    \u251c\u2500\u2500 Instance 3 (4 workers)\n    \u2514\u2500\u2500 Instance 4 (4 workers)\n</code></pre>"},{"location":"about/architecture/#vertical-scaling","title":"Vertical Scaling","text":"<p>Optimize single instance:</p> <pre><code># More workers\nmcp.run(workers=16)\n\n# Larger connection pool\npool = await asyncpg.create_pool(max_size=100)\n</code></pre>"},{"location":"about/architecture/#security-architecture","title":"Security Architecture","text":""},{"location":"about/architecture/#1-oauth-21","title":"1. OAuth 2.1","text":"<ul> <li>PKCE required</li> <li>Secure token storage</li> <li>Automatic refresh</li> <li>Scope validation</li> </ul>"},{"location":"about/architecture/#2-input-validation","title":"2. Input Validation","text":"<ul> <li>Type checking via mypy</li> <li>Schema validation via JSON Schema</li> <li>Automatic sanitization</li> </ul>"},{"location":"about/architecture/#3-error-handling","title":"3. Error Handling","text":"<ul> <li>No stack traces in production</li> <li>Secure error messages</li> <li>Comprehensive logging</li> </ul>"},{"location":"about/architecture/#next-steps","title":"Next Steps","text":"<ul> <li>FAQ - Common questions</li> <li>Performance - Benchmarks</li> <li>Advanced - Deep dive</li> </ul>"},{"location":"about/changelog/","title":"Changelog","text":"<p>All notable changes to ChukMCPServer are documented here.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"about/changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"about/changelog/#added","title":"Added","text":"<ul> <li>Complete MkDocs documentation site</li> <li>Google Drive OAuth provider</li> <li>Advanced configuration examples</li> <li>Performance benchmarks</li> </ul>"},{"location":"about/changelog/#changed","title":"Changed","text":"<ul> <li>Restructured README for clarity</li> <li>Improved documentation navigation</li> </ul>"},{"location":"about/changelog/#100-2024-xx-xx","title":"[1.0.0] - 2024-XX-XX","text":""},{"location":"about/changelog/#added_1","title":"Added","text":"<ul> <li>Initial stable release</li> <li>STDIO transport support</li> <li>HTTP transport with Starlette</li> <li>OAuth 2.1 middleware with PKCE</li> <li>SmartConfig auto-detection system</li> <li>Cloud platform support (AWS, GCP, Azure, Edge)</li> <li>Type-safe tool/resource handlers</li> <li>Automatic schema generation</li> <li>Pre-cached schemas for performance</li> <li>Global decorator API (@tool, @resource, @prompt)</li> <li>Class-based API (ChukMCPServer)</li> <li>Zero-configuration deployment</li> <li>Docker support</li> <li>Comprehensive test suite (1400+ tests, 87%+ coverage)</li> </ul>"},{"location":"about/changelog/#performance","title":"Performance","text":"<ul> <li>39,000+ RPS with simple tools</li> <li>uvloop event loop integration</li> <li>orjson serialization</li> <li>Optimized worker count detection</li> <li>Connection pooling support</li> </ul>"},{"location":"about/changelog/#documentation","title":"Documentation","text":"<ul> <li>Complete API reference</li> <li>Getting started guide</li> <li>OAuth integration guide</li> <li>Deployment guides (HTTP, Docker, Cloud)</li> <li>Example servers (Calculator, Weather, Database)</li> <li>Performance benchmarks</li> <li>Contributing guide</li> </ul>"},{"location":"about/changelog/#090-2024-xx-xx","title":"[0.9.0] - 2024-XX-XX","text":""},{"location":"about/changelog/#added_2","title":"Added","text":"<ul> <li>Beta release</li> <li>Core MCP protocol implementation</li> <li>HTTP transport</li> <li>Basic tool/resource decorators</li> <li>SmartConfig system</li> <li>Cloud detection</li> </ul>"},{"location":"about/changelog/#changed_1","title":"Changed","text":"<ul> <li>Migrated from FastAPI to Starlette for performance</li> <li>Switched to uvloop event loop</li> <li>Improved type system</li> </ul>"},{"location":"about/changelog/#080-2024-xx-xx","title":"[0.8.0] - 2024-XX-XX","text":""},{"location":"about/changelog/#added_3","title":"Added","text":"<ul> <li>Alpha release</li> <li>Proof of concept</li> <li>Basic HTTP server</li> <li>Tool registration</li> </ul>"},{"location":"about/changelog/#version-history","title":"Version History","text":""},{"location":"about/changelog/#major-versions","title":"Major Versions","text":"<ul> <li>v1.0: Stable release with full OAuth support</li> <li>v0.9: Beta with cloud platform support</li> <li>v0.8: Alpha proof of concept</li> </ul>"},{"location":"about/changelog/#breaking-changes","title":"Breaking Changes","text":""},{"location":"about/changelog/#v100","title":"v1.0.0","text":"<ul> <li>None (first stable release)</li> </ul>"},{"location":"about/changelog/#v090","title":"v0.9.0","text":"<ul> <li>Changed from FastAPI to Starlette (transparent to users)</li> <li>Removed deprecated <code>run_http()</code> method (use <code>run(transport=\"http\")</code>)</li> </ul>"},{"location":"about/changelog/#migration-guides","title":"Migration Guides","text":""},{"location":"about/changelog/#upgrading-to-v10","title":"Upgrading to v1.0","text":"<p>From v0.9:</p> <pre><code># Before (v0.9)\nmcp.run_http(host=\"0.0.0.0\", port=8000)\n\n# After (v1.0)\nmcp.run(transport=\"http\", host=\"0.0.0.0\", port=8000)\n# or simply\nmcp.run()  # Auto-detects HTTP mode\n</code></pre>"},{"location":"about/changelog/#deprecation-notices","title":"Deprecation Notices","text":""},{"location":"about/changelog/#v10","title":"v1.0","text":"<ul> <li>None</li> </ul>"},{"location":"about/changelog/#future-deprecations","title":"Future Deprecations","text":"<ul> <li>None planned</li> </ul>"},{"location":"about/changelog/#security-advisories","title":"Security Advisories","text":"<p>No security issues reported.</p>"},{"location":"about/changelog/#performance-improvements","title":"Performance Improvements","text":""},{"location":"about/changelog/#v100_1","title":"v1.0.0","text":"<ul> <li>+25% throughput with uvloop</li> <li>+30% faster JSON with orjson</li> <li>+50% faster schema validation with pre-caching</li> </ul>"},{"location":"about/changelog/#v090_1","title":"v0.9.0","text":"<ul> <li>+15% throughput with Starlette migration</li> <li>+20% faster startup with lazy imports</li> </ul>"},{"location":"about/changelog/#acknowledgments","title":"Acknowledgments","text":""},{"location":"about/changelog/#contributors","title":"Contributors","text":"<ul> <li>Chris Hay - Creator and maintainer</li> </ul>"},{"location":"about/changelog/#special-thanks","title":"Special Thanks","text":"<ul> <li>Anthropic team for MCP protocol</li> <li>Starlette team for excellent ASGI framework</li> <li>uvloop team for performance improvements</li> </ul>"},{"location":"about/changelog/#links","title":"Links","text":"<ul> <li>PyPI</li> <li>GitHub</li> <li>Documentation</li> <li>Issues</li> </ul>"},{"location":"about/changelog/#support","title":"Support","text":"<ul> <li>GitHub Issues: Bug reports and feature requests</li> <li>GitHub Discussions: Questions and community support</li> <li>Discord: Real-time chat and help</li> </ul> <p>Note: This changelog is automatically updated for each release.</p>"},{"location":"about/faq/","title":"Frequently Asked Questions","text":"<p>Common questions about ChukMCPServer.</p>"},{"location":"about/faq/#general","title":"General","text":""},{"location":"about/faq/#what-is-chukmcpserver","title":"What is ChukMCPServer?","text":"<p>ChukMCPServer is a high-performance Python framework for building MCP (Model Context Protocol) servers. It provides zero-configuration deployment with automatic environment detection, achieving 39,000+ requests per second.</p>"},{"location":"about/faq/#why-chukmcpserver","title":"Why ChukMCPServer?","text":"<ul> <li>Zero Configuration: Auto-detects everything (project name, host, port, workers)</li> <li>High Performance: 39,000+ RPS with uvloop and orjson</li> <li>Developer Friendly: FastAPI-like decorator syntax</li> <li>Production Ready: Built-in OAuth, cloud support, comprehensive tests</li> </ul>"},{"location":"about/faq/#is-it-production-ready","title":"Is it production ready?","text":"<p>Yes! ChukMCPServer v1.0+ is production-ready with: - 87%+ test coverage (1400+ tests) - Type-safe with full mypy checking - Battle-tested in cloud environments - OAuth 2.1 with PKCE support</p>"},{"location":"about/faq/#whats-the-license","title":"What's the license?","text":"<p>MIT License - free for commercial and personal use. See License.</p>"},{"location":"about/faq/#installation","title":"Installation","text":""},{"location":"about/faq/#how-do-i-install-chukmcpserver","title":"How do I install ChukMCPServer?","text":"<pre><code>pip install chuk-mcp-server\n\n# With OAuth support\npip install chuk-mcp-server[google_drive]\n</code></pre>"},{"location":"about/faq/#what-python-version-is-required","title":"What Python version is required?","text":"<p>Python 3.11 or higher.</p>"},{"location":"about/faq/#can-i-use-pip-instead-of-uv","title":"Can I use pip instead of uv?","text":"<p>Yes! While uv is recommended for speed, standard pip works fine:</p> <pre><code>pip install chuk-mcp-server\n</code></pre>"},{"location":"about/faq/#usage","title":"Usage","text":""},{"location":"about/faq/#do-i-need-to-configure-anything","title":"Do I need to configure anything?","text":"<p>Nope! Just write your tools and run:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef hello(name: str) -&gt; str:\n    return f\"Hello, {name}!\"\n\nrun()  # Everything auto-detected\n</code></pre>"},{"location":"about/faq/#how-do-i-choose-http-vs-stdio-transport","title":"How do I choose HTTP vs STDIO transport?","text":"<pre><code># STDIO (default for Claude Desktop)\nrun()  # or run(transport=\"stdio\")\n\n# HTTP (for web APIs)\nrun(transport=\"http\")\n</code></pre> <p>ChukMCPServer auto-detects the best transport based on your environment.</p>"},{"location":"about/faq/#can-i-use-async-functions","title":"Can I use async functions?","text":"<p>Absolutely! ChukMCPServer handles both sync and async:</p> <pre><code>@tool\nasync def fetch_data(url: str) -&gt; dict:\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.json()\n</code></pre>"},{"location":"about/faq/#how-do-i-add-authentication","title":"How do I add authentication?","text":"<p>Use the built-in OAuth middleware:</p> <pre><code>from chuk_mcp_server import tool, requires_auth\n\n@tool\n@requires_auth(scopes=[\"read\"])\nasync def protected_tool(_external_access_token: str | None = None):\n    # Use token to call external API\n    return {\"data\": \"protected\"}\n</code></pre> <p>See OAuth Guide.</p>"},{"location":"about/faq/#performance","title":"Performance","text":""},{"location":"about/faq/#how-fast-is-chukmcpserver","title":"How fast is ChukMCPServer?","text":"<ul> <li>Simple tools: 35,000-40,000 RPS</li> <li>Database queries: 15,000-25,000 RPS</li> <li>External APIs: 5,000-15,000 RPS</li> </ul> <p>See Benchmarks.</p>"},{"location":"about/faq/#how-do-i-optimize-performance","title":"How do I optimize performance?","text":"<p>Most optimizations are automatic, but you can: 1. Use async for I/O operations 2. Enable connection pooling 3. Add caching where appropriate 4. Adjust worker count</p> <p>See Performance Guide.</p>"},{"location":"about/faq/#why-is-it-so-fast","title":"Why is it so fast?","text":"<ul> <li>uvloop: 2-4x faster event loop</li> <li>orjson: 2-3x faster JSON serialization</li> <li>Pre-cached schemas: Zero overhead at runtime</li> <li>Starlette: High-performance ASGI framework</li> </ul>"},{"location":"about/faq/#deployment","title":"Deployment","text":""},{"location":"about/faq/#how-do-i-deploy-to-production","title":"How do I deploy to production?","text":"<p>Multiple options:</p> <pre><code># HTTP mode (easiest)\npython server.py\n\n# Docker\ndocker build -t my-mcp-server .\ndocker run -p 8000:8000 my-mcp-server\n\n# Cloud platforms (auto-detected)\n# Just deploy - ChukMCPServer adapts automatically\n</code></pre> <p>See Deployment Guides.</p>"},{"location":"about/faq/#does-it-work-in-docker","title":"Does it work in Docker?","text":"<p>Yes! ChukMCPServer auto-detects Docker and optimizes accordingly:</p> <pre><code>FROM python:3.11-slim\nWORKDIR /app\nCOPY . .\nRUN pip install chuk-mcp-server\nCMD [\"python\", \"server.py\"]\n</code></pre>"},{"location":"about/faq/#what-cloud-platforms-are-supported","title":"What cloud platforms are supported?","text":"<p>All major platforms with auto-detection: - Google Cloud (Cloud Run, Cloud Functions) - AWS (Lambda, ECS, Fargate) - Azure (Functions, Container Apps) - Edge (Vercel, Netlify, Cloudflare Workers)</p> <p>See Cloud Deployment.</p>"},{"location":"about/faq/#integration","title":"Integration","text":""},{"location":"about/faq/#can-i-integrate-with-claude-desktop","title":"Can I integrate with Claude Desktop?","text":"<p>Yes! ChukMCPServer works perfectly with Claude Desktop via STDIO transport.</p> <p>See Claude Desktop Guide.</p>"},{"location":"about/faq/#can-i-use-it-with-fastapi","title":"Can I use it with FastAPI?","text":"<p>Yes! Mount ChukMCPServer into your FastAPI app:</p> <pre><code>from fastapi import FastAPI\nfrom chuk_mcp_server import ChukMCPServer\n\napp = FastAPI()\nmcp = ChukMCPServer(name=\"my-server\")\n\napp.mount(\"/mcp\", mcp.app)\n</code></pre>"},{"location":"about/faq/#does-it-work-with-existing-python-projects","title":"Does it work with existing Python projects?","text":"<p>Absolutely! ChukMCPServer is just a library - integrate it anywhere:</p> <pre><code>from your_project import business_logic\nfrom chuk_mcp_server import tool\n\n@tool\ndef process_data(data: dict) -&gt; dict:\n    return business_logic.process(data)\n</code></pre>"},{"location":"about/faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"about/faq/#tests-are-failing","title":"Tests are failing","text":"<pre><code># Run tests locally\nmake test\n\n# Check specific test\npytest tests/test_file.py::test_name -v\n\n# Debug\npytest --pdb\n</code></pre>"},{"location":"about/faq/#type-errors-with-mypy","title":"Type errors with mypy","text":"<p>Ensure all functions have type hints:</p> <pre><code># \u274c Bad\ndef my_tool(data):\n    return data\n\n# \u2705 Good\ndef my_tool(data: dict) -&gt; dict:\n    return data\n</code></pre>"},{"location":"about/faq/#import-errors","title":"Import errors","text":"<p>Check your installation:</p> <pre><code>pip list | grep chuk-mcp-server\n\n# Reinstall if needed\npip install --force-reinstall chuk-mcp-server\n</code></pre>"},{"location":"about/faq/#performance-issues","title":"Performance issues","text":"<ol> <li>Check worker count: <code>mcp.run(workers=16)</code></li> <li>Use async for I/O: <code>async def my_tool()</code></li> <li>Enable connection pooling</li> <li>Profile with benchmarks: <code>python benchmarks/quick_benchmark.py</code></li> </ol>"},{"location":"about/faq/#development","title":"Development","text":""},{"location":"about/faq/#how-do-i-contribute","title":"How do I contribute?","text":"<p>We welcome contributions! See Contributing Guide.</p> <ol> <li>Fork the repository</li> <li>Create a feature branch</li> <li>Make your changes with tests</li> <li>Submit a pull request</li> </ol>"},{"location":"about/faq/#how-do-i-run-tests","title":"How do I run tests?","text":"<pre><code># All tests\nmake test\n\n# With coverage\nmake test-cov\n\n# Specific test\npytest tests/test_file.py -v\n</code></pre>"},{"location":"about/faq/#how-do-i-report-bugs","title":"How do I report bugs?","text":"<p>Open an issue with: - Description of the issue - Minimal reproduction example - Expected vs actual behavior - Python version and OS</p>"},{"location":"about/faq/#support","title":"Support","text":""},{"location":"about/faq/#where-can-i-get-help","title":"Where can I get help?","text":"<ul> <li>Documentation: You're reading it!</li> <li>GitHub Issues: Bug reports</li> <li>GitHub Discussions: Questions</li> <li>Discord: Real-time chat</li> </ul>"},{"location":"about/faq/#is-commercial-support-available","title":"Is commercial support available?","text":"<p>Yes! Contact for enterprise support options: - Priority bug fixes - Custom features - Training and consulting</p>"},{"location":"about/faq/#still-have-questions","title":"Still Have Questions?","text":"<ul> <li>Read the docs</li> <li>Check examples</li> <li>Ask on GitHub</li> <li>Join Discord</li> </ul>"},{"location":"about/license/","title":"License","text":"<p>ChukMCPServer is licensed under the MIT License.</p>"},{"location":"about/license/#mit-license","title":"MIT License","text":"<pre><code>MIT License\n\nCopyright (c) 2024 Chris Hay\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n</code></pre>"},{"location":"about/license/#what-this-means","title":"What This Means","text":""},{"location":"about/license/#you-can","title":"\u2705 You Can","text":"<ul> <li>Use - Use ChukMCPServer in any project (commercial or personal)</li> <li>Modify - Change the code to fit your needs</li> <li>Distribute - Share ChukMCPServer with others</li> <li>Sublicense - Include in proprietary software</li> <li>Sell - Use in commercial products</li> </ul>"},{"location":"about/license/#you-must","title":"\ud83d\udccb You Must","text":"<ul> <li>Include License - Include the license and copyright notice in copies</li> <li>Include Notice - State that you're using ChukMCPServer</li> </ul>"},{"location":"about/license/#you-cannot","title":"\u274c You Cannot","text":"<ul> <li>Hold Liable - The authors are not liable for any damages</li> <li>Use Trademark - Use ChukMCPServer name/logo without permission</li> </ul>"},{"location":"about/license/#third-party-licenses","title":"Third-Party Licenses","text":"<p>ChukMCPServer depends on these open-source projects:</p>"},{"location":"about/license/#core-dependencies","title":"Core Dependencies","text":"<ul> <li>Starlette - MIT License</li> <li>uvloop - MIT License / Apache 2.0</li> <li>orjson - MIT License / Apache 2.0</li> <li>httpx - BSD 3-Clause License</li> <li>Pydantic - MIT License</li> </ul>"},{"location":"about/license/#oauth-dependencies","title":"OAuth Dependencies","text":"<ul> <li>authlib - BSD 3-Clause License</li> </ul>"},{"location":"about/license/#development-dependencies","title":"Development Dependencies","text":"<ul> <li>pytest - MIT License</li> <li>ruff - MIT License</li> <li>mypy - MIT License</li> <li>black - MIT License</li> </ul> <p>Full dependency licenses are included in the package distribution.</p>"},{"location":"about/license/#attribution","title":"Attribution","text":"<p>If you use ChukMCPServer in your project, attribution is appreciated but not required:</p>"},{"location":"about/license/#markdown","title":"Markdown","text":"<pre><code>Built with [ChukMCPServer](https://github.com/chrishayuk/chuk-mcp-server)\n</code></pre>"},{"location":"about/license/#html","title":"HTML","text":"<pre><code>&lt;p&gt;Built with &lt;a href=\"https://github.com/chrishayuk/chuk-mcp-server\"&gt;ChukMCPServer&lt;/a&gt;&lt;/p&gt;\n</code></pre>"},{"location":"about/license/#documentation","title":"Documentation","text":"<pre><code>This project uses ChukMCPServer (https://github.com/chrishayuk/chuk-mcp-server)\n</code></pre>"},{"location":"about/license/#contributing","title":"Contributing","text":"<p>By contributing to ChukMCPServer, you agree that your contributions will be licensed under the MIT License.</p> <p>See Contributing Guide for details.</p>"},{"location":"about/license/#commercial-use","title":"Commercial Use","text":"<p>ChukMCPServer is free for commercial use. No license fees, no restrictions.</p>"},{"location":"about/license/#examples-of-commercial-use","title":"Examples of Commercial Use","text":"<p>\u2705 SaaS products \u2705 Internal tools \u2705 Client projects \u2705 Consulting work \u2705 Training courses \u2705 Books/tutorials</p>"},{"location":"about/license/#support-options","title":"Support Options","text":"<p>While ChukMCPServer is free, commercial support is available:</p> <ul> <li>Community Support - Free via GitHub Issues/Discussions</li> <li>Priority Support - Available for enterprise (contact for pricing)</li> <li>Custom Development - Available for hire</li> </ul>"},{"location":"about/license/#trademark","title":"Trademark","text":"<p>\"ChukMCPServer\" and associated logos are trademarks of Chris Hay.</p> <p>You may: - Reference the project by name - Use the name in documentation - Describe your project as \"using ChukMCPServer\"</p> <p>You may not: - Imply official endorsement - Use the name in a confusing way - Modify the logo</p>"},{"location":"about/license/#questions","title":"Questions","text":"<p>For licensing questions: - Email: [contact info] - GitHub: Open an issue</p>"},{"location":"about/license/#next-steps","title":"Next Steps","text":"<ul> <li>Contributing - How to contribute</li> <li>FAQ - Common questions</li> <li>GitHub - Source code</li> </ul>"},{"location":"advanced/composition/","title":"Server Composition","text":"<p>Compose multiple MCP servers or integrate with existing applications.</p>"},{"location":"advanced/composition/#multiple-tool-sets","title":"Multiple Tool Sets","text":"<p>Organize tools across modules:</p> <pre><code># tools/math.py\nfrom chuk_mcp_server import tool\n\n@tool\ndef add(a: int, b: int) -&gt; int:\n    return a + b\n\n@tool\ndef multiply(a: int, b: int) -&gt; int:\n    return a * b\n</code></pre> <pre><code># tools/text.py\nfrom chuk_mcp_server import tool\n\n@tool\ndef uppercase(text: str) -&gt; str:\n    return text.upper()\n\n@tool\ndef reverse(text: str) -&gt; str:\n    return text[::-1]\n</code></pre> <pre><code># main.py\nfrom chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"composite-server\")\n\n# Import all tool modules\nimport tools.math\nimport tools.text\n\nmcp.run()\n</code></pre>"},{"location":"advanced/composition/#composing-servers","title":"Composing Servers","text":"<p>Combine multiple server configurations:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\n\n# Base server\nbase_mcp = ChukMCPServer(name=\"base-server\")\n\n@base_mcp.tool\ndef core_function():\n    return \"core\"\n\n# Extended server (inherits base tools)\nextended_mcp = ChukMCPServer(name=\"extended-server\")\n\n# Copy tools from base\nfor tool_name, tool_handler in base_mcp._tool_handlers.items():\n    extended_mcp._tool_handlers[tool_name] = tool_handler\n\n@extended_mcp.tool\ndef extended_function():\n    return \"extended\"\n\nextended_mcp.run()\n</code></pre>"},{"location":"advanced/composition/#integration-with-fastapi","title":"Integration with FastAPI","text":"<p>Integrate ChukMCPServer into existing FastAPI app:</p> <pre><code>from fastapi import FastAPI\nfrom chuk_mcp_server import ChukMCPServer\n\n# Existing FastAPI app\napp = FastAPI()\n\n@app.get(\"/api/hello\")\nasync def hello():\n    return {\"message\": \"Hello from FastAPI\"}\n\n# Add MCP server\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef mcp_tool():\n    return \"MCP tool result\"\n\n# Mount MCP routes\napp.mount(\"/mcp\", mcp.app)\n\n# Run with uvicorn\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n</code></pre>"},{"location":"advanced/composition/#integration-with-starlette","title":"Integration with Starlette","text":"<p>Direct Starlette integration:</p> <pre><code>from starlette.applications import Starlette\nfrom starlette.routing import Route, Mount\nfrom chuk_mcp_server import ChukMCPServer\n\nasync def homepage(request):\n    return JSONResponse({'hello': 'world'})\n\n# Create MCP server\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef my_tool():\n    return \"result\"\n\n# Compose routes\nroutes = [\n    Route('/', homepage),\n    Mount('/mcp', app=mcp.app),\n]\n\napp = Starlette(routes=routes)\n</code></pre>"},{"location":"advanced/composition/#plugin-architecture","title":"Plugin Architecture","text":"<p>Create a plugin system:</p> <pre><code># plugin_base.py\nfrom abc import ABC, abstractmethod\nfrom chuk_mcp_server import ChukMCPServer\n\nclass MCPPlugin(ABC):\n    @abstractmethod\n    def register(self, mcp: ChukMCPServer):\n        \"\"\"Register plugin tools with MCP server.\"\"\"\n        pass\n</code></pre> <pre><code># plugins/calculator.py\nfrom plugin_base import MCPPlugin\nfrom chuk_mcp_server import ChukMCPServer\n\nclass CalculatorPlugin(MCPPlugin):\n    def register(self, mcp: ChukMCPServer):\n        @mcp.tool\n        def add(a: int, b: int) -&gt; int:\n            return a + b\n\n        @mcp.tool\n        def subtract(a: int, b: int) -&gt; int:\n            return a - b\n</code></pre> <pre><code># plugins/weather.py\nfrom plugin_base import MCPPlugin\nfrom chuk_mcp_server import ChukMCPServer\n\nclass WeatherPlugin(MCPPlugin):\n    def register(self, mcp: ChukMCPServer):\n        @mcp.tool\n        def get_weather(city: str) -&gt; dict:\n            return {\"city\": city, \"temp\": 72}\n</code></pre> <pre><code># main.py\nfrom chuk_mcp_server import ChukMCPServer\nfrom plugins.calculator import CalculatorPlugin\nfrom plugins.weather import WeatherPlugin\n\nmcp = ChukMCPServer(name=\"plugin-server\")\n\n# Register plugins\nplugins = [\n    CalculatorPlugin(),\n    WeatherPlugin(),\n]\n\nfor plugin in plugins:\n    plugin.register(mcp)\n\nmcp.run()\n</code></pre>"},{"location":"advanced/composition/#dynamic-tool-loading","title":"Dynamic Tool Loading","text":"<p>Load tools dynamically:</p> <pre><code>import importlib\nimport pkgutil\nfrom chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"dynamic-server\")\n\n# Discover and load all modules in 'tools' package\nimport tools\nfor importer, modname, ispkg in pkgutil.iter_modules(tools.__path__):\n    module = importlib.import_module(f'tools.{modname}')\n    print(f\"Loaded tools from {modname}\")\n\nmcp.run()\n</code></pre>"},{"location":"advanced/composition/#shared-state","title":"Shared State","text":"<p>Share state between tools:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom dataclasses import dataclass\nfrom typing import Optional\n\n@dataclass\nclass ServerState:\n    user_count: int = 0\n    cache: dict = None\n\n    def __post_init__(self):\n        if self.cache is None:\n            self.cache = {}\n\n# Create shared state\nstate = ServerState()\n\nmcp = ChukMCPServer(name=\"stateful-server\")\n\n@mcp.tool\ndef increment_users() -&gt; int:\n    state.user_count += 1\n    return state.user_count\n\n@mcp.tool\ndef get_users() -&gt; int:\n    return state.user_count\n\n@mcp.tool\ndef cache_value(key: str, value: str) -&gt; str:\n    state.cache[key] = value\n    return f\"Cached {key}\"\n\n@mcp.tool\ndef get_cached(key: str) -&gt; Optional[str]:\n    return state.cache.get(key)\n\nmcp.run()\n</code></pre>"},{"location":"advanced/composition/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Advanced configuration</li> <li>Performance - Optimization</li> <li>Production - Deployment</li> </ul>"},{"location":"advanced/configuration/","title":"Advanced Configuration","text":"<p>Deep dive into ChukMCPServer configuration options.</p>"},{"location":"advanced/configuration/#smartconfig-system","title":"SmartConfig System","text":"<p>ChukMCPServer uses a modular detection system:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.config import SmartConfig\n\n# Auto-detection (recommended)\nmcp = ChukMCPServer(name=\"my-server\")\nmcp.run()  # Everything auto-detected\n\n# Manual configuration\nconfig = SmartConfig(\n    project_name=\"my-custom-name\",\n    host=\"0.0.0.0\",\n    port=9000,\n    workers=8,\n    log_level=\"debug\"\n)\nmcp = ChukMCPServer.from_config(config)\n</code></pre>"},{"location":"advanced/configuration/#configuration-detectors","title":"Configuration Detectors","text":""},{"location":"advanced/configuration/#projectdetector","title":"ProjectDetector","text":"<p>Auto-detects project name from: - <code>pyproject.toml</code> - <code>setup.py</code> - Directory name</p> <pre><code>from chuk_mcp_server.config import ProjectDetector\n\ndetector = ProjectDetector()\nname = detector.detect()  # \"my-mcp-server\"\n</code></pre>"},{"location":"advanced/configuration/#environmentdetector","title":"EnvironmentDetector","text":"<p>Identifies environment: - Development - Production - Container (Docker/K8s) - Serverless (Lambda/Cloud Functions)</p> <pre><code>from chuk_mcp_server.config import EnvironmentDetector\n\ndetector = EnvironmentDetector()\nenv = detector.detect()  # \"development\" | \"production\" | \"container\" | \"serverless\"\n</code></pre>"},{"location":"advanced/configuration/#networkdetector","title":"NetworkDetector","text":"<p>Optimizes network settings:</p> <pre><code>from chuk_mcp_server.config import NetworkDetector\n\ndetector = NetworkDetector()\nhost, port = detector.detect()\n\n# Development: localhost:8000\n# Container: 0.0.0.0:8000\n# Cloud: 0.0.0.0:$PORT\n</code></pre>"},{"location":"advanced/configuration/#systemdetector","title":"SystemDetector","text":"<p>Hardware optimization:</p> <pre><code>from chuk_mcp_server.config import SystemDetector\n\ndetector = SystemDetector()\nworkers = detector.detect_workers()  # CPU count * 2 + 1\n</code></pre>"},{"location":"advanced/configuration/#environment-variables","title":"Environment Variables","text":"<p>Override any setting:</p> <pre><code># Network\nexport CHUK_HOST=0.0.0.0\nexport CHUK_PORT=9000\n\n# Performance\nexport CHUK_WORKERS=16\nexport CHUK_LOG_LEVEL=debug\n\n# Features\nexport CHUK_ENABLE_CORS=true\nexport CHUK_ENABLE_METRICS=true\n</code></pre>"},{"location":"advanced/configuration/#runtime-configuration","title":"Runtime Configuration","text":"<p>Change settings at runtime:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n# Add custom middleware\n@mcp.app.middleware(\"http\")\nasync def custom_middleware(request, call_next):\n    # Custom logic\n    response = await call_next(request)\n    return response\n\n# Add custom routes\n@mcp.app.get(\"/health\")\nasync def health_check():\n    return {\"status\": \"healthy\"}\n\nmcp.run()\n</code></pre>"},{"location":"advanced/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Logging - Advanced logging</li> <li>Performance - Optimization tips</li> <li>Deployment - Production setup</li> </ul>"},{"location":"advanced/logging/","title":"Advanced Logging","text":"<p>Configure logging for debugging and production monitoring.</p>"},{"location":"advanced/logging/#log-levels","title":"Log Levels","text":"<p>ChukMCPServer uses Python's standard logging:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\n\n# Development: detailed logs\nmcp = ChukMCPServer(name=\"my-server\")\nmcp.run(log_level=\"debug\")\n\n# Production: minimal logs\nmcp.run(log_level=\"warning\")\n</code></pre> <p>Available levels: - <code>debug</code> - Verbose, all operations - <code>info</code> - Normal operations - <code>warning</code> - Warning messages - <code>error</code> - Error messages only - <code>critical</code> - Critical errors only</p>"},{"location":"advanced/logging/#custom-logger","title":"Custom Logger","text":"<p>Use your own logger:</p> <pre><code>import logging\nfrom chuk_mcp_server import ChukMCPServer\n\n# Configure custom logger\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',\n    handlers=[\n        logging.FileHandler('mcp_server.log'),\n        logging.StreamHandler()\n    ]\n)\n\nlogger = logging.getLogger(\"my_mcp_server\")\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef my_tool():\n    logger.info(\"Tool called\")\n    return \"result\"\n\nmcp.run()\n</code></pre>"},{"location":"advanced/logging/#structured-logging","title":"Structured Logging","text":"<p>For production systems:</p> <pre><code>import structlog\nfrom chuk_mcp_server import ChukMCPServer\n\n# Configure structlog\nstructlog.configure(\n    processors=[\n        structlog.processors.TimeStamper(fmt=\"iso\"),\n        structlog.stdlib.add_log_level,\n        structlog.processors.JSONRenderer()\n    ]\n)\n\nlogger = structlog.get_logger()\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef process_data(data: dict):\n    logger.info(\"processing_data\", \n                data_size=len(data),\n                user_id=data.get(\"user_id\"))\n    return {\"processed\": True}\n\nmcp.run()\n</code></pre>"},{"location":"advanced/logging/#request-logging","title":"Request Logging","text":"<p>Log all MCP requests:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.app.middleware(\"http\")\nasync def log_requests(request, call_next):\n    logger.info(f\"Request: {request.method} {request.url}\")\n    response = await call_next(request)\n    logger.info(f\"Response: {response.status_code}\")\n    return response\n\nmcp.run()\n</code></pre>"},{"location":"advanced/logging/#error-tracking","title":"Error Tracking","text":"<p>Integrate with error tracking services:</p> <pre><code>import sentry_sdk\nfrom chuk_mcp_server import ChukMCPServer\n\n# Initialize Sentry\nsentry_sdk.init(\n    dsn=\"your-sentry-dsn\",\n    traces_sample_rate=1.0,\n)\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef risky_operation():\n    try:\n        # Operation that might fail\n        result = perform_operation()\n        return result\n    except Exception as e:\n        sentry_sdk.capture_exception(e)\n        raise\n\nmcp.run()\n</code></pre>"},{"location":"advanced/logging/#performance-logging","title":"Performance Logging","text":"<p>Track performance metrics:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nimport time\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.tool\ndef slow_operation():\n    start = time.time()\n\n    # Do work\n    result = compute_something()\n\n    duration = time.time() - start\n    logger.info(f\"Operation took {duration:.2f}s\")\n\n    if duration &gt; 1.0:\n        logger.warning(f\"Slow operation: {duration:.2f}s\")\n\n    return result\n\nmcp.run()\n</code></pre>"},{"location":"advanced/logging/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Advanced config</li> <li>Performance - Optimization</li> <li>Production - Deployment</li> </ul>"},{"location":"advanced/performance/","title":"Performance Optimization","text":"<p>Get the most out of ChukMCPServer's 39,000+ RPS capability.</p>"},{"location":"advanced/performance/#built-in-optimizations","title":"Built-in Optimizations","text":"<p>ChukMCPServer is optimized by default:</p> <p>\u2705 uvloop - 2-4x faster than standard asyncio \u2705 orjson - 2-3x faster JSON serialization \u2705 Pre-cached schemas - Zero overhead at runtime \u2705 Smart worker count - Optimized for your CPU \u2705 Connection pooling - Efficient resource usage</p>"},{"location":"advanced/performance/#worker-configuration","title":"Worker Configuration","text":"<p>Optimize worker count for your workload:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nimport os\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n# Auto-detect (recommended)\nmcp.run()  # Uses (CPU count * 2) + 1\n\n# Manual override\nmcp.run(workers=16)\n\n# Environment variable\n# export CHUK_WORKERS=16\nmcp.run()\n</code></pre> <p>Worker count guidelines: - I/O bound (databases, APIs): <code>(CPU count * 2) + 1</code> - CPU bound: <code>CPU count</code> - Mixed: <code>CPU count * 1.5</code></p>"},{"location":"advanced/performance/#async-everything","title":"Async Everything","text":"<p>Use async for I/O operations:</p> <pre><code>from chuk_mcp_server import tool\nimport httpx\n\n# \u274c Slow: blocking I/O\n@tool\ndef fetch_data(url: str) -&gt; dict:\n    import requests\n    return requests.get(url).json()\n\n# \u2705 Fast: async I/O\n@tool\nasync def fetch_data(url: str) -&gt; dict:\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.json()\n</code></pre>"},{"location":"advanced/performance/#connection-pooling","title":"Connection Pooling","text":"<p>Reuse connections for databases and APIs:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nimport httpx\nimport asyncpg\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n# Global connection pool\nhttp_client = httpx.AsyncClient()\ndb_pool = None\n\nasync def startup():\n    global db_pool\n    db_pool = await asyncpg.create_pool(\n        'postgresql://user:pass@localhost/db',\n        min_size=10,\n        max_size=20\n    )\n\n@mcp.tool\nasync def query_database(query: str) -&gt; list:\n    async with db_pool.acquire() as conn:\n        return await conn.fetch(query)\n\n@mcp.tool\nasync def fetch_api(url: str) -&gt; dict:\n    response = await http_client.get(url)\n    return response.json()\n\nif __name__ == \"__main__\":\n    import asyncio\n    asyncio.run(startup())\n    mcp.run()\n</code></pre>"},{"location":"advanced/performance/#caching","title":"Caching","text":"<p>Cache expensive computations:</p> <pre><code>from chuk_mcp_server import tool\nfrom functools import lru_cache\nimport asyncio\n\n# Sync caching\n@lru_cache(maxsize=1000)\ndef expensive_computation(x: int) -&gt; int:\n    return x ** 2\n\n@tool\ndef compute(x: int) -&gt; int:\n    return expensive_computation(x)\n\n# Async caching\nfrom aiocache import cached\n\n@tool\n@cached(ttl=60)  # Cache for 60 seconds\nasync def fetch_expensive_data(key: str) -&gt; dict:\n    # Expensive operation\n    await asyncio.sleep(1)\n    return {\"data\": key}\n</code></pre>"},{"location":"advanced/performance/#batching","title":"Batching","text":"<p>Batch requests for efficiency:</p> <pre><code>from chuk_mcp_server import tool\nfrom typing import List\n\n@tool\nasync def batch_query(ids: List[int]) -&gt; List[dict]:\n    \"\"\"Query multiple records at once.\"\"\"\n    async with db_pool.acquire() as conn:\n        # Single query instead of N queries\n        results = await conn.fetch(\n            \"SELECT * FROM items WHERE id = ANY($1)\",\n            ids\n        )\n        return [dict(r) for r in results]\n</code></pre>"},{"location":"advanced/performance/#profiling","title":"Profiling","text":"<p>Identify bottlenecks:</p> <pre><code>from chuk_mcp_server import tool\nimport time\nimport logging\n\nlogger = logging.getLogger(__name__)\n\n@tool\nasync def slow_tool():\n    start = time.perf_counter()\n\n    # Your logic\n    result = await compute_something()\n\n    duration = time.perf_counter() - start\n    logger.info(f\"slow_tool took {duration:.3f}s\")\n\n    return result\n</code></pre>"},{"location":"advanced/performance/#memory-optimization","title":"Memory Optimization","text":"<p>Reduce memory usage:</p> <pre><code>from chuk_mcp_server import tool\nfrom typing import Iterator\n\n# \u274c Memory intensive\n@tool\ndef process_large_file(path: str) -&gt; list:\n    with open(path) as f:\n        return [line.strip() for line in f]\n\n# \u2705 Memory efficient\n@tool\ndef process_large_file(path: str) -&gt; str:\n    count = 0\n    with open(path) as f:\n        for line in f:\n            count += 1\n    return f\"Processed {count} lines\"\n</code></pre>"},{"location":"advanced/performance/#load-testing","title":"Load Testing","text":"<p>Benchmark your server:</p> <pre><code># Using Apache Bench\nab -n 10000 -c 100 http://localhost:8000/mcp\n\n# Using wrk\nwrk -t12 -c400 -d30s http://localhost:8000/mcp\n\n# Using hey\nhey -n 10000 -c 100 http://localhost:8000/mcp\n</code></pre> <p>ChukMCPServer benchmark:</p> <pre><code>python benchmarks/ultra_minimal_mcp_performance_test.py\n</code></pre> <p>Expected results: - Simple tools: 35,000-40,000 RPS - Database queries: 15,000-25,000 RPS - External APIs: 5,000-15,000 RPS</p>"},{"location":"advanced/performance/#monitoring","title":"Monitoring","text":"<p>Track performance in production:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom prometheus_client import Counter, Histogram\nimport time\n\n# Metrics\nrequest_count = Counter('mcp_requests_total', 'Total requests')\nrequest_duration = Histogram('mcp_request_duration_seconds', 'Request duration')\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.app.middleware(\"http\")\nasync def metrics_middleware(request, call_next):\n    request_count.inc()\n\n    start = time.perf_counter()\n    response = await call_next(request)\n    duration = time.perf_counter() - start\n\n    request_duration.observe(duration)\n\n    return response\n\nmcp.run()\n</code></pre>"},{"location":"advanced/performance/#next-steps","title":"Next Steps","text":"<ul> <li>Benchmarks - Performance testing</li> <li>Optimization - More tips</li> <li>Production - Deployment</li> </ul>"},{"location":"advanced/proxy/","title":"Proxy and Reverse Proxy","text":"<p>Deploy ChukMCPServer behind a proxy or load balancer.</p>"},{"location":"advanced/proxy/#nginx-reverse-proxy","title":"Nginx Reverse Proxy","text":"<p>Basic Nginx configuration:</p> <pre><code>server {\n    listen 80;\n    server_name api.example.com;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n\n        # SSE support (for MCP streaming)\n        proxy_buffering off;\n        proxy_set_header X-Accel-Buffering no;\n    }\n}\n</code></pre> <p>With SSL:</p> <pre><code>server {\n    listen 443 ssl http2;\n    server_name api.example.com;\n\n    ssl_certificate /path/to/cert.pem;\n    ssl_certificate_key /path/to/key.pem;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # SSE support\n        proxy_buffering off;\n        proxy_set_header X-Accel-Buffering no;\n    }\n}\n</code></pre>"},{"location":"advanced/proxy/#apache-reverse-proxy","title":"Apache Reverse Proxy","text":"<p>Enable required modules:</p> <pre><code>a2enmod proxy\na2enmod proxy_http\na2enmod proxy_wstunnel\na2enmod ssl\nsystemctl restart apache2\n</code></pre> <p>Configuration:</p> <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName api.example.com\n\n    SSLEngine on\n    SSLCertificateFile /path/to/cert.pem\n    SSLCertificateKeyFile /path/to/key.pem\n\n    ProxyPreserveHost On\n    ProxyPass / http://localhost:8000/\n    ProxyPassReverse / http://localhost:8000/\n\n    # SSE support\n    ProxyPass / http://localhost:8000/ disablereuse=on\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"advanced/proxy/#traefik","title":"Traefik","text":"<p>Docker Compose with Traefik:</p> <pre><code>version: '3.8'\n\nservices:\n  traefik:\n    image: traefik:v2.10\n    command:\n      - \"--api.insecure=true\"\n      - \"--providers.docker=true\"\n      - \"--entrypoints.web.address=:80\"\n      - \"--entrypoints.websecure.address=:443\"\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n      - \"8080:8080\"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n\n  mcp-server:\n    image: your-mcp-server\n    labels:\n      - \"traefik.enable=true\"\n      - \"traefik.http.routers.mcp.rule=Host(`api.example.com`)\"\n      - \"traefik.http.routers.mcp.entrypoints=websecure\"\n      - \"traefik.http.routers.mcp.tls=true\"\n      - \"traefik.http.services.mcp.loadbalancer.server.port=8000\"\n</code></pre>"},{"location":"advanced/proxy/#caddy","title":"Caddy","text":"<p>Simplest option with automatic HTTPS:</p> <pre><code>api.example.com {\n    reverse_proxy localhost:8000 {\n        # SSE support\n        flush_interval -1\n    }\n}\n</code></pre> <p>Run Caddy:</p> <pre><code>caddy run --config Caddyfile\n</code></pre>"},{"location":"advanced/proxy/#load-balancing","title":"Load Balancing","text":"<p>Nginx with multiple backend servers:</p> <pre><code>upstream mcp_servers {\n    least_conn;  # Use least connections algorithm\n    server localhost:8000;\n    server localhost:8001;\n    server localhost:8002;\n    server localhost:8003;\n}\n\nserver {\n    listen 80;\n    server_name api.example.com;\n\n    location / {\n        proxy_pass http://mcp_servers;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n\n        # SSE support\n        proxy_buffering off;\n        proxy_set_header X-Accel-Buffering no;\n    }\n}\n</code></pre> <p>Start multiple ChukMCPServer instances:</p> <pre><code># Terminal 1\nPORT=8000 python server.py\n\n# Terminal 2\nPORT=8001 python server.py\n\n# Terminal 3\nPORT=8002 python server.py\n\n# Terminal 4\nPORT=8003 python server.py\n</code></pre>"},{"location":"advanced/proxy/#health-checks","title":"Health Checks","text":"<p>Add health endpoint:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"my-server\")\n\n@mcp.app.get(\"/health\")\nasync def health_check():\n    return {\n        \"status\": \"healthy\",\n        \"version\": \"1.0.0\"\n    }\n\nmcp.run()\n</code></pre> <p>Nginx health check:</p> <pre><code>upstream mcp_servers {\n    server localhost:8000 max_fails=3 fail_timeout=30s;\n    server localhost:8001 max_fails=3 fail_timeout=30s;\n}\n</code></pre>"},{"location":"advanced/proxy/#cors-with-proxy","title":"CORS with Proxy","text":"<p>ChukMCPServer handles CORS automatically, but if needed:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom starlette.middleware.cors import CORSMiddleware\n\nmcp = ChukMCPServer(name=\"my-server\")\n\nmcp.app.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"https://example.com\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nmcp.run()\n</code></pre>"},{"location":"advanced/proxy/#next-steps","title":"Next Steps","text":"<ul> <li>Production - Production best practices</li> <li>Docker - Containerization</li> <li>Cloud - Cloud deployment</li> </ul>"},{"location":"api/cloud/","title":"Cloud API","text":"<p>API reference for cloud platform support.</p>"},{"location":"api/cloud/#auto-detection","title":"Auto-Detection","text":"<p>Cloud platforms are detected automatically:</p> <pre><code>from chuk_mcp_server import run\n\nrun()  # Auto-detects and optimizes\n</code></pre>"},{"location":"api/cloud/#detected-platforms","title":"Detected Platforms","text":"<ul> <li>Google Cloud Platform (GCF, Cloud Run)</li> <li>AWS (Lambda, ECS, Fargate)</li> <li>Azure (Functions, Container Apps)</li> <li>Vercel, Netlify, Cloudflare Workers</li> </ul>"},{"location":"api/cloud/#cloud-adapters","title":"Cloud Adapters","text":"<p>Advanced usage:</p> <pre><code>from chuk_mcp_server.cloud import get_cloud_adapter\n\nadapter = get_cloud_adapter()\nif adapter:\n    print(f\"Running on: {adapter.platform}\")\n</code></pre>"},{"location":"api/cloud/#next-steps","title":"Next Steps","text":"<ul> <li>Cloud Deployment - Deploy guide</li> <li>Docker - Containers</li> <li>Production - Best practices</li> </ul>"},{"location":"api/decorators/","title":"Decorators API","text":"<p>Complete API reference for ChukMCPServer decorators.</p>"},{"location":"api/decorators/#tool","title":"@tool","text":"<p>Register a tool (action Claude can perform).</p> <pre><code>@tool\ndef my_tool(param: str) -&gt; dict:\n    \"\"\"Tool description.\"\"\"\n    return {\"result\": param}\n</code></pre> <p>Parameters: - <code>name</code> (optional): Custom tool name</p>"},{"location":"api/decorators/#resource","title":"@resource","text":"<p>Register a resource (read-only data).</p> <pre><code>@resource(\"config://app\")\ndef get_config() -&gt; dict:\n    \"\"\"Resource description.\"\"\"\n    return {\"version\": \"1.0.0\"}\n</code></pre> <p>Parameters: - <code>uri</code> (required): Resource URI</p>"},{"location":"api/decorators/#prompt","title":"@prompt","text":"<p>Register a prompt template.</p> <pre><code>@prompt\ndef code_review(code: str) -&gt; str:\n    \"\"\"Prompt description.\"\"\"\n    return f\"Review this code:\\n{code}\"\n</code></pre>"},{"location":"api/decorators/#requires_auth","title":"@requires_auth","text":"<p>Mark tool as requiring OAuth authentication.</p> <pre><code>@tool\n@requires_auth(scopes=[\"read\", \"write\"])\nasync def protected_tool(_external_access_token: str | None = None):\n    \"\"\"Protected tool description.\"\"\"\n    # Use token...\n</code></pre> <p>Parameters: - <code>scopes</code> (optional): Required OAuth scopes</p>"},{"location":"api/decorators/#next-steps","title":"Next Steps","text":"<ul> <li>Server API - ChukMCPServer class</li> <li>OAuth API - OAuth module</li> <li>Types - Type definitions</li> </ul>"},{"location":"api/oauth/","title":"OAuth API","text":"<p>API reference for OAuth components.</p>"},{"location":"api/oauth/#oauthmiddleware","title":"OAuthMiddleware","text":"<pre><code>from chuk_mcp_server.oauth import OAuthMiddleware\n\noauth = OAuthMiddleware(\n    mcp_server=mcp,\n    provider=provider,\n    oauth_server_url=\"http://localhost:8000\",\n    callback_path=\"/oauth/callback\",\n    scopes_supported=[\"read\", \"write\"],\n    service_documentation=\"https://docs.example.com\",\n    provider_name=\"My Service\"\n)\n</code></pre>"},{"location":"api/oauth/#baseoauthprovider","title":"BaseOAuthProvider","text":"<p>Base class for OAuth providers.</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider\n\nclass MyProvider(BaseOAuthProvider):\n    async def authorize(self, params):\n        ...\n\n    async def exchange_authorization_code(self, code, ...):\n        ...\n\n    async def exchange_refresh_token(self, refresh_token, ...):\n        ...\n\n    async def validate_access_token(self, token):\n        ...\n\n    async def register_client(self, metadata):\n        ...\n</code></pre>"},{"location":"api/oauth/#tokenstore","title":"TokenStore","text":"<pre><code>from chuk_mcp_server.oauth import TokenStore\n\nstore = TokenStore(sandbox_id=\"my-app\")\n</code></pre>"},{"location":"api/oauth/#next-steps","title":"Next Steps","text":"<ul> <li>OAuth Overview - Complete guide</li> <li>Custom Providers - Build providers</li> <li>API Reference - Type definitions</li> </ul>"},{"location":"api/server/","title":"ChukMCPServer API","text":"<p>Complete API reference for the ChukMCPServer class.</p>"},{"location":"api/server/#constructor","title":"Constructor","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"my-server\")\n</code></pre> <p>Parameters: - <code>name</code> (str): Server name</p>"},{"location":"api/server/#methods","title":"Methods","text":""},{"location":"api/server/#tool","title":"tool()","text":"<p>Register a tool decorator.</p> <pre><code>@mcp.tool\ndef my_tool():\n    ...\n</code></pre>"},{"location":"api/server/#resource","title":"resource()","text":"<p>Register a resource decorator.</p> <pre><code>@mcp.resource(\"uri://path\")\ndef my_resource():\n    ...\n</code></pre>"},{"location":"api/server/#prompt","title":"prompt()","text":"<p>Register a prompt decorator.</p> <pre><code>@mcp.prompt\ndef my_prompt():\n    ...\n</code></pre>"},{"location":"api/server/#run","title":"run()","text":"<p>Start the server.</p> <pre><code>mcp.run(\n    transport=\"http\",  # \"stdio\" or \"http\"\n    host=\"0.0.0.0\",\n    port=8000,\n    workers=4,\n    log_level=\"info\",\n    post_register_hook=setup_oauth\n)\n</code></pre>"},{"location":"api/server/#next-steps","title":"Next Steps","text":"<ul> <li>Decorators - Decorator API</li> <li>OAuth API - OAuth module</li> <li>Examples - Usage examples</li> </ul>"},{"location":"api/types/","title":"Types API","text":"<p>Type definitions and interfaces.</p>"},{"location":"api/types/#oauth-types","title":"OAuth Types","text":""},{"location":"api/types/#authorizationparams","title":"AuthorizationParams","text":"<pre><code>from chuk_mcp_server.oauth.models import AuthorizationParams\n\nparams = AuthorizationParams(\n    client_id=\"client-123\",\n    redirect_uri=\"http://localhost:8000/callback\",\n    response_type=\"code\",\n    state=\"state-123\",\n    scope=\"read write\",\n    code_challenge=\"challenge\",\n    code_challenge_method=\"S256\"\n)\n</code></pre>"},{"location":"api/types/#oauthtoken","title":"OAuthToken","text":"<pre><code>from chuk_mcp_server.oauth.models import OAuthToken\n\ntoken = OAuthToken(\n    access_token=\"token\",\n    token_type=\"Bearer\",\n    expires_in=3600,\n    refresh_token=\"refresh\",\n    scope=\"read write\"\n)\n</code></pre>"},{"location":"api/types/#oauthclientinfo","title":"OAuthClientInfo","text":"<pre><code>from chuk_mcp_server.oauth.models import OAuthClientInfo\n\nclient = OAuthClientInfo(\n    client_id=\"client-123\",\n    client_secret=\"secret\",\n    client_name=\"My Client\",\n    redirect_uris=[\"http://localhost:8000/callback\"]\n)\n</code></pre>"},{"location":"api/types/#next-steps","title":"Next Steps","text":"<ul> <li>OAuth API - OAuth classes</li> <li>Server API - Server class</li> <li>Decorators - Decorator API</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":"<p>Complete reference for all ChukMCPServer APIs, decorators, functions, and types.</p>"},{"location":"api-reference/#core-decorators","title":"Core Decorators","text":"Decorator Purpose Required Parameters Optional Parameters <code>@tool</code> Define a callable tool/function for Claude None <code>name</code>, <code>description</code> <code>@resource(uri)</code> Define a data resource Claude can read <code>uri</code> (e.g., <code>\"config://app\"</code>) <code>name</code>, <code>description</code>, <code>mime_type</code> <code>@prompt</code> Define a reusable prompt template None <code>name</code>, <code>description</code> <code>@requires_auth()</code> Mark a tool as requiring OAuth None <code>scopes</code> (list of strings)"},{"location":"api-reference/#examples","title":"Examples","text":"<p>Basic Tool: <pre><code>from chuk_mcp_server import tool\n\n@tool\ndef add_numbers(a: int, b: int) -&gt; int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n</code></pre></p> <p>Resource: <pre><code>from chuk_mcp_server import resource\n\n@resource(\"config://app\")\ndef get_config() -&gt; dict:\n    \"\"\"Application configuration.\"\"\"\n    return {\"version\": \"1.0\", \"mode\": \"production\"}\n</code></pre></p> <p>Prompt Template: <pre><code>from chuk_mcp_server import prompt\n\n@prompt\ndef code_review(code: str, language: str = \"python\") -&gt; str:\n    \"\"\"Review code for best practices.\"\"\"\n    return f\"Review this {language} code:\\\\n{code}\"\n</code></pre></p> <p>Authenticated Tool: <pre><code>from chuk_mcp_server import tool, requires_auth\n\n@tool\n@requires_auth(scopes=[\"email\", \"profile\"])\nasync def get_user_info() -&gt; dict:\n    \"\"\"Get authenticated user information.\"\"\"\n    # OAuth user ID is automatically available\n    return {\"authenticated\": True}\n</code></pre></p>"},{"location":"api-reference/#server-functions","title":"Server Functions","text":"Function Purpose Parameters Example <code>run()</code> Start the MCP server <code>transport</code> (\"stdio\"/\"http\"), <code>host</code>, <code>port</code>, <code>log_level</code> <code>run()</code> or <code>run(port=8000)</code> <code>ChukMCPServer()</code> Create server instance (class-based API) <code>name</code> (optional) <code>mcp = ChukMCPServer(\"my-server\")</code>"},{"location":"api-reference/#examples_1","title":"Examples","text":"<p>Simple STDIO Server: <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef hello(name: str = \"World\") -&gt; str:\n    return f\"Hello, {name}!\"\n\nrun()  # Starts STDIO server for Claude Desktop\n</code></pre></p> <p>HTTP Server: <pre><code>run(transport=\"http\", port=8000)  # HTTP server at http://localhost:8000\n</code></pre></p> <p>Class-Based API: <pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(name=\"my-custom-server\")\n\n@mcp.tool\ndef my_tool() -&gt; str:\n    return \"Hello from class-based API\"\n\nmcp.run()\n</code></pre></p>"},{"location":"api-reference/#context-management","title":"Context Management","text":"Function Purpose Returns Use Case <code>get_session_id()</code> Get current MCP session ID <code>str \\| None</code> Track requests per session <code>get_user_id()</code> Get current OAuth user ID <code>str \\| None</code> Check if user is authenticated <code>require_user_id()</code> Get user ID or raise error <code>str</code> (raises <code>PermissionError</code>) Enforce authentication <code>set_session_id(id)</code> Set session context None Testing, manual control <code>set_user_id(id)</code> Set user context None Testing, manual control <code>RequestContext()</code> Context manager for request context Context manager Testing, background tasks <p>See Context Management Guide for detailed examples.</p>"},{"location":"api-reference/#artifact-storage","title":"Artifact Storage","text":"Function Purpose Returns <code>get_artifact_store()</code> Get the current artifact store <code>ArtifactStore</code> <code>set_artifact_store(store)</code> Set artifact store for current context None <code>set_global_artifact_store(store)</code> Set global fallback store None <code>has_artifact_store()</code> Check if store is available <code>bool</code> <code>clear_artifact_store()</code> Clear store (useful for testing) None <code>create_blob_namespace(**kwargs)</code> Create blob namespace <code>NamespaceInfo</code> <code>create_workspace_namespace(name, **kwargs)</code> Create workspace namespace <code>NamespaceInfo</code> <code>write_blob(namespace_id, data, mime)</code> Write blob data None <code>read_blob(namespace_id)</code> Read blob data <code>bytes</code> <code>write_workspace_file(namespace_id, path, data)</code> Write file to workspace None <code>read_workspace_file(namespace_id, path)</code> Read file from workspace <code>bytes</code> <code>get_namespace_vfs(namespace_id)</code> Get VFS for workspace <code>AsyncVirtualFileSystem</code> <p>See Artifacts Guide for detailed examples.</p>"},{"location":"api-reference/#cloud-helpers","title":"Cloud Helpers","text":"Function Purpose Returns <code>is_cloud()</code> Check if running in any cloud environment <code>bool</code> <code>is_gcf()</code> Check if running in Google Cloud Functions <code>bool</code> <code>is_lambda()</code> Check if running in AWS Lambda <code>bool</code> <code>is_azure()</code> Check if running in Azure Functions <code>bool</code> <code>get_deployment_info()</code> Get detailed deployment information <code>dict</code> <code>get_cloud_handler()</code> Get cloud-specific handler Handler function"},{"location":"api-reference/#examples_2","title":"Examples","text":"<pre><code>from chuk_mcp_server import is_cloud, get_deployment_info\n\nif is_cloud():\n    info = get_deployment_info()\n    print(f\"Running in {info['provider']} - {info['service_type']}\")\n</code></pre>"},{"location":"api-reference/#type-hints","title":"Type Hints","text":"<p>ChukMCPServer automatically generates JSON schemas from Python type hints:</p> <pre><code>from typing import Literal\n\n@tool\ndef process_file(\n    filename: str,\n    mode: Literal[\"read\", \"write\", \"append\"] = \"read\",\n    encoding: str = \"utf-8\"\n) -&gt; dict:\n    \"\"\"Process a file with specified mode.\"\"\"\n    return {\n        \"filename\": filename,\n        \"mode\": mode,\n        \"encoding\": encoding\n    }\n</code></pre> <p>Supported types: - <code>str</code>, <code>int</code>, <code>float</code>, <code>bool</code> - <code>list</code>, <code>dict</code> - <code>Optional[T]</code>, <code>Union[T1, T2]</code> - <code>Literal[\"choice1\", \"choice2\"]</code> - Pydantic models - Custom dataclasses</p>"},{"location":"api-reference/#async-support","title":"Async Support","text":"<p>All decorators support both sync and async functions:</p> <pre><code>import httpx\n\n@tool\nasync def fetch_data(url: str) -&gt; dict:\n    \"\"\"Fetch data from URL.\"\"\"\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.json()\n</code></pre>"},{"location":"api-reference/#error-handling","title":"Error Handling","text":"<p>ChukMCPServer automatically converts Python exceptions to MCP error responses:</p> <pre><code>@tool\ndef divide(a: float, b: float) -&gt; float:\n    \"\"\"Divide two numbers.\"\"\"\n    if b == 0:\n        raise ValueError(\"Cannot divide by zero\")\n    return a / b\n</code></pre> <p>Claude will receive a proper error message if division by zero is attempted.</p>"},{"location":"api-reference/#configuration","title":"Configuration","text":"<p>See Configuration Guide for: - Environment variables - Logging configuration - Port and host settings - Performance tuning</p>"},{"location":"api-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>Getting Started - Quick start guides</li> <li>Guides - How-to guides and tutorials</li> <li>Deployment - Deployment guides</li> <li>OAuth Integration - OAuth 2.1 setup</li> <li>Transport Modes - STDIO vs HTTP</li> </ul>"},{"location":"concepts/context/","title":"Context Management","text":"<p>Track sessions and users across tool calls.</p>"},{"location":"concepts/context/#session-context","title":"Session Context","text":"<p>Get the current MCP session ID:</p> <pre><code>from chuk_mcp_server import tool, get_session_id\n\n@tool\ndef my_tool() -&gt; dict:\n    \"\"\"Tool with session context.\"\"\"\n    session = get_session_id()\n    return {\"session\": session}\n</code></pre>"},{"location":"concepts/context/#user-context","title":"User Context","text":"<p>Get the current OAuth user ID:</p> <pre><code>from chuk_mcp_server import tool, get_user_id\n\n@tool\ndef my_tool() -&gt; dict:\n    \"\"\"Tool with user context.\"\"\"\n    user = get_user_id()  # None if not authenticated\n    return {\"user\": user}\n</code></pre>"},{"location":"concepts/context/#require-authentication","title":"Require Authentication","text":"<pre><code>from chuk_mcp_server import tool, require_user_id\n\n@tool\ndef protected_tool() -&gt; dict:\n    \"\"\"Requires authentication.\"\"\"\n    user_id = require_user_id()  # Raises if not authenticated\n    return {\"user\": user_id}\n</code></pre>"},{"location":"concepts/context/#next-steps","title":"Next Steps","text":"<ul> <li>OAuth - Authentication</li> <li>Protected Tools - Auth tools</li> <li>Tools Guide - Building tools</li> </ul>"},{"location":"concepts/prompts/","title":"Prompts","text":"<p>Prompts are reusable templates that help Claude generate better responses.</p>"},{"location":"concepts/prompts/#what-is-a-prompt","title":"What is a Prompt?","text":"<p>A prompt template that Claude can use:</p> <pre><code>from chuk_mcp_server import prompt\n\n@prompt\ndef code_review(code: str, language: str) -&gt; str:\n    \"\"\"Generate a code review prompt.\"\"\"\n    return f\"\"\"\n    Review this {language} code:\n\n    ```{language}\n    {code}\n    ```\n\n    Focus on:\n    - Code quality\n    - Potential bugs\n    - Best practices\n    - Performance\n    \"\"\"\n</code></pre>"},{"location":"concepts/prompts/#when-to-use-prompts","title":"When to Use Prompts","text":"<p>Use prompts for: - Code reviews - Standardized review templates - Documentation - Generate docs from code - Analysis - Structured analysis tasks - Workflows - Multi-step processes</p>"},{"location":"concepts/prompts/#next-steps","title":"Next Steps","text":"<ul> <li>Tools - For actions</li> <li>Resources - For data</li> <li>Examples - Real examples</li> </ul>"},{"location":"concepts/resources/","title":"Resources","text":"<p>Resources provide read-only data that Claude can access.</p>"},{"location":"concepts/resources/#what-is-a-resource","title":"What is a Resource?","text":"<p>A resource exposes data or configuration:</p> <pre><code>from chuk_mcp_server import resource\n\n@resource(\"config://app\")\ndef get_config() -&gt; dict:\n    \"\"\"Application configuration.\"\"\"\n    return {\n        \"version\": \"1.0.0\",\n        \"environment\": \"production\"\n    }\n</code></pre>"},{"location":"concepts/resources/#resource-uris","title":"Resource URIs","text":"<p>Resources are identified by URIs:</p> <ul> <li><code>config://app</code> - Application config</li> <li><code>data://users</code> - User data</li> <li><code>file://README.md</code> - File content</li> </ul>"},{"location":"concepts/resources/#when-to-use-resources","title":"When to Use Resources","text":"<p>Use resources for: - Configuration - App settings - Static data - Lists, lookup tables - Documentation - Help text - Templates - Reusable content</p>"},{"location":"concepts/resources/#tools-vs-resources","title":"Tools vs Resources","text":"Feature Tools Resources Purpose Actions Data Read/Write Both Read-only Parameters Yes No URI No Yes"},{"location":"concepts/resources/#next-steps","title":"Next Steps","text":"<ul> <li>Tools - For actions</li> <li>Prompts - For templates</li> <li>Building Tools - Complete guide</li> </ul>"},{"location":"concepts/tools/","title":"Tools","text":"<p>Tools are Python functions that Claude can call to perform actions.</p>"},{"location":"concepts/tools/#what-is-a-tool","title":"What is a Tool?","text":"<p>A tool is any Python function decorated with <code>@tool</code>:</p> <pre><code>from chuk_mcp_server import tool\n\n@tool\ndef greet(name: str) -&gt; str:\n    \"\"\"Greet someone by name.\"\"\"\n    return f\"Hello, {name}!\"\n</code></pre>"},{"location":"concepts/tools/#tool-components","title":"Tool Components","text":"<ol> <li>@tool decorator - Registers the function</li> <li>Function name - Becomes the tool name</li> <li>Parameters - Define inputs</li> <li>Type hints - Automatic validation</li> <li>Docstring - Description for Claude</li> <li>Return value - Result sent to Claude</li> </ol>"},{"location":"concepts/tools/#when-to-use-tools","title":"When to Use Tools","text":"<p>Use tools for: - Actions - Things Claude can do (create, update, delete) - Queries - Fetching data from APIs or databases - Computations - Calculations or transformations - External integrations - Calling third-party services</p>"},{"location":"concepts/tools/#next-steps","title":"Next Steps","text":"<ul> <li>Building Tools - Complete guide</li> <li>Resources - For read-only data</li> <li>Prompts - For reusable templates</li> </ul>"},{"location":"concepts/transport/","title":"Transport Modes","text":"<p>ChukMCPServer supports two transport modes: STDIO and HTTP.</p>"},{"location":"concepts/transport/#stdio-transport","title":"STDIO Transport","text":"<p>Standard input/output transport for Claude Desktop:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\nrun()  # Default: STDIO\n</code></pre> <p>Use for: - Claude Desktop integration - Local development - Command-line tools</p>"},{"location":"concepts/transport/#http-transport","title":"HTTP Transport","text":"<p>HTTP server for web APIs and production:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\nrun(transport=\"http\", port=8000)\n</code></pre> <p>Use for: - Web applications - Production APIs - Testing with curl/browser - Cloud deployment</p>"},{"location":"concepts/transport/#comparison","title":"Comparison","text":"Feature STDIO HTTP Use Case Desktop Web/Cloud Performance N/A 36,000+ RPS Testing Pipes curl/browser Deployment Local Anywhere"},{"location":"concepts/transport/#next-steps","title":"Next Steps","text":"<ul> <li>Claude Desktop Setup - STDIO</li> <li>HTTP Mode - HTTP deployment</li> <li>Cloud Deployment - Production</li> </ul>"},{"location":"contributing/pull-requests/","title":"Pull Request Workflow","text":"<p>How to contribute code to ChukMCPServer.</p>"},{"location":"contributing/pull-requests/#before-you-start","title":"Before You Start","text":"<ol> <li>Check existing issues - Is there already an issue for this?</li> <li>Create an issue - Describe what you want to add/fix</li> <li>Get feedback - Discuss approach before coding</li> <li>Fork the repository - Work on your own fork</li> </ol>"},{"location":"contributing/pull-requests/#development-workflow","title":"Development Workflow","text":""},{"location":"contributing/pull-requests/#1-create-a-branch","title":"1. Create a Branch","text":"<pre><code># Update main\ngit checkout main\ngit pull origin main\n\n# Create feature branch\ngit checkout -b feature/your-feature-name\n</code></pre> <p>Branch naming: - <code>feature/oauth-google-drive</code> - New features - <code>fix/sse-connection-drops</code> - Bug fixes - <code>docs/update-quickstart</code> - Documentation - <code>test/oauth-providers</code> - Tests only - <code>refactor/type-system</code> - Refactoring</p>"},{"location":"contributing/pull-requests/#2-make-changes","title":"2. Make Changes","text":"<pre><code># Make your changes\nvim src/chuk_mcp_server/your_file.py\n\n# Run quality checks frequently\nmake check\n\n# Format code\nmake format\n</code></pre>"},{"location":"contributing/pull-requests/#3-write-tests","title":"3. Write Tests","text":"<p>Every change needs tests:</p> <pre><code># tests/test_your_feature.py\ndef test_your_feature():\n    \"\"\"Test your new feature.\"\"\"\n    # Arrange\n    mcp = ChukMCPServer(name=\"test\")\n\n    # Act\n    result = your_feature()\n\n    # Assert\n    assert result == expected\n</code></pre> <p>Ensure coverage:</p> <pre><code>make test-cov\n# Target: 90%+ for new code\n</code></pre>"},{"location":"contributing/pull-requests/#4-update-documentation","title":"4. Update Documentation","text":"<p>If needed: - Update README - Add/update docs pages - Update CHANGELOG.md - Add docstrings</p>"},{"location":"contributing/pull-requests/#5-commit-changes","title":"5. Commit Changes","text":"<p>Follow conventional commits:</p> <pre><code>git add .\ngit commit -m \"feat(oauth): Add Google Drive provider\n\nImplements OAuth 2.1 with PKCE for Google Drive integration.\n\n- Automatic token refresh\n- Secure token storage\n- Drive API scopes\n\nFixes #42\"\n</code></pre>"},{"location":"contributing/pull-requests/#6-push-to-fork","title":"6. Push to Fork","text":"<pre><code>git push origin feature/your-feature-name\n</code></pre>"},{"location":"contributing/pull-requests/#7-create-pull-request","title":"7. Create Pull Request","text":"<p>On GitHub: 1. Click \"New Pull Request\" 2. Select your fork and branch 3. Fill in PR template:</p> <pre><code>## Description\nBrief description of changes\n\n## Type of Change\n- [ ] Bug fix\n- [ ] New feature\n- [ ] Breaking change\n- [ ] Documentation update\n\n## Testing\n- [ ] Tests pass locally\n- [ ] Added new tests\n- [ ] Coverage maintained/improved\n\n## Checklist\n- [ ] Code follows style guide\n- [ ] Self-review completed\n- [ ] Documentation updated\n- [ ] No breaking changes (or documented)\n\n## Related Issues\nFixes #42\n</code></pre>"},{"location":"contributing/pull-requests/#pr-requirements","title":"PR Requirements","text":"<p>Your PR must:</p> <p>\u2705 Pass all checks <pre><code>make check  # Must succeed\n</code></pre></p> <p>\u2705 Maintain coverage - Overall: 80% minimum - New code: 90% minimum</p> <p>\u2705 Follow style guide - Type hints required - Docstrings required - ruff formatting</p> <p>\u2705 Include tests - Unit tests for all functions - Integration tests for features</p> <p>\u2705 Update docs - If API changes - If behavior changes</p>"},{"location":"contributing/pull-requests/#review-process","title":"Review Process","text":"<ol> <li>Automated checks run first</li> <li>Linting (ruff)</li> <li>Type checking (mypy)</li> <li>Tests (pytest)</li> <li> <p>Coverage report</p> </li> <li> <p>Code review by maintainers</p> </li> <li>Design feedback</li> <li>Code quality</li> <li>Test coverage</li> <li> <p>Documentation</p> </li> <li> <p>Address feedback</p> </li> <li>Make requested changes</li> <li>Push updates</li> <li> <p>Re-request review</p> </li> <li> <p>Merge</p> </li> <li>Approved by maintainer</li> <li>All checks passing</li> <li>Squash and merge</li> </ol>"},{"location":"contributing/pull-requests/#after-merge","title":"After Merge","text":"<p>Your PR: - Appears in CHANGELOG.md - Included in next release - You're added to contributors!</p>"},{"location":"contributing/pull-requests/#common-issues","title":"Common Issues","text":""},{"location":"contributing/pull-requests/#tests-failing","title":"Tests Failing","text":"<pre><code># Run locally\nmake test\n\n# Check specific test\npytest tests/test_file.py::test_name -v\n\n# Debug\npytest --pdb\n</code></pre>"},{"location":"contributing/pull-requests/#type-errors","title":"Type Errors","text":"<pre><code># Run mypy\nmake typecheck\n\n# Fix common issues\n# - Add type hints\n# - Import from typing\n# - Use | instead of Union\n</code></pre>"},{"location":"contributing/pull-requests/#coverage-too-low","title":"Coverage Too Low","text":"<pre><code># Check coverage\nmake test-cov\n\n# View report\nopen htmlcov/index.html\n\n# Add tests for uncovered lines\n</code></pre>"},{"location":"contributing/pull-requests/#merge-conflicts","title":"Merge Conflicts","text":"<pre><code># Update your branch\ngit checkout main\ngit pull origin main\ngit checkout feature/your-branch\ngit rebase main\n\n# Resolve conflicts\n# Edit conflicted files\ngit add .\ngit rebase --continue\n\n# Force push\ngit push --force-with-lease\n</code></pre>"},{"location":"contributing/pull-requests/#getting-help","title":"Getting Help","text":"<ul> <li>Documentation: Read the docs</li> <li>Issues: Search existing issues</li> <li>Discussions: Ask in GitHub Discussions</li> <li>Discord: Join our Discord server</li> </ul>"},{"location":"contributing/pull-requests/#code-of-conduct","title":"Code of Conduct","text":"<p>Be respectful and constructive: - Assume good intentions - Provide helpful feedback - Welcome newcomers - Focus on the code, not the person</p>"},{"location":"contributing/pull-requests/#recognition","title":"Recognition","text":"<p>Contributors are recognized: - CONTRIBUTORS.md - Release notes - Project README</p> <p>Thank you for contributing! \ud83c\udf89</p>"},{"location":"contributing/pull-requests/#next-steps","title":"Next Steps","text":"<ul> <li>Setup - Development environment</li> <li>Style Guide - Code standards</li> <li>Testing - Writing tests</li> </ul>"},{"location":"contributing/setup/","title":"Development Setup","text":"<p>Get your development environment ready for contributing to ChukMCPServer.</p>"},{"location":"contributing/setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11 or higher</li> <li>Git</li> <li>uv (recommended) or pip</li> </ul>"},{"location":"contributing/setup/#install-uv","title":"Install uv","text":"<p>ChukMCPServer uses uv for ultra-fast dependency management:</p> <pre><code># macOS/Linux\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Windows\npowershell -c \"irm https://astral.sh/uv/install.ps1 | iex\"\n\n# With pip\npip install uv\n</code></pre>"},{"location":"contributing/setup/#clone-repository","title":"Clone Repository","text":"<pre><code>git clone https://github.com/chrishayuk/chuk-mcp-server.git\ncd chuk-mcp-server\n</code></pre>"},{"location":"contributing/setup/#install-dependencies","title":"Install Dependencies","text":"<pre><code># Sync all dependencies (including dev tools)\nuv sync --dev\n\n# Or with pip\npip install -e \".[dev]\"\n</code></pre> <p>This installs: - Runtime dependencies - Development tools (ruff, mypy, pytest) - Testing frameworks - Documentation tools</p>"},{"location":"contributing/setup/#verify-installation","title":"Verify Installation","text":"<pre><code># Run tests\nmake test\n# or\nuv run pytest\n\n# Check linting\nmake lint\n# or\nuv run ruff check .\n\n# Check types\nmake typecheck\n# or\nuv run mypy src\n</code></pre>"},{"location":"contributing/setup/#install-pre-commit-hooks","title":"Install Pre-commit Hooks","text":"<p>Automatically run checks before commits:</p> <pre><code>pre-commit install\n</code></pre> <p>Now quality checks run automatically when you commit.</p>"},{"location":"contributing/setup/#ide-setup","title":"IDE Setup","text":""},{"location":"contributing/setup/#vs-code","title":"VS Code","text":"<p>Install recommended extensions: - Python - Pylance - Ruff - MyPy Type Checker</p> <p>Add to <code>.vscode/settings.json</code>:</p> <pre><code>{\n  \"python.linting.enabled\": true,\n  \"python.linting.ruffEnabled\": true,\n  \"python.formatting.provider\": \"none\",\n  \"[python]\": {\n    \"editor.defaultFormatter\": \"charliermarsh.ruff\",\n    \"editor.formatOnSave\": true,\n    \"editor.codeActionsOnSave\": {\n      \"source.organizeImports\": true\n    }\n  },\n  \"python.testing.pytestEnabled\": true,\n  \"python.testing.unittestEnabled\": false\n}\n</code></pre>"},{"location":"contributing/setup/#pycharm","title":"PyCharm","text":"<ol> <li>Open Settings \u2192 Project \u2192 Python Interpreter</li> <li>Add interpreter \u2192 System Interpreter</li> <li>Select Python from your virtual environment</li> <li>Enable ruff: Settings \u2192 Tools \u2192 External Tools</li> <li>Enable pytest: Settings \u2192 Tools \u2192 Python Integrated Tools</li> </ol>"},{"location":"contributing/setup/#project-structure","title":"Project Structure","text":"<pre><code>chuk-mcp-server/\n\u251c\u2500\u2500 src/chuk_mcp_server/    # Main package\n\u2502   \u251c\u2500\u2500 __init__.py          # Public API\n\u2502   \u251c\u2500\u2500 core.py              # Core server\n\u2502   \u251c\u2500\u2500 types/               # Type system\n\u2502   \u251c\u2500\u2500 transport/           # HTTP/STDIO\n\u2502   \u251c\u2500\u2500 oauth/               # OAuth support\n\u2502   \u2514\u2500\u2500 config/              # Smart config\n\u251c\u2500\u2500 tests/                   # Test suite\n\u2502   \u251c\u2500\u2500 conftest.py          # Pytest fixtures\n\u2502   \u251c\u2500\u2500 test_core.py         # Core tests\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 examples/                # Example servers\n\u251c\u2500\u2500 benchmarks/              # Performance tests\n\u251c\u2500\u2500 docs/                    # Documentation\n\u251c\u2500\u2500 pyproject.toml           # Project config\n\u251c\u2500\u2500 uv.lock                  # Dependency lock\n\u2514\u2500\u2500 Makefile                 # Convenience commands\n</code></pre>"},{"location":"contributing/setup/#next-steps","title":"Next Steps","text":"<ul> <li>Style Guide - Code standards</li> <li>Testing - Writing tests</li> <li>Pull Requests - Contribution workflow</li> </ul>"},{"location":"contributing/style/","title":"Style Guide","text":"<p>Code standards and conventions for ChukMCPServer.</p>"},{"location":"contributing/style/#code-quality-tools","title":"Code Quality Tools","text":"<p>All code must pass:</p> <pre><code>make check  # Runs all checks\n</code></pre> <p>This runs: 1. ruff - Linting and formatting 2. mypy - Type checking 3. pytest - Tests with 80%+ coverage</p>"},{"location":"contributing/style/#python-style","title":"Python Style","text":""},{"location":"contributing/style/#type-hints","title":"Type Hints","text":"<p>All code must have complete type annotations:</p> <pre><code># \u2705 Good\ndef add(a: int, b: int) -&gt; int:\n    return a + b\n\nasync def fetch(url: str) -&gt; dict[str, Any]:\n    ...\n\n# \u274c Bad\ndef add(a, b):\n    return a + b\n</code></pre>"},{"location":"contributing/style/#formatting","title":"Formatting","text":"<p>Use ruff format (black-compatible):</p> <pre><code>make format\n# or\nuv run ruff format .\n</code></pre> <p>Standards: - Line length: 88 characters - Indent: 4 spaces - Quotes: Double quotes preferred - Trailing commas: Yes for multi-line</p>"},{"location":"contributing/style/#imports","title":"Imports","text":"<p>Organized automatically by ruff:</p> <pre><code># Standard library\nimport os\nimport sys\nfrom typing import Any, Optional\n\n# Third-party\nimport httpx\nfrom starlette.responses import JSONResponse\n\n# Local\nfrom chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.types import ToolHandler\n</code></pre>"},{"location":"contributing/style/#naming-conventions","title":"Naming Conventions","text":"<pre><code># Functions and variables: snake_case\ndef process_request():\n    user_count = 0\n\n# Classes: PascalCase\nclass OAuthProvider:\n    pass\n\n# Constants: UPPER_SNAKE_CASE\nMAX_CONNECTIONS = 1000\n\n# Private: leading underscore\ndef _internal_helper():\n    pass\n\nclass MyClass:\n    def __init__(self):\n        self._private_attr = None\n</code></pre>"},{"location":"contributing/style/#documentation","title":"Documentation","text":""},{"location":"contributing/style/#docstrings","title":"Docstrings","text":"<p>Use Google style:</p> <pre><code>def complex_function(param1: str, param2: int) -&gt; dict[str, Any]:\n    \"\"\"One-line summary.\n\n    Longer description if needed. Can span multiple lines\n    and include examples.\n\n    Args:\n        param1: Description of param1\n        param2: Description of param2\n\n    Returns:\n        Dictionary containing results with keys:\n        - \"status\": Operation status\n        - \"data\": Result data\n\n    Raises:\n        ValueError: If param2 is negative\n        RuntimeError: If operation fails\n\n    Example:\n        &gt;&gt;&gt; result = complex_function(\"test\", 42)\n        &gt;&gt;&gt; result[\"status\"]\n        \"success\"\n    \"\"\"\n    if param2 &lt; 0:\n        raise ValueError(\"param2 must be non-negative\")\n\n    return {\"status\": \"success\", \"data\": param1 * param2}\n</code></pre>"},{"location":"contributing/style/#comments","title":"Comments","text":"<p>Write clear, helpful comments:</p> <pre><code># \u2705 Good: Explains why\n# Use orjson for 2-3x faster serialization\nimport orjson\n\n# \u2705 Good: Complex logic\n# Binary search requires sorted input; sort once and cache\nsorted_items = sorted(items)\n\n# \u274c Bad: States the obvious\n# Increment counter\ncounter += 1\n</code></pre>"},{"location":"contributing/style/#testing-standards","title":"Testing Standards","text":""},{"location":"contributing/style/#test-organization","title":"Test Organization","text":"<pre><code># tests/test_feature.py\nimport pytest\nfrom chuk_mcp_server import ChukMCPServer\n\nclass TestFeature:\n    \"\"\"Test suite for feature.\"\"\"\n\n    def test_basic_case(self):\n        \"\"\"Test basic functionality.\"\"\"\n        assert True\n\n    def test_edge_case(self):\n        \"\"\"Test edge cases.\"\"\"\n        assert True\n\n    @pytest.mark.asyncio\n    async def test_async_case(self):\n        \"\"\"Test async functionality.\"\"\"\n        assert True\n</code></pre>"},{"location":"contributing/style/#test-naming","title":"Test Naming","text":"<pre><code># Pattern: test_&lt;what&gt;_&lt;condition&gt;_&lt;expected&gt;\n\ndef test_add_positive_numbers_returns_sum():\n    assert add(2, 3) == 5\n\ndef test_add_negative_numbers_returns_sum():\n    assert add(-2, -3) == -5\n\ndef test_divide_by_zero_raises_error():\n    with pytest.raises(ZeroDivisionError):\n        divide(1, 0)\n</code></pre>"},{"location":"contributing/style/#coverage-requirements","title":"Coverage Requirements","text":"<ul> <li>Minimum 80% overall coverage</li> <li>New code should have 90%+ coverage</li> <li>Critical paths must be 100% covered</li> </ul> <pre><code># Check coverage\nmake test-cov\n\n# View HTML report\nopen htmlcov/index.html\n</code></pre>"},{"location":"contributing/style/#git-conventions","title":"Git Conventions","text":""},{"location":"contributing/style/#commit-messages","title":"Commit Messages","text":"<p>Follow conventional commits:</p> <pre><code>type(scope): Short description\n\nLonger description if needed.\n\n- Bullet points for details\n- Multiple changes listed\n\nFixes #123\n</code></pre> <p>Types: - <code>feat</code>: New feature - <code>fix</code>: Bug fix - <code>docs</code>: Documentation - <code>test</code>: Tests - <code>refactor</code>: Code restructuring - <code>perf</code>: Performance improvement - <code>chore</code>: Maintenance</p> <p>Examples:</p> <pre><code>feat(oauth): Add Google Drive OAuth provider\n\nImplements OAuth 2.1 with PKCE for Google Drive integration.\n\n- Automatic token refresh\n- Secure token storage\n- Drive API scopes\n\nFixes #42\n</code></pre> <pre><code>fix(transport): Handle SSE connection drops\n\nGracefully reconnect when SSE connection is interrupted.\n\nFixes #56\n</code></pre>"},{"location":"contributing/style/#branch-names","title":"Branch Names","text":"<pre><code>feature/oauth-google-drive\nfix/sse-connection-drops\ndocs/update-quickstart\ntest/oauth-providers\nrefactor/type-system\n</code></pre>"},{"location":"contributing/style/#error-handling","title":"Error Handling","text":""},{"location":"contributing/style/#explicit-is-better","title":"Explicit is Better","text":"<pre><code># \u2705 Good: Specific exceptions\ndef process_file(path: str) -&gt; dict:\n    if not os.path.exists(path):\n        raise FileNotFoundError(f\"File not found: {path}\")\n\n    if not path.endswith('.json'):\n        raise ValueError(f\"Expected JSON file, got: {path}\")\n\n    try:\n        with open(path) as f:\n            return json.load(f)\n    except json.JSONDecodeError as e:\n        raise ValueError(f\"Invalid JSON in {path}: {e}\")\n\n# \u274c Bad: Catch-all\ndef process_file(path: str) -&gt; dict:\n    try:\n        with open(path) as f:\n            return json.load(f)\n    except Exception:\n        return {}\n</code></pre>"},{"location":"contributing/style/#performance","title":"Performance","text":""},{"location":"contributing/style/#async-first","title":"Async First","text":"<pre><code># \u2705 Good: Async I/O\nasync def fetch_data(url: str) -&gt; dict:\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.json()\n\n# \u274c Bad: Blocking I/O\ndef fetch_data(url: str) -&gt; dict:\n    import requests\n    return requests.get(url).json()\n</code></pre>"},{"location":"contributing/style/#type-annotations","title":"Type Annotations","text":"<p>Help mypy optimize:</p> <pre><code># \u2705 Good: Specific types\ndef process(items: list[str]) -&gt; dict[str, int]:\n    return {item: len(item) for item in items}\n\n# \u274c Bad: Generic types\ndef process(items: list) -&gt; dict:\n    return {item: len(item) for item in items}\n</code></pre>"},{"location":"contributing/style/#next-steps","title":"Next Steps","text":"<ul> <li>Testing - Testing guide</li> <li>Pull Requests - Contributing workflow</li> <li>Setup - Development setup</li> </ul>"},{"location":"contributing/testing/","title":"Testing Guide","text":"<p>How to write and run tests for ChukMCPServer.</p>"},{"location":"contributing/testing/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\nmake test\n# or\nuv run pytest\n\n# Run with coverage\nmake test-cov\n# or\nuv run pytest --cov=src --cov-report=html --cov-report=term\n\n# Run specific test file\npytest tests/test_core.py -v\n\n# Run specific test\npytest tests/test_core.py::test_function_name -v\n\n# Run tests matching pattern\npytest -k \"oauth\" -v\n\n# Run with debugging\npytest --pdb\n</code></pre>"},{"location":"contributing/testing/#test-structure","title":"Test Structure","text":""},{"location":"contributing/testing/#basic-test","title":"Basic Test","text":"<pre><code># tests/test_calculator.py\nfrom chuk_mcp_server import ChukMCPServer\n\ndef test_add_tool():\n    \"\"\"Test that add tool works correctly.\"\"\"\n    mcp = ChukMCPServer(name=\"test-server\")\n\n    @mcp.tool\n    def add(a: int, b: int) -&gt; int:\n        return a + b\n\n    # Verify tool registered\n    assert \"add\" in mcp._tool_handlers\n\n    # Test execution\n    handler = mcp._tool_handlers[\"add\"]\n    result = handler(a=2, b=3)\n    assert result == 5\n</code></pre>"},{"location":"contributing/testing/#async-tests","title":"Async Tests","text":"<pre><code>import pytest\n\nclass TestAsyncTools:\n    \"\"\"Test async tool functionality.\"\"\"\n\n    @pytest.mark.asyncio\n    async def test_async_tool(self):\n        \"\"\"Test async tool execution.\"\"\"\n        mcp = ChukMCPServer(name=\"test-server\")\n\n        @mcp.tool\n        async def async_add(a: int, b: int) -&gt; int:\n            return a + b\n\n        handler = mcp._tool_handlers[\"async_add\"]\n        result = await handler(a=2, b=3)\n        assert result == 5\n</code></pre>"},{"location":"contributing/testing/#fixtures","title":"Fixtures","text":""},{"location":"contributing/testing/#common-fixtures","title":"Common Fixtures","text":"<pre><code># tests/conftest.py\nimport pytest\nfrom chuk_mcp_server import ChukMCPServer\n\n@pytest.fixture\ndef mcp_server():\n    \"\"\"Create a test MCP server.\"\"\"\n    return ChukMCPServer(name=\"test-server\")\n\n@pytest.fixture\nasync def async_client():\n    \"\"\"Create async HTTP client.\"\"\"\n    import httpx\n    async with httpx.AsyncClient() as client:\n        yield client\n</code></pre>"},{"location":"contributing/testing/#using-fixtures","title":"Using Fixtures","text":"<pre><code>def test_with_fixture(mcp_server):\n    \"\"\"Test using server fixture.\"\"\"\n    @mcp_server.tool\n    def hello():\n        return \"world\"\n\n    assert \"hello\" in mcp_server._tool_handlers\n</code></pre>"},{"location":"contributing/testing/#mocking","title":"Mocking","text":""},{"location":"contributing/testing/#mock-external-apis","title":"Mock External APIs","text":"<pre><code>from unittest.mock import patch, AsyncMock\nimport pytest\n\nclass TestExternalAPI:\n    @pytest.mark.asyncio\n    @patch('httpx.AsyncClient.get')\n    async def test_fetch_data(self, mock_get):\n        \"\"\"Test API call with mock.\"\"\"\n        # Setup mock\n        mock_response = AsyncMock()\n        mock_response.json.return_value = {\"temp\": 72}\n        mock_get.return_value = mock_response\n\n        # Test\n        from your_module import fetch_weather\n        result = await fetch_weather(\"NYC\")\n\n        # Verify\n        assert result[\"temp\"] == 72\n        mock_get.assert_called_once()\n</code></pre>"},{"location":"contributing/testing/#mock-environment-variables","title":"Mock Environment Variables","text":"<pre><code>import os\nfrom unittest.mock import patch\n\ndef test_env_var():\n    \"\"\"Test environment variable handling.\"\"\"\n    with patch.dict(os.environ, {\"API_KEY\": \"test-key\"}):\n        from your_module import get_api_key\n        assert get_api_key() == \"test-key\"\n</code></pre>"},{"location":"contributing/testing/#parametrized-tests","title":"Parametrized Tests","text":"<p>Test multiple inputs:</p> <pre><code>import pytest\n\n@pytest.mark.parametrize(\"a,b,expected\", [\n    (2, 3, 5),\n    (-1, 1, 0),\n    (0, 0, 0),\n    (100, -50, 50),\n])\ndef test_add_multiple(a, b, expected):\n    \"\"\"Test add with various inputs.\"\"\"\n    from calculator import add\n    assert add(a, b) == expected\n</code></pre>"},{"location":"contributing/testing/#exception-testing","title":"Exception Testing","text":"<pre><code>import pytest\n\ndef test_divide_by_zero():\n    \"\"\"Test that divide by zero raises error.\"\"\"\n    from calculator import divide\n\n    with pytest.raises(ZeroDivisionError):\n        divide(1, 0)\n\ndef test_invalid_input():\n    \"\"\"Test invalid input handling.\"\"\"\n    from calculator import process\n\n    with pytest.raises(ValueError, match=\"Expected positive number\"):\n        process(-1)\n</code></pre>"},{"location":"contributing/testing/#integration-tests","title":"Integration Tests","text":"<p>Test full server:</p> <pre><code>import pytest\nfrom httpx import AsyncClient\nfrom chuk_mcp_server import ChukMCPServer\n\n@pytest.mark.asyncio\nasync def test_full_server():\n    \"\"\"Test complete MCP server.\"\"\"\n    mcp = ChukMCPServer(name=\"test-server\")\n\n    @mcp.tool\n    def add(a: int, b: int) -&gt; int:\n        return a + b\n\n    # Start server in test mode\n    async with AsyncClient(app=mcp.app, base_url=\"http://test\") as client:\n        # Test tool listing\n        response = await client.post(\n            \"/mcp\",\n            json={\n                \"jsonrpc\": \"2.0\",\n                \"id\": 1,\n                \"method\": \"tools/list\"\n            }\n        )\n\n        assert response.status_code == 200\n        data = response.json()\n        assert any(t[\"name\"] == \"add\" for t in data[\"result\"][\"tools\"])\n</code></pre>"},{"location":"contributing/testing/#coverage","title":"Coverage","text":""},{"location":"contributing/testing/#check-coverage","title":"Check Coverage","text":"<pre><code># Generate coverage report\npytest --cov=src --cov-report=html\n\n# View in browser\nopen htmlcov/index.html\n</code></pre>"},{"location":"contributing/testing/#coverage-requirements","title":"Coverage Requirements","text":"<ul> <li>Overall: 80% minimum</li> <li>New features: 90% minimum</li> <li>Critical paths: 100%</li> </ul>"},{"location":"contributing/testing/#exclude-from-coverage","title":"Exclude from Coverage","text":"<pre><code># tests/conftest.py\ndef some_helper():  # pragma: no cover\n    \"\"\"Helper only for manual testing.\"\"\"\n    pass\n</code></pre>"},{"location":"contributing/testing/#test-organization","title":"Test Organization","text":"<pre><code>tests/\n\u251c\u2500\u2500 conftest.py              # Shared fixtures\n\u251c\u2500\u2500 test_core.py             # Core functionality\n\u251c\u2500\u2500 test_types.py            # Type system\n\u251c\u2500\u2500 transport/\n\u2502   \u251c\u2500\u2500 test_http.py         # HTTP transport\n\u2502   \u2514\u2500\u2500 test_stdio.py        # STDIO transport\n\u251c\u2500\u2500 oauth/\n\u2502   \u251c\u2500\u2500 test_middleware.py   # OAuth middleware\n\u2502   \u251c\u2500\u2500 test_helpers.py      # OAuth helpers\n\u2502   \u2514\u2500\u2500 test_providers.py    # OAuth providers\n\u2514\u2500\u2500 integration/\n    \u2514\u2500\u2500 test_full_server.py  # Integration tests\n</code></pre>"},{"location":"contributing/testing/#performance-testing","title":"Performance Testing","text":"<pre><code>import time\nimport pytest\n\ndef test_performance():\n    \"\"\"Test that operation completes quickly.\"\"\"\n    start = time.perf_counter()\n\n    # Operation\n    result = expensive_operation()\n\n    duration = time.perf_counter() - start\n    assert duration &lt; 0.1  # Must complete in 100ms\n</code></pre>"},{"location":"contributing/testing/#benchmarking","title":"Benchmarking","text":"<pre><code># Run benchmarks\npython benchmarks/ultra_minimal_mcp_performance_test.py\n\n# Custom benchmark\npython benchmarks/quick_benchmark.py --duration 30\n</code></pre>"},{"location":"contributing/testing/#continuous-integration","title":"Continuous Integration","text":"<p>Tests run automatically on: - Every push - Every pull request - Main branch merges</p> <p>See <code>.github/workflows/test.yml</code></p>"},{"location":"contributing/testing/#next-steps","title":"Next Steps","text":"<ul> <li>Style Guide - Code standards</li> <li>Pull Requests - Contributing workflow</li> <li>Setup - Development setup</li> </ul>"},{"location":"deployment/cloud/","title":"Cloud Deployment","text":"<p>Deploy to AWS, GCP, Azure, or edge platforms.</p>"},{"location":"deployment/cloud/#auto-detection","title":"Auto-Detection","text":"<p>ChukMCPServer automatically detects cloud platforms:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\nrun()  # Automatically optimizes for detected platform\n</code></pre>"},{"location":"deployment/cloud/#google-cloud-functions","title":"Google Cloud Functions","text":"<pre><code># main.py\nfrom chuk_mcp_server import tool\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\n# Automatically exports 'handler' for GCF\n</code></pre> <p>Deploy: <pre><code>gcloud functions deploy my-mcp \\\n  --runtime python311 \\\n  --trigger-http \\\n  --entry-point handler\n</code></pre></p>"},{"location":"deployment/cloud/#aws-lambda","title":"AWS Lambda","text":"<pre><code># Automatic Lambda handler export\nfrom chuk_mcp_server import tool, run\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\nrun()\n</code></pre>"},{"location":"deployment/cloud/#vercel","title":"Vercel","text":"<pre><code># api/index.py\nfrom chuk_mcp_server import tool\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\n# Auto-detected and configured\n</code></pre>"},{"location":"deployment/cloud/#next-steps","title":"Next Steps","text":"<ul> <li>HTTP Mode - Configuration</li> <li>Docker - Containerization</li> <li>Production - Best practices</li> </ul>"},{"location":"deployment/docker/","title":"Docker Deployment","text":"<p>Deploy your MCP server with Docker.</p>"},{"location":"deployment/docker/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM python:3.11-slim\n\nWORKDIR /app\n\n# Install uv\nRUN pip install uv\n\n# Copy project files\nCOPY pyproject.toml .\nCOPY src/ src/\n\n# Install dependencies\nRUN uv pip install --system .\n\n# Run server\nCMD [\"python\", \"-m\", \"my_server\"]\n</code></pre>"},{"location":"deployment/docker/#docker-compose","title":"Docker Compose","text":"<pre><code>version: '3.8'\n\nservices:\n  mcp-server:\n    build: .\n    ports:\n      - \"8000:8000\"\n    environment:\n      - MCP_LOG_LEVEL=info\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n</code></pre>"},{"location":"deployment/docker/#build-and-run","title":"Build and Run","text":"<pre><code># Build image\ndocker build -t my-mcp-server .\n\n# Run container\ndocker run -p 8000:8000 my-mcp-server\n\n# With Docker Compose\ndocker-compose up\n</code></pre>"},{"location":"deployment/docker/#next-steps","title":"Next Steps","text":"<ul> <li>HTTP Mode - HTTP configuration</li> <li>Cloud Deployment - Cloud platforms</li> <li>Production Guide - Best practices</li> </ul>"},{"location":"deployment/environment/","title":"Environment Variables","text":"<p>Configure ChukMCPServer with environment variables.</p>"},{"location":"deployment/environment/#server-configuration","title":"Server Configuration","text":"<pre><code># Server settings\nexport MCP_HOST=0.0.0.0\nexport MCP_PORT=8000\nexport MCP_LOG_LEVEL=info\nexport MCP_WORKERS=4\n</code></pre>"},{"location":"deployment/environment/#oauth-configuration","title":"OAuth Configuration","text":"<pre><code># Session storage\nexport SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379/0\n\n# Token TTLs\nexport OAUTH_AUTH_CODE_TTL=600\nexport OAUTH_ACCESS_TOKEN_TTL=900\nexport OAUTH_REFRESH_TOKEN_TTL=86400\nexport OAUTH_EXTERNAL_TOKEN_TTL=5184000\n</code></pre>"},{"location":"deployment/environment/#google-drive-oauth","title":"Google Drive OAuth","text":"<pre><code>export GOOGLE_CLIENT_ID=your-client-id\nexport GOOGLE_CLIENT_SECRET=your-client-secret\nexport GOOGLE_REDIRECT_URI=http://localhost:8000/oauth/callback\nexport OAUTH_SERVER_URL=http://localhost:8000\n</code></pre>"},{"location":"deployment/environment/#next-steps","title":"Next Steps","text":"<ul> <li>Production Guide - Best practices</li> <li>OAuth Overview - Authentication</li> <li>HTTP Mode - HTTP configuration</li> </ul>"},{"location":"deployment/http-mode/","title":"HTTP Mode","text":"<p>Deploy your MCP server as an HTTP API for web applications, production services, or testing.</p>"},{"location":"deployment/http-mode/#quick-start","title":"Quick Start","text":"<pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef greet(name: str) -&gt; str:\n    \"\"\"Greet someone.\"\"\"\n    return f\"Hello, {name}!\"\n\n# Run in HTTP mode\nrun(transport=\"http\", port=8000)\n</code></pre> <p>Access at <code>http://localhost:8000</code></p>"},{"location":"deployment/http-mode/#http-vs-stdio","title":"HTTP vs STDIO","text":"Feature STDIO HTTP Use Case Claude Desktop Web APIs, Production Transport stdin/stdout HTTP/HTTPS Performance N/A (local) 36,000+ RPS Testing Pipe commands curl, browser Deployment Desktop only Cloud, Docker, etc."},{"location":"deployment/http-mode/#configuration","title":"Configuration","text":""},{"location":"deployment/http-mode/#basic-server","title":"Basic Server","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(\"my-api\")\n\n@mcp.tool\ndef my_tool(param: str) -&gt; dict:\n    return {\"result\": param}\n\nmcp.run(host=\"0.0.0.0\", port=8000)\n</code></pre>"},{"location":"deployment/http-mode/#production-settings","title":"Production Settings","text":"<pre><code>mcp.run(\n    transport=\"http\",\n    host=\"0.0.0.0\",      # Listen on all interfaces\n    port=8000,\n    workers=4,           # Number of worker processes\n    log_level=\"info\"     # Logging level\n)\n</code></pre>"},{"location":"deployment/http-mode/#environment-variables","title":"Environment Variables","text":"<pre><code>export MCP_HOST=0.0.0.0\nexport MCP_PORT=8000\nexport MCP_LOG_LEVEL=info\nexport MCP_WORKERS=4\n</code></pre>"},{"location":"deployment/http-mode/#endpoints","title":"Endpoints","text":"<p>When running in HTTP mode, these endpoints are available:</p>"},{"location":"deployment/http-mode/#health-check","title":"Health Check","text":"<pre><code>curl http://localhost:8000/health\n# {\"status\": \"healthy\"}\n</code></pre>"},{"location":"deployment/http-mode/#list-tools","title":"List Tools","text":"<pre><code>curl http://localhost:8000/tools/list\n# Returns list of available tools\n</code></pre>"},{"location":"deployment/http-mode/#mcp-protocol","title":"MCP Protocol","text":"<pre><code>curl http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"tools/list\"}'\n</code></pre>"},{"location":"deployment/http-mode/#version","title":"Version","text":"<pre><code>curl http://localhost:8000/version\n# {\"version\": \"0.4.4\"}\n</code></pre>"},{"location":"deployment/http-mode/#testing","title":"Testing","text":""},{"location":"deployment/http-mode/#with-curl","title":"With curl","text":"<pre><code># Health check\ncurl http://localhost:8000/health\n\n# List tools\ncurl http://localhost:8000/tools/list\n\n# Call a tool\ncurl -X POST http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"jsonrpc\": \"2.0\",\n    \"id\": 1,\n    \"method\": \"tools/call\",\n    \"params\": {\n      \"name\": \"greet\",\n      \"arguments\": {\"name\": \"World\"}\n    }\n  }'\n</code></pre>"},{"location":"deployment/http-mode/#with-python","title":"With Python","text":"<pre><code>import httpx\n\nasync with httpx.AsyncClient() as client:\n    response = await client.post(\n        \"http://localhost:8000/mcp\",\n        json={\n            \"jsonrpc\": \"2.0\",\n            \"id\": 1,\n            \"method\": \"tools/call\",\n            \"params\": {\n                \"name\": \"greet\",\n                \"arguments\": {\"name\": \"World\"}\n            }\n        }\n    )\n    print(response.json())\n</code></pre>"},{"location":"deployment/http-mode/#cors","title":"CORS","text":"<p>CORS is enabled by default for HTTP mode. Configure if needed:</p> <pre><code>from starlette.middleware.cors import CORSMiddleware\n\n# CORS is auto-configured, but you can customize:\n# (Note: Advanced usage - usually not needed)\n</code></pre>"},{"location":"deployment/http-mode/#performance","title":"Performance","text":"<p>HTTP mode achieves 36,000+ requests/second. Optimize with:</p>"},{"location":"deployment/http-mode/#1-multiple-workers","title":"1. Multiple Workers","text":"<pre><code>mcp.run(workers=4)  # Use 4 worker processes\n</code></pre>"},{"location":"deployment/http-mode/#2-uvloop","title":"2. uvloop","text":"<p>Automatically enabled on Linux/macOS:</p> <pre><code>pip install uvloop  # Included by default\n</code></pre>"},{"location":"deployment/http-mode/#3-production-server","title":"3. Production Server","text":"<p>Use uvicorn directly for more control:</p> <pre><code>uvicorn my_server:mcp.app --host 0.0.0.0 --port 8000 --workers 4\n</code></pre>"},{"location":"deployment/http-mode/#sslhttps","title":"SSL/HTTPS","text":"<p>For production, use HTTPS:</p> <pre><code>mcp.run(\n    host=\"0.0.0.0\",\n    port=443,\n    ssl_certfile=\"/path/to/cert.pem\",\n    ssl_keyfile=\"/path/to/key.pem\"\n)\n</code></pre> <p>Or use a reverse proxy (recommended):</p> <pre><code># nginx.conf\nserver {\n    listen 443 ssl;\n    server_name api.example.com;\n\n    ssl_certificate /path/to/cert.pem;\n    ssl_certificate_key /path/to/key.pem;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n    }\n}\n</code></pre>"},{"location":"deployment/http-mode/#monitoring","title":"Monitoring","text":""},{"location":"deployment/http-mode/#logging","title":"Logging","text":"<pre><code>import logging\n\nlogging.basicConfig(level=logging.INFO)\n\nmcp.run(log_level=\"info\")\n</code></pre>"},{"location":"deployment/http-mode/#health-checks","title":"Health Checks","text":"<pre><code># Simple health check\ncurl http://localhost:8000/health\n\n# Use in Docker healthcheck\nHEALTHCHECK CMD curl -f http://localhost:8000/health || exit 1\n</code></pre>"},{"location":"deployment/http-mode/#next-steps","title":"Next Steps","text":"<ul> <li>Docker Deployment - Containerize your server</li> <li>Cloud Deployment - Deploy to AWS, GCP, Azure</li> <li>Production Guide - Best practices</li> <li>Performance - Optimization guide</li> </ul>"},{"location":"deployment/production/","title":"Production Guide","text":"<p>Best practices for deploying MCP servers to production.</p>"},{"location":"deployment/production/#configuration","title":"Configuration","text":"<p>Use environment variables:</p> <pre><code>export MCP_LOG_LEVEL=info\nexport MCP_WORKERS=4\nexport SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"deployment/production/#logging","title":"Logging","text":"<pre><code>import logging\n\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\nmcp.run(log_level=\"info\")\n</code></pre>"},{"location":"deployment/production/#health-checks","title":"Health Checks","text":"<pre><code>curl http://localhost:8000/health\n</code></pre>"},{"location":"deployment/production/#monitoring","title":"Monitoring","text":"<ul> <li>Use <code>/health</code> endpoint</li> <li>Monitor response times</li> <li>Track error rates</li> <li>Set up alerts</li> </ul>"},{"location":"deployment/production/#security","title":"Security","text":"<ol> <li>Use HTTPS</li> <li>Validate inputs</li> <li>Rate limiting</li> <li>Authentication required</li> <li>Keep dependencies updated</li> </ol>"},{"location":"deployment/production/#next-steps","title":"Next Steps","text":"<ul> <li>HTTP Mode - HTTP setup</li> <li>Docker - Containerization</li> <li>Cloud - Cloud deployment</li> </ul>"},{"location":"examples/calculator/","title":"Example: Calculator Server","text":"<p>A complete calculator MCP server demonstrating basic tools, error handling, and testing.</p>"},{"location":"examples/calculator/#overview","title":"Overview","text":"<p>This example shows: - Multiple related tools - Type validation - Error handling - Testing - Claude Desktop integration</p>"},{"location":"examples/calculator/#complete-code","title":"Complete Code","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool\n\nmcp = ChukMCPServer(\"calculator\")\n\n@mcp.tool\ndef add(a: float, b: float) -&gt; float:\n    \"\"\"\n    Add two numbers.\n\n    Args:\n        a: First number\n        b: Second number\n\n    Returns:\n        Sum of a and b\n    \"\"\"\n    return a + b\n\n@mcp.tool\ndef subtract(a: float, b: float) -&gt; float:\n    \"\"\"\n    Subtract b from a.\n\n    Args:\n        a: Number to subtract from\n        b: Number to subtract\n\n    Returns:\n        Difference of a and b\n    \"\"\"\n    return a - b\n\n@mcp.tool\ndef multiply(a: float, b: float) -&gt; float:\n    \"\"\"\n    Multiply two numbers.\n\n    Args:\n        a: First number\n        b: Second number\n\n    Returns:\n        Product of a and b\n    \"\"\"\n    return a * b\n\n@mcp.tool\ndef divide(a: float, b: float) -&gt; dict:\n    \"\"\"\n    Divide a by b with error handling.\n\n    Args:\n        a: Dividend\n        b: Divisor\n\n    Returns:\n        Dictionary with result or error\n    \"\"\"\n    if b == 0:\n        return {\n            \"status\": \"error\",\n            \"error\": \"Cannot divide by zero\"\n        }\n\n    return {\n        \"status\": \"success\",\n        \"result\": a / b\n    }\n\n@mcp.tool\ndef power(base: float, exponent: float) -&gt; float:\n    \"\"\"\n    Raise base to the power of exponent.\n\n    Args:\n        base: Base number\n        exponent: Exponent\n\n    Returns:\n        base^exponent\n    \"\"\"\n    return base ** exponent\n\n@mcp.tool\ndef square_root(n: float) -&gt; dict:\n    \"\"\"\n    Calculate square root of a number.\n\n    Args:\n        n: Number to calculate square root of\n\n    Returns:\n        Dictionary with result or error\n    \"\"\"\n    if n &lt; 0:\n        return {\n            \"status\": \"error\",\n            \"error\": \"Cannot calculate square root of negative number\"\n        }\n\n    import math\n    return {\n        \"status\": \"success\",\n        \"result\": math.sqrt(n)\n    }\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"examples/calculator/#project-structure","title":"Project Structure","text":"<pre><code>calculator/\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 calculator/\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 server.py\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_calculator.py\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"examples/calculator/#testing","title":"Testing","text":"<p>Create <code>tests/test_calculator.py</code>:</p> <pre><code>import pytest\nfrom calculator.server import mcp\n\ndef test_add():\n    \"\"\"Test addition.\"\"\"\n    tool = mcp._tool_handlers[\"add\"].func\n    assert tool(5, 3) == 8\n    assert tool(-5, 3) == -2\n    assert tool(0.1, 0.2) == pytest.approx(0.3)\n\ndef test_subtract():\n    \"\"\"Test subtraction.\"\"\"\n    tool = mcp._tool_handlers[\"subtract\"].func\n    assert tool(5, 3) == 2\n    assert tool(3, 5) == -2\n\ndef test_multiply():\n    \"\"\"Test multiplication.\"\"\"\n    tool = mcp._tool_handlers[\"multiply\"].func\n    assert tool(5, 3) == 15\n    assert tool(-5, 3) == -15\n    assert tool(0, 100) == 0\n\ndef test_divide():\n    \"\"\"Test division.\"\"\"\n    tool = mcp._tool_handlers[\"divide\"].func\n\n    # Normal division\n    result = tool(10, 2)\n    assert result[\"status\"] == \"success\"\n    assert result[\"result\"] == 5\n\n    # Division by zero\n    result = tool(10, 0)\n    assert result[\"status\"] == \"error\"\n    assert \"zero\" in result[\"error\"].lower()\n\ndef test_power():\n    \"\"\"Test power function.\"\"\"\n    tool = mcp._tool_handlers[\"power\"].func\n    assert tool(2, 3) == 8\n    assert tool(5, 2) == 25\n    assert tool(10, 0) == 1\n\ndef test_square_root():\n    \"\"\"Test square root.\"\"\"\n    tool = mcp._tool_handlers[\"square_root\"].func\n\n    # Valid input\n    result = tool(9)\n    assert result[\"status\"] == \"success\"\n    assert result[\"result\"] == 3\n\n    # Negative input\n    result = tool(-9)\n    assert result[\"status\"] == \"error\"\n    assert \"negative\" in result[\"error\"].lower()\n</code></pre> <p>Run tests:</p> <pre><code>pytest tests/\n</code></pre>"},{"location":"examples/calculator/#claude-desktop-integration","title":"Claude Desktop Integration","text":"<p>Add to <code>claude_desktop_config.json</code>:</p> <pre><code>{\n  \"mcpServers\": {\n    \"calculator\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"calculator\"]\n    }\n  }\n}\n</code></pre> <p>Restart Claude Desktop, then try:</p> <p>\"Can you calculate 15 * 7 + 3?\"</p> <p>Claude will use your calculator tools!</p>"},{"location":"examples/calculator/#http-mode","title":"HTTP Mode","text":"<p>For testing in browser or with curl:</p> <pre><code>if __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n</code></pre> <p>Test with curl:</p> <pre><code># Add numbers\ncurl -X POST http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"jsonrpc\": \"2.0\",\n    \"id\": 1,\n    \"method\": \"tools/call\",\n    \"params\": {\n      \"name\": \"add\",\n      \"arguments\": {\"a\": 5, \"b\": 3}\n    }\n  }'\n\n# Divide (with error handling)\ncurl -X POST http://localhost:8000/mcp \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"jsonrpc\": \"2.0\",\n    \"id\": 2,\n    \"method\": \"tools/call\",\n    \"params\": {\n      \"name\": \"divide\",\n      \"arguments\": {\"a\": 10, \"b\": 0}\n    }\n  }'\n</code></pre>"},{"location":"examples/calculator/#enhancements","title":"Enhancements","text":""},{"location":"examples/calculator/#add-memory","title":"Add Memory","text":"<pre><code>from typing import Dict, List\n\nclass Calculator:\n    def __init__(self):\n        self.history: List[Dict] = []\n\n    def record(self, operation: str, a: float, b: float, result: float):\n        self.history.append({\n            \"operation\": operation,\n            \"a\": a,\n            \"b\": b,\n            \"result\": result\n        })\n\ncalc = Calculator()\n\n@mcp.tool\ndef add_with_history(a: float, b: float) -&gt; dict:\n    \"\"\"Add two numbers and record in history.\"\"\"\n    result = a + b\n    calc.record(\"add\", a, b, result)\n    return {\n        \"result\": result,\n        \"history_length\": len(calc.history)\n    }\n\n@mcp.tool\ndef get_history() -&gt; list:\n    \"\"\"Get calculation history.\"\"\"\n    return calc.history\n</code></pre>"},{"location":"examples/calculator/#add-advanced-functions","title":"Add Advanced Functions","text":"<pre><code>import math\n\n@mcp.tool\ndef factorial(n: int) -&gt; dict:\n    \"\"\"Calculate factorial of n.\"\"\"\n    if n &lt; 0:\n        return {\"status\": \"error\", \"error\": \"Factorial of negative number\"}\n    if n &gt; 100:\n        return {\"status\": \"error\", \"error\": \"Number too large\"}\n\n    result = math.factorial(n)\n    return {\"status\": \"success\", \"result\": result}\n\n@mcp.tool\ndef sin(x: float) -&gt; float:\n    \"\"\"Calculate sine of x (in radians).\"\"\"\n    return math.sin(x)\n\n@mcp.tool\ndef cos(x: float) -&gt; float:\n    \"\"\"Calculate cosine of x (in radians).\"\"\"\n    return math.cos(x)\n</code></pre>"},{"location":"examples/calculator/#key-learnings","title":"Key Learnings","text":"<ol> <li>Type hints are validated automatically - No manual checking needed</li> <li>Error handling via return values - Better than exceptions for Claude</li> <li>Clear docstrings help Claude - Write for LLM consumption</li> <li>Testing is straightforward - Access tool functions directly</li> <li>Both STDIO and HTTP work - Same code, different transports</li> </ol>"},{"location":"examples/calculator/#next-steps","title":"Next Steps","text":"<ul> <li>Weather Server Example - Async tools with external APIs</li> <li>Database Example - CRUD operations</li> <li>OAuth Example - Authenticated tools</li> <li>Building Tools Guide - Comprehensive tool documentation</li> </ul>"},{"location":"examples/cloud/","title":"Example: Cloud Deployment","text":"<p>Deploy to Google Cloud Functions.</p>"},{"location":"examples/cloud/#server-code","title":"Server Code","text":"<pre><code># main.py\nfrom chuk_mcp_server import tool\n\n@tool\ndef hello(name: str = \"World\") -&gt; str:\n    \"\"\"Greet someone.\"\"\"\n    return f\"Hello, {name}!\"\n\n# Handler automatically exported for GCF\n</code></pre>"},{"location":"examples/cloud/#deploy-to-gcf","title":"Deploy to GCF","text":"<pre><code>gcloud functions deploy my-mcp-server \\\n  --runtime python311 \\\n  --trigger-http \\\n  --entry-point handler \\\n  --allow-unauthenticated\n</code></pre>"},{"location":"examples/cloud/#test","title":"Test","text":"<pre><code>curl https://REGION-PROJECT.cloudfunctions.net/my-mcp-server/health\n</code></pre>"},{"location":"examples/cloud/#next-steps","title":"Next Steps","text":"<ul> <li>Cloud Deployment Guide - All platforms</li> <li>Docker Deployment - Containers</li> <li>Production Guide - Best practices</li> </ul>"},{"location":"examples/database/","title":"Example: Database Server","text":"<p>CRUD operations with SQLite.</p>"},{"location":"examples/database/#complete-server","title":"Complete Server","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool\nimport aiosqlite\n\nmcp = ChukMCPServer(\"database\")\n\n@mcp.tool\nasync def create_user(name: str, email: str) -&gt; dict:\n    \"\"\"Create a new user.\"\"\"\n    async with aiosqlite.connect(\"app.db\") as db:\n        cursor = await db.execute(\n            \"INSERT INTO users (name, email) VALUES (?, ?)\",\n            (name, email)\n        )\n        await db.commit()\n        return {\"id\": cursor.lastrowid, \"name\": name, \"email\": email}\n\n@mcp.tool\nasync def get_user(user_id: int) -&gt; dict:\n    \"\"\"Get user by ID.\"\"\"\n    async with aiosqlite.connect(\"app.db\") as db:\n        cursor = await db.execute(\n            \"SELECT id, name, email FROM users WHERE id = ?\",\n            (user_id,)\n        )\n        row = await cursor.fetchone()\n        if not row:\n            return {\"status\": \"not_found\"}\n        return {\"id\": row[0], \"name\": row[1], \"email\": row[2]}\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"examples/database/#next-steps","title":"Next Steps","text":"<ul> <li>Calculator Example - Basic tools</li> <li>Weather Example - Async operations</li> <li>OAuth Example - Authentication</li> </ul>"},{"location":"examples/oauth/","title":"Example: OAuth Integration","text":"<p>Protected tools with OAuth authentication.</p>"},{"location":"examples/oauth/#complete-server","title":"Complete Server","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, requires_auth\nfrom chuk_mcp_server.oauth import OAuthMiddleware\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\nmcp = ChukMCPServer(\"oauth-example\")\n\n@mcp.tool\n@requires_auth()\nasync def get_profile(_external_access_token: str | None = None) -&gt; dict:\n    \"\"\"Get user profile (requires auth).\"\"\"\n    import httpx\n\n    async with httpx.AsyncClient() as client:\n        response = await client.get(\n            \"https://www.googleapis.com/oauth2/v2/userinfo\",\n            headers={\"Authorization\": f\"Bearer {_external_access_token}\"}\n        )\n        return response.json()\n\n# Setup OAuth\noauth_hook = setup_google_drive_oauth(mcp)\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre>"},{"location":"examples/oauth/#next-steps","title":"Next Steps","text":"<ul> <li>OAuth Overview - Complete guide</li> <li>Protected Tools - Auth patterns</li> <li>Google Drive - Provider setup</li> </ul>"},{"location":"examples/weather/","title":"Example: Weather Server","text":"<p>Async tools with external API integration.</p>"},{"location":"examples/weather/#complete-server","title":"Complete Server","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool\nimport httpx\nimport os\n\nmcp = ChukMCPServer(\"weather\")\n\nAPI_KEY = os.getenv(\"WEATHER_API_KEY\", \"demo\")\n\n@mcp.tool\nasync def get_weather(city: str) -&gt; dict:\n    \"\"\"Get current weather for a city.\"\"\"\n    async with httpx.AsyncClient() as client:\n        response = await client.get(\n            f\"https://api.openweathermap.org/data/2.5/weather\",\n            params={\"q\": city, \"appid\": API_KEY, \"units\": \"imperial\"}\n        )\n        data = response.json()\n        return {\n            \"city\": city,\n            \"temperature\": data[\"main\"][\"temp\"],\n            \"condition\": data[\"weather\"][0][\"description\"],\n            \"humidity\": data[\"main\"][\"humidity\"]\n        }\n\n@mcp.tool\ndef convert_temp(temp: float, from_unit: str, to_unit: str) -&gt; float:\n    \"\"\"Convert temperature between C and F.\"\"\"\n    if from_unit == \"F\" and to_unit == \"C\":\n        return (temp - 32) * 5/9\n    elif from_unit == \"C\" and to_unit == \"F\":\n        return (temp * 9/5) + 32\n    return temp\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"examples/weather/#next-steps","title":"Next Steps","text":"<ul> <li>Calculator Example - Basic tools</li> <li>Database Example - CRUD operations</li> <li>OAuth Example - Authentication</li> </ul>"},{"location":"getting-started/claude-desktop/","title":"Claude Desktop Setup","text":"<p>Integrate your ChukMCPServer with Claude Desktop for seamless AI-powered tool usage.</p>"},{"location":"getting-started/claude-desktop/#prerequisites","title":"Prerequisites","text":"<ul> <li>Claude Desktop installed</li> <li>ChukMCPServer installed (<code>pip install chuk-mcp-server</code>)</li> <li>A working MCP server</li> </ul>"},{"location":"getting-started/claude-desktop/#quick-setup-automatic","title":"Quick Setup (Automatic)","text":"<p>The easiest way is to use the scaffolder with <code>--claude</code> flag:</p> <pre><code>uvx chuk-mcp-server init my-server --claude\n</code></pre> <p>This automatically: 1. Creates your server 2. Adds configuration to Claude Desktop 3. Sets up the correct paths</p> <p>Restart Claude Desktop and your tools will be available!</p>"},{"location":"getting-started/claude-desktop/#manual-setup","title":"Manual Setup","text":""},{"location":"getting-started/claude-desktop/#step-1-locate-config-file","title":"Step 1: Locate Config File","text":"<p>Find your Claude Desktop config file:</p> macOSWindowsLinux <pre><code>~/Library/Application Support/Claude/claude_desktop_config.json\n</code></pre> <pre><code>%APPDATA%\\Claude\\claude_desktop_config.json\n</code></pre> <pre><code>~/.config/Claude/claude_desktop_config.json\n</code></pre>"},{"location":"getting-started/claude-desktop/#step-2-add-your-server","title":"Step 2: Add Your Server","text":"<p>Edit <code>claude_desktop_config.json</code>:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"python\",\n      \"args\": [\"/path/to/your/server.py\"]\n    }\n  }\n}\n</code></pre> <p>Or if using uv:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"my-server\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#step-3-restart-claude-desktop","title":"Step 3: Restart Claude Desktop","text":"<p>Close and reopen Claude Desktop for changes to take effect.</p>"},{"location":"getting-started/claude-desktop/#verifying-it-works","title":"Verifying It Works","text":"<ol> <li>Open Claude Desktop</li> <li>Start a new conversation</li> <li>Look for the \ud83d\udd0c icon indicating tools are available</li> <li>Ask Claude to use one of your tools:</li> </ol> <p>\"Can you use the my-server tools to greet me?\"</p> <p>Claude should be able to see and call your tools!</p>"},{"location":"getting-started/claude-desktop/#example-configurations","title":"Example Configurations","text":""},{"location":"getting-started/claude-desktop/#basic-server","title":"Basic Server","text":"<pre><code>{\n  \"mcpServers\": {\n    \"calculator\": {\n      \"command\": \"python\",\n      \"args\": [\"calculator.py\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#server-with-environment-variables","title":"Server with Environment Variables","text":"<pre><code>{\n  \"mcpServers\": {\n    \"weather\": {\n      \"command\": \"python\",\n      \"args\": [\"weather_server.py\"],\n      \"env\": {\n        \"WEATHER_API_KEY\": \"your-api-key-here\",\n        \"LOG_LEVEL\": \"info\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#multiple-servers","title":"Multiple Servers","text":"<pre><code>{\n  \"mcpServers\": {\n    \"weather\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"weather-server\"]\n    },\n    \"calculator\": {\n      \"command\": \"python\",\n      \"args\": [\"/Users/you/servers/calc.py\"]\n    },\n    \"database\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"db-server\"],\n      \"env\": {\n        \"DATABASE_URL\": \"postgresql://localhost/mydb\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#using-poetry","title":"Using Poetry","text":"<pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"poetry\",\n      \"args\": [\"run\", \"python\", \"server.py\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#using-virtual-environment","title":"Using Virtual Environment","text":"<pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"/path/to/venv/bin/python\",\n      \"args\": [\"server.py\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/claude-desktop/#tools-not-appearing","title":"Tools Not Appearing","text":"<p>Check the config file is valid JSON:</p> <pre><code># macOS/Linux\ncat ~/Library/Application\\ Support/Claude/claude_desktop_config.json | python -m json.tool\n\n# Windows\ntype %APPDATA%\\Claude\\claude_desktop_config.json | python -m json.tool\n</code></pre> <p>Verify the server runs standalone:</p> <pre><code>python your_server.py\n</code></pre> <p>You should see: <pre><code>ChukMCPServer initialized\n\ud83d\udccb X tools registered\n\ud83d\ude80 Server running on stdio transport\n</code></pre></p> <p>Check Claude Desktop logs:</p> macOSWindows <pre><code>tail -f ~/Library/Logs/Claude/mcp*.log\n</code></pre> <pre><code>%USERPROFILE%\\AppData\\Local\\Claude\\Logs\\mcp*.log\n</code></pre>"},{"location":"getting-started/claude-desktop/#server-crashes-on-startup","title":"Server Crashes on Startup","text":"<p>Check Python version:</p> <pre><code>python --version  # Should be 3.10+\n</code></pre> <p>Test with minimal server:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef test() -&gt; str:\n    return \"It works!\"\n\nrun()\n</code></pre> <p>Check for import errors:</p> <pre><code>python -c \"import chuk_mcp_server; print('OK')\"\n</code></pre>"},{"location":"getting-started/claude-desktop/#environment-variables-not-working","title":"Environment Variables Not Working","text":"<p>Make sure env vars are in the config:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"python\",\n      \"args\": [\"server.py\"],\n      \"env\": {\n        \"API_KEY\": \"your-key\",\n        \"DEBUG\": \"true\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#path-issues","title":"Path Issues","text":"<p>Use absolute paths:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"python\",\n      \"args\": [\"/Users/yourname/projects/server.py\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#best-practices","title":"Best Practices","text":""},{"location":"getting-started/claude-desktop/#1-use-project-structure","title":"1. Use Project Structure","text":"<p>Organize your server as a package:</p> <pre><code>my-server/\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 my_server/\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 server.py\n\u2514\u2500\u2500 README.md\n</code></pre> <p>Then use <code>uv run</code>:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"uv\",\n      \"args\": [\"run\", \"my-server\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#2-environment-variables","title":"2. Environment Variables","text":"<p>Store secrets in environment variables, not in code:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"python\",\n      \"args\": [\"server.py\"],\n      \"env\": {\n        \"API_KEY\": \"${API_KEY}\",  // Read from system env\n        \"DATABASE_URL\": \"postgresql://localhost/mydb\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#3-logging","title":"3. Logging","text":"<p>Enable logging to debug issues:</p> <pre><code>{\n  \"mcpServers\": {\n    \"my-server\": {\n      \"command\": \"python\",\n      \"args\": [\"server.py\"],\n      \"env\": {\n        \"MCP_LOG_LEVEL\": \"debug\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#4-multiple-servers","title":"4. Multiple Servers","text":"<p>Keep servers focused on single domains:</p> <pre><code>{\n  \"mcpServers\": {\n    \"weather\": { ... },      // Weather tools\n    \"database\": { ... },     // Database tools\n    \"calculator\": { ... }    // Math tools\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#testing-your-server","title":"Testing Your Server","text":"<p>Before adding to Claude Desktop, test standalone:</p> <pre><code># Test that tools are registered\necho '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"tools/list\"}' | python server.py\n\n# Test calling a tool\necho '{\"jsonrpc\":\"2.0\",\"id\":2,\"method\":\"tools/call\",\"params\":{\"name\":\"my_tool\",\"arguments\":{}}}' | python server.py\n</code></pre>"},{"location":"getting-started/claude-desktop/#example-complete-weather-server","title":"Example: Complete Weather Server","text":"<p>server.py:</p> <pre><code>from chuk_mcp_server import tool, run\nimport os\n\nAPI_KEY = os.getenv(\"WEATHER_API_KEY\", \"demo-key\")\n\n@tool\ndef get_weather(city: str) -&gt; dict:\n    \"\"\"Get current weather for a city.\"\"\"\n    # Use API_KEY to call weather API\n    return {\"city\": city, \"temp\": 72, \"condition\": \"sunny\"}\n\nrun()\n</code></pre> <p>claude_desktop_config.json:</p> <pre><code>{\n  \"mcpServers\": {\n    \"weather\": {\n      \"command\": \"python\",\n      \"args\": [\"/Users/you/weather/server.py\"],\n      \"env\": {\n        \"WEATHER_API_KEY\": \"your-actual-api-key\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/claude-desktop/#next-steps","title":"Next Steps","text":"<ul> <li>Building Tools - Create more sophisticated tools</li> <li>OAuth Authentication - Add authentication</li> <li>Deployment - Deploy to production</li> </ul>"},{"location":"getting-started/claude-desktop/#support","title":"Support","text":"<p>Having issues?</p> <ol> <li>Check Troubleshooting section above</li> <li>Review Claude Desktop logs</li> <li>Test server standalone</li> <li>Check GitHub Issues</li> </ol>"},{"location":"getting-started/first-server/","title":"Your First Server","text":"<p>A step-by-step tutorial to build your first MCP server with ChukMCPServer.</p>"},{"location":"getting-started/first-server/#what-well-build","title":"What We'll Build","text":"<p>A weather information server with: - Current weather lookup - Temperature conversion - Weather alerts</p> <p>Estimated time: 10 minutes</p>"},{"location":"getting-started/first-server/#step-1-create-the-project","title":"Step 1: Create the Project","text":"<p>Using the scaffolder (recommended):</p> <pre><code>uvx chuk-mcp-server init weather-server\ncd weather-server\n</code></pre> <p>This creates: <pre><code>weather-server/\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 weather_server/\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 server.py\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_server.py\n\u2514\u2500\u2500 README.md\n</code></pre></p>"},{"location":"getting-started/first-server/#step-2-define-your-tools","title":"Step 2: Define Your Tools","text":"<p>Edit <code>src/weather_server/server.py</code>:</p> <pre><code>from chuk_mcp_server import ChukMCPServer, tool\n\nmcp = ChukMCPServer(\"weather-server\")\n\n@mcp.tool\ndef get_weather(city: str) -&gt; dict:\n    \"\"\"\n    Get current weather for a city.\n\n    Args:\n        city: Name of the city\n\n    Returns:\n        Weather information including temperature and conditions\n    \"\"\"\n    # In production, call a real weather API\n    # For demo, return mock data\n    return {\n        \"city\": city,\n        \"temperature\": 72,\n        \"condition\": \"sunny\",\n        \"humidity\": 45,\n        \"wind_speed\": 5\n    }\n\n@mcp.tool\ndef convert_temperature(temp: float, from_unit: str, to_unit: str) -&gt; float:\n    \"\"\"\n    Convert temperature between Celsius and Fahrenheit.\n\n    Args:\n        temp: Temperature value\n        from_unit: Source unit ('C' or 'F')\n        to_unit: Target unit ('C' or 'F')\n\n    Returns:\n        Converted temperature\n    \"\"\"\n    if from_unit == 'F' and to_unit == 'C':\n        return (temp - 32) * 5/9\n    elif from_unit == 'C' and to_unit == 'F':\n        return (temp * 9/5) + 32\n    else:\n        return temp\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"getting-started/first-server/#step-3-run-the-server","title":"Step 3: Run the Server","text":"<pre><code>uv run weather-server\n</code></pre> <p>You should see: <pre><code>ChukMCPServer initialized\n\ud83d\udccb 2 tools registered\n\ud83d\ude80 Server running on stdio transport\n</code></pre></p>"},{"location":"getting-started/first-server/#step-4-test-the-server","title":"Step 4: Test the Server","text":""},{"location":"getting-started/first-server/#option-a-command-line-test","title":"Option A: Command Line Test","text":"<pre><code>echo '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"tools/list\"}' | uv run weather-server\n</code></pre> <p>You should see your tools listed.</p>"},{"location":"getting-started/first-server/#option-b-http-mode-for-testing","title":"Option B: HTTP Mode (for testing)","text":"<p>Modify <code>server.py</code>:</p> <pre><code>if __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n</code></pre> <p>Then test with curl:</p> <pre><code>curl http://localhost:8000/health\ncurl http://localhost:8000/tools/list\n</code></pre>"},{"location":"getting-started/first-server/#step-5-add-type-safety","title":"Step 5: Add Type Safety","text":"<p>ChukMCPServer automatically validates types. Try it:</p> <pre><code>@mcp.tool\ndef calculate_heat_index(temperature: float, humidity: int) -&gt; dict:\n    \"\"\"\n    Calculate heat index.\n\n    Args:\n        temperature: Temperature in Fahrenheit (must be float)\n        humidity: Relative humidity (must be int, 0-100)\n\n    Returns:\n        Heat index calculation results\n    \"\"\"\n    if not 0 &lt;= humidity &lt;= 100:\n        raise ValueError(\"Humidity must be between 0 and 100\")\n\n    # Simplified heat index formula\n    heat_index = temperature + (0.5 * humidity)\n\n    return {\n        \"temperature\": temperature,\n        \"humidity\": humidity,\n        \"heat_index\": round(heat_index, 1),\n        \"warning\": \"extreme\" if heat_index &gt; 105 else \"normal\"\n    }\n</code></pre> <p>The types are automatically validated - if someone calls with a string instead of a number, they'll get a clear error message.</p>"},{"location":"getting-started/first-server/#step-6-add-async-tools","title":"Step 6: Add Async Tools","text":"<p>For external API calls, use async:</p> <pre><code>import httpx\n\n@mcp.tool\nasync def fetch_forecast(city: str, days: int = 5) -&gt; dict:\n    \"\"\"\n    Fetch weather forecast from external API.\n\n    Args:\n        city: City name\n        days: Number of days to forecast (default: 5)\n\n    Returns:\n        Forecast data\n    \"\"\"\n    # Example: Call real weather API\n    async with httpx.AsyncClient() as client:\n        # Replace with real API\n        url = f\"https://api.weather.com/forecast?city={city}&amp;days={days}\"\n        response = await client.get(url)\n        return response.json()\n</code></pre>"},{"location":"getting-started/first-server/#step-7-add-resources","title":"Step 7: Add Resources","text":"<p>Resources provide data that tools can read:</p> <pre><code>from chuk_mcp_server import resource\n\n@mcp.resource(\"weather://config\")\ndef get_config() -&gt; dict:\n    \"\"\"Server configuration.\"\"\"\n    return {\n        \"api_key\": \"your-api-key\",  # In production, use env vars!\n        \"default_units\": \"imperial\",\n        \"cache_timeout\": 300\n    }\n\n@mcp.resource(\"weather://cities\")\ndef get_supported_cities() -&gt; list:\n    \"\"\"List of supported cities.\"\"\"\n    return [\n        \"New York\",\n        \"Los Angeles\",\n        \"Chicago\",\n        \"Houston\",\n        \"Phoenix\"\n    ]\n</code></pre>"},{"location":"getting-started/first-server/#step-8-add-error-handling","title":"Step 8: Add Error Handling","text":"<pre><code>from typing import Optional\n\n@mcp.tool\ndef get_weather_safe(city: str) -&gt; dict:\n    \"\"\"Get weather with error handling.\"\"\"\n    try:\n        # Your weather API call here\n        if city.lower() == \"invalid\":\n            raise ValueError(f\"City '{city}' not found\")\n\n        return {\n            \"city\": city,\n            \"status\": \"success\",\n            \"data\": {\"temperature\": 72, \"condition\": \"sunny\"}\n        }\n    except ValueError as e:\n        return {\n            \"city\": city,\n            \"status\": \"error\",\n            \"error\": str(e)\n        }\n    except Exception as e:\n        return {\n            \"city\": city,\n            \"status\": \"error\",\n            \"error\": \"An unexpected error occurred\"\n        }\n</code></pre>"},{"location":"getting-started/first-server/#step-9-write-tests","title":"Step 9: Write Tests","text":"<p>Edit <code>tests/test_server.py</code>:</p> <pre><code>import pytest\nfrom weather_server.server import mcp\n\ndef test_temperature_conversion():\n    \"\"\"Test temperature conversion tool.\"\"\"\n    # Get the tool function\n    tool_func = mcp._tool_handlers[\"convert_temperature\"].func\n\n    # Test F to C\n    result = tool_func(temp=32, from_unit='F', to_unit='C')\n    assert result == 0\n\n    # Test C to F\n    result = tool_func(temp=0, from_unit='C', to_unit='F')\n    assert result == 32\n\ndef test_heat_index():\n    \"\"\"Test heat index calculation.\"\"\"\n    tool_func = mcp._tool_handlers[\"calculate_heat_index\"].func\n\n    result = tool_func(temperature=90, humidity=60)\n    assert \"heat_index\" in result\n    assert result[\"temperature\"] == 90\n    assert result[\"humidity\"] == 60\n</code></pre> <p>Run tests:</p> <pre><code>uv run pytest\n</code></pre>"},{"location":"getting-started/first-server/#complete-example","title":"Complete Example","text":"<p>Here's the complete server:</p> <pre><code>from chuk_mcp_server import ChukMCPServer, tool, resource\nimport httpx\nfrom typing import Optional\n\nmcp = ChukMCPServer(\"weather-server\")\n\n@mcp.tool\ndef get_weather(city: str) -&gt; dict:\n    \"\"\"Get current weather for a city.\"\"\"\n    return {\n        \"city\": city,\n        \"temperature\": 72,\n        \"condition\": \"sunny\",\n        \"humidity\": 45\n    }\n\n@mcp.tool\ndef convert_temperature(temp: float, from_unit: str, to_unit: str) -&gt; float:\n    \"\"\"Convert temperature between C and F.\"\"\"\n    if from_unit == 'F' and to_unit == 'C':\n        return (temp - 32) * 5/9\n    elif from_unit == 'C' and to_unit == 'F':\n        return (temp * 9/5) + 32\n    return temp\n\n@mcp.tool\ndef calculate_heat_index(temperature: float, humidity: int) -&gt; dict:\n    \"\"\"Calculate heat index from temperature and humidity.\"\"\"\n    if not 0 &lt;= humidity &lt;= 100:\n        raise ValueError(\"Humidity must be 0-100\")\n\n    heat_index = temperature + (0.5 * humidity)\n    return {\n        \"heat_index\": round(heat_index, 1),\n        \"warning\": \"extreme\" if heat_index &gt; 105 else \"normal\"\n    }\n\n@mcp.resource(\"weather://config\")\ndef get_config() -&gt; dict:\n    \"\"\"Server configuration.\"\"\"\n    return {\n        \"default_units\": \"imperial\",\n        \"cache_timeout\": 300\n    }\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"getting-started/first-server/#next-steps","title":"Next Steps","text":"<ul> <li>Add to Claude Desktop - Use your server with Claude</li> <li>Building Tools - Learn advanced tool patterns</li> <li>Deployment - Deploy to production</li> <li>Examples - See the complete weather server</li> </ul>"},{"location":"getting-started/first-server/#common-issues","title":"Common Issues","text":"<p>Tools not appearing?</p> <p>Make sure you're using <code>@mcp.tool</code> not just <code>@tool</code> if using the server-based API.</p> <p>Type validation errors?</p> <p>Check that your type hints match the actual data you're passing.</p> <p>Async tools not working?</p> <p>Make sure you're using <code>async def</code> and <code>await</code> for async operations.</p>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>Get ChukMCPServer up and running in minutes.</p>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.10 or higher</li> <li>pip or uv package manager</li> </ul>"},{"location":"getting-started/installation/#basic-installation","title":"Basic Installation","text":"Using pipUsing uv (recommended) <pre><code>pip install chuk-mcp-server\n</code></pre> <pre><code>uv pip install chuk-mcp-server\n</code></pre>"},{"location":"getting-started/installation/#optional-dependencies","title":"Optional Dependencies","text":"<p>ChukMCPServer offers optional feature sets:</p>"},{"location":"getting-started/installation/#google-drive-oauth","title":"Google Drive OAuth","text":"<p>For Google Drive authentication and storage:</p> <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre> <p>Includes: - <code>google-auth&gt;=2.23.0</code> - <code>google-auth-oauthlib&gt;=1.1.0</code> - <code>google-api-python-client&gt;=2.100.0</code></p>"},{"location":"getting-started/installation/#all-features","title":"All Features","text":"<p>Install everything:</p> <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre>"},{"location":"getting-started/installation/#development-installation","title":"Development Installation","text":"<p>For contributing to ChukMCPServer:</p> <pre><code># Clone the repository\ngit clone https://github.com/chrishayuk/chuk-mcp-server.git\ncd chuk-mcp-server\n\n# Install with development dependencies\nuv pip install -e \".[dev]\"\n\n# Install pre-commit hooks\npre-commit install\n</code></pre> <p>Development dependencies include: - Testing: <code>pytest</code>, <code>pytest-asyncio</code>, <code>pytest-cov</code> - Linting: <code>ruff</code>, <code>mypy</code> - Formatting: <code>black</code> (via ruff)</p>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>Check that ChukMCPServer is installed correctly:</p> <pre><code>python -c \"import chuk_mcp_server; print(chuk_mcp_server.__version__)\"\n</code></pre> <p>You should see the version number (e.g., <code>0.4.4</code>).</p>"},{"location":"getting-started/installation/#upgrading","title":"Upgrading","text":"Using pipUsing uv <pre><code>pip install --upgrade chuk-mcp-server\n</code></pre> <pre><code>uv pip install --upgrade chuk-mcp-server\n</code></pre>"},{"location":"getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/installation/#import-errors","title":"Import Errors","text":"<p>If you see import errors, ensure you're using Python 3.10+:</p> <pre><code>python --version  # Should be 3.10 or higher\n</code></pre>"},{"location":"getting-started/installation/#optional-dependencies_1","title":"Optional Dependencies","text":"<p>If OAuth features aren't working:</p> <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Create your first server</li> <li>Your First Server - Detailed walkthrough</li> <li>Claude Desktop Setup - Integrate with Claude</li> </ul>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>Get up and running with ChukMCPServer in 30 seconds.</p>"},{"location":"getting-started/quickstart/#three-ways-to-start","title":"Three Ways to Start","text":"<p>Choose the approach that works best for you:</p> Scaffolder (Recommended)Manual (5 Lines)Claude Desktop (Instant) <p>The fastest way to create a new server:</p> <pre><code>uvx chuk-mcp-server init my-server\ncd my-server\nuv run my-server\n</code></pre> <p>This creates a complete project structure with: - Pre-configured <code>pyproject.toml</code> - Example tools - Test setup - Documentation</p> <p>Write it yourself in seconds:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef greet(name: str) -&gt; str:\n    \"\"\"Greet someone by name.\"\"\"\n    return f\"Hello, {name}!\"\n\nrun()\n</code></pre> <p>Save as <code>server.py</code> and run: <pre><code>python server.py\n</code></pre></p> <p>Auto-configure for Claude Desktop:</p> <pre><code>uvx chuk-mcp-server init my-server --claude\n</code></pre> <p>This automatically: - Creates the server - Adds to <code>claude_desktop_config.json</code> - Configures the command path</p> <p>Restart Claude Desktop and you're ready!</p>"},{"location":"getting-started/quickstart/#your-first-tool","title":"Your First Tool","text":"<p>Let's build a simple calculator:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef add(a: int, b: int) -&gt; int:\n    \"\"\"Add two numbers together.\"\"\"\n    return a + b\n\n@tool\ndef multiply(a: int, b: int) -&gt; int:\n    \"\"\"Multiply two numbers.\"\"\"\n    return a * b\n\nrun()\n</code></pre> <p>That's it! Save and run:</p> <pre><code>python calculator.py\n</code></pre>"},{"location":"getting-started/quickstart/#testing-your-server","title":"Testing Your Server","text":""},{"location":"getting-started/quickstart/#with-stdio-transport-default","title":"With STDIO Transport (Default)","text":"<p>The server runs on stdio transport by default, perfect for Claude Desktop:</p> <pre><code>python server.py\n</code></pre> <p>Test by piping JSON-RPC:</p> <pre><code>echo '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"tools/list\"}' | python server.py\n</code></pre>"},{"location":"getting-started/quickstart/#with-http-transport","title":"With HTTP Transport","text":"<p>For web APIs and testing in the browser:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef greet(name: str) -&gt; str:\n    return f\"Hello, {name}!\"\n\nrun(transport=\"http\", port=8000)\n</code></pre> <p>Test with curl:</p> <pre><code>curl http://localhost:8000/health\ncurl http://localhost:8000/tools/list\n</code></pre>"},{"location":"getting-started/quickstart/#adding-more-tools","title":"Adding More Tools","text":"<p>Tools are just Python functions with the <code>@tool</code> decorator:</p> <pre><code>from chuk_mcp_server import tool\n\n@tool\ndef get_weather(city: str) -&gt; dict:\n    \"\"\"Get weather for a city.\"\"\"\n    # In real code, call a weather API\n    return {\n        \"city\": city,\n        \"temperature\": 72,\n        \"condition\": \"sunny\"\n    }\n\n@tool\nasync def fetch_data(url: str) -&gt; str:\n    \"\"\"Fetch data from a URL (async example).\"\"\"\n    import httpx\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.text\n</code></pre>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Your First Server - Detailed tutorial</li> <li>Claude Desktop Setup - Connect to Claude</li> <li>Building Tools - Learn all about tools</li> <li>Examples - See real-world examples</li> </ul>"},{"location":"getting-started/quickstart/#common-patterns","title":"Common Patterns","text":""},{"location":"getting-started/quickstart/#global-vs-server-based-api","title":"Global vs Server-Based API","text":"Global (Simple)Server-Based (Advanced) <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef my_tool():\n    return \"Hello\"\n\nrun()\n</code></pre> <pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(\"my-server\")\n\n@mcp.tool\ndef my_tool():\n    return \"Hello\"\n\nmcp.run()\n</code></pre> <p>Use global for quick scripts, server-based for multiple servers or advanced features.</p>"},{"location":"getting-started/quickstart/#troubleshooting","title":"Troubleshooting","text":"<p>Server won't start?</p> <p>Check that the port isn't already in use: <pre><code>lsof -i :8000  # Check if port 8000 is in use\n</code></pre></p> <p>Tools not showing in Claude?</p> <p>Make sure: 1. Server is running 2. <code>claude_desktop_config.json</code> is correct 3. Claude Desktop was restarted after config changes</p> <p>Import errors?</p> <p>Ensure ChukMCPServer is installed: <pre><code>pip install chuk-mcp-server\n</code></pre></p>"},{"location":"guides/artifacts/","title":"Artifact &amp; Workspace Storage","text":"<p>ChukMCPServer integrates with the chuk-artifacts package to provide unified artifact and workspace storage for your MCP tools. This allows you to store blobs, manage workspaces with virtual filesystems, and handle file operations across different storage backends.</p>"},{"location":"guides/artifacts/#overview","title":"Overview","text":"<p>chuk-artifacts provides: - Blob Storage: Store binary data (files, images, documents) - Workspace VFS: Virtual filesystems for project-like structures - Multiple Backends: Memory, filesystem, S3, SQLite - Scoped Storage: Session, user, global, or sandbox scopes</p>"},{"location":"guides/artifacts/#installation","title":"Installation","text":"<p>The artifact functionality is optional and requires the <code>chuk-artifacts</code> package:</p> <pre><code># Install with artifact support\npip install 'chuk-mcp-server[artifacts]'\n\n# Or install separately\npip install chuk-mcp-server chuk-artifacts\n</code></pre>"},{"location":"guides/artifacts/#quick-start","title":"Quick Start","text":""},{"location":"guides/artifacts/#basic-blob-storage","title":"Basic Blob Storage","text":"<pre><code>from chuk_mcp_server import tool, set_artifact_store, get_artifact_store\nfrom chuk_artifacts import ArtifactStore, NamespaceType, StorageScope\n\n# Initialize the artifact store (do this once at startup)\nstore = ArtifactStore()\nset_artifact_store(store)\n\n@tool\nasync def store_file(filename: str, content: bytes) -&gt; str:\n    \"\"\"Store a file as a blob artifact.\"\"\"\n    store = get_artifact_store()\n\n    # Create a blob namespace\n    ns = await store.create_namespace(\n        type=NamespaceType.BLOB,\n        scope=StorageScope.SESSION\n    )\n\n    # Write the blob data\n    await store.write_namespace(ns.namespace_id, data=content)\n\n    return f\"Stored {filename} with ID: {ns.namespace_id}\"\n</code></pre>"},{"location":"guides/artifacts/#workspace-with-vfs","title":"Workspace with VFS","text":"<pre><code>@tool\nasync def create_workspace(project_name: str) -&gt; str:\n    \"\"\"Create a workspace with a virtual filesystem.\"\"\"\n    store = get_artifact_store()\n\n    # Create a workspace namespace\n    ns = await store.create_namespace(\n        name=project_name,\n        type=NamespaceType.WORKSPACE,\n        scope=StorageScope.SESSION,\n        provider_type=\"vfs-memory\"  # or vfs-filesystem, vfs-s3, vfs-sqlite\n    )\n\n    # Get the VFS for file operations\n    vfs = store.get_namespace_vfs(ns.namespace_id)\n    await vfs.write_file(\"/README.md\", b\"# My Project\\n\")\n    await vfs.write_file(\"/src/main.py\", b\"print('hello')\")\n\n    return f\"Created workspace: {ns.namespace_id}\"\n</code></pre>"},{"location":"guides/artifacts/#convenience-functions","title":"Convenience Functions","text":"<p>ChukMCPServer provides convenience functions for common artifact operations:</p> <pre><code>from chuk_mcp_server import (\n    # Namespace creation\n    create_blob_namespace,\n    create_workspace_namespace,\n\n    # Blob operations\n    write_blob,\n    read_blob,\n\n    # Workspace file operations\n    write_workspace_file,\n    read_workspace_file,\n\n    # VFS access\n    get_namespace_vfs,\n)\n</code></pre>"},{"location":"guides/artifacts/#blob-example","title":"Blob Example","text":"<pre><code>from chuk_artifacts import StorageScope\n\n@tool\nasync def quick_blob_example(data: bytes) -&gt; str:\n    \"\"\"Store a blob using convenience functions.\"\"\"\n    # Create blob namespace\n    ns = await create_blob_namespace(scope=StorageScope.SESSION)\n\n    # Write blob data\n    await write_blob(ns.namespace_id, data, mime=\"application/octet-stream\")\n\n    # Read it back\n    retrieved = await read_blob(ns.namespace_id)\n\n    return f\"Stored and retrieved {len(retrieved)} bytes\"\n</code></pre>"},{"location":"guides/artifacts/#workspace-example","title":"Workspace Example","text":"<pre><code>@tool\nasync def quick_workspace_example(project_name: str) -&gt; str:\n    \"\"\"Create a workspace using convenience functions.\"\"\"\n    # Create workspace\n    ws = await create_workspace_namespace(\n        name=project_name,\n        scope=StorageScope.SESSION,\n        provider_type=\"vfs-memory\"\n    )\n\n    # Write files\n    await write_workspace_file(ws.namespace_id, \"/main.py\", b\"print('hello')\")\n    await write_workspace_file(ws.namespace_id, \"/README.md\", b\"# Project\\n\")\n\n    # Read files\n    code = await read_workspace_file(ws.namespace_id, \"/main.py\")\n\n    # Or use VFS directly for advanced operations\n    vfs = get_namespace_vfs(ws.namespace_id)\n    files = await vfs.list_directory(\"/\")\n\n    return f\"Workspace {project_name} created with {len(files)} files\"\n</code></pre>"},{"location":"guides/artifacts/#storage-scopes","title":"Storage Scopes","text":"<p>Artifacts can have different storage scopes:</p> Scope Description Use Case <code>StorageScope.SESSION</code> Scoped to the current MCP session (default) Temporary data for current session <code>StorageScope.USER</code> Scoped to the authenticated user User-specific persistent data <code>StorageScope.GLOBAL</code> Globally accessible Shared data (use with caution) <code>StorageScope.SANDBOX</code> Isolated sandbox Testing and isolation"},{"location":"guides/artifacts/#example-with-user-scope","title":"Example with User Scope","text":"<pre><code>from chuk_mcp_server import tool, require_user_id\nfrom chuk_artifacts import StorageScope\n\n@tool\nasync def save_user_file(filename: str, content: bytes) -&gt; str:\n    \"\"\"Save a file to the user's personal storage.\"\"\"\n    # Ensure user is authenticated\n    user_id = require_user_id()\n\n    # Create user-scoped workspace\n    ws = await create_workspace_namespace(\n        name=f\"user-{user_id}-files\",\n        scope=StorageScope.USER,\n        user_id=user_id\n    )\n\n    # Store file\n    await write_workspace_file(ws.namespace_id, f\"/{filename}\", content)\n\n    return f\"Saved {filename} to your personal storage\"\n</code></pre>"},{"location":"guides/artifacts/#storage-backends","title":"Storage Backends","text":"<p>The <code>chuk-artifacts</code> package supports multiple storage backends:</p> Backend Description Use Case <code>vfs-memory</code> In-memory storage Fast, ephemeral data <code>vfs-filesystem</code> Local filesystem Persistent local storage <code>vfs-s3</code> AWS S3 storage Cloud storage (requires <code>boto3</code>) <code>vfs-sqlite</code> SQLite-backed Embedded database storage"},{"location":"guides/artifacts/#example-filesystem-backend","title":"Example: Filesystem Backend","text":"<pre><code># Create workspace with filesystem backend\nws = await create_workspace_namespace(\n    name=\"my-project\",\n    provider_type=\"vfs-filesystem\",\n    provider_config={\"base_path\": \"/tmp/workspaces\"}\n)\n</code></pre>"},{"location":"guides/artifacts/#example-s3-backend","title":"Example: S3 Backend","text":"<pre><code># Create workspace with S3 backend\nws = await create_workspace_namespace(\n    name=\"cloud-project\",\n    provider_type=\"vfs-s3\",\n    provider_config={\n        \"bucket\": \"my-bucket\",\n        \"prefix\": \"workspaces/\"\n    }\n)\n</code></pre>"},{"location":"guides/artifacts/#api-reference","title":"API Reference","text":""},{"location":"guides/artifacts/#store-management","title":"Store Management","text":"Function Purpose Returns <code>get_artifact_store()</code> Get the current artifact store <code>ArtifactStore</code> (raises error if not set) <code>set_artifact_store(store)</code> Set artifact store for current context None <code>set_global_artifact_store(store)</code> Set global fallback store None <code>has_artifact_store()</code> Check if store is available <code>bool</code> <code>clear_artifact_store()</code> Clear store (useful for testing) None"},{"location":"guides/artifacts/#namespace-operations","title":"Namespace Operations","text":"Function Purpose Returns <code>create_blob_namespace(**kwargs)</code> Create blob namespace <code>NamespaceInfo</code> <code>create_workspace_namespace(name, **kwargs)</code> Create workspace namespace <code>NamespaceInfo</code>"},{"location":"guides/artifacts/#blob-operations","title":"Blob Operations","text":"Function Purpose Returns <code>write_blob(namespace_id, data, mime)</code> Write blob data None <code>read_blob(namespace_id)</code> Read blob data <code>bytes</code>"},{"location":"guides/artifacts/#workspace-operations","title":"Workspace Operations","text":"Function Purpose Returns <code>write_workspace_file(namespace_id, path, data)</code> Write file to workspace None <code>read_workspace_file(namespace_id, path)</code> Read file from workspace <code>bytes</code> <code>get_namespace_vfs(namespace_id)</code> Get VFS for workspace <code>AsyncVirtualFileSystem</code>"},{"location":"guides/artifacts/#advanced-usage","title":"Advanced Usage","text":""},{"location":"guides/artifacts/#vfs-operations","title":"VFS Operations","text":"<p>When you need more control, use the VFS directly:</p> <pre><code>vfs = get_namespace_vfs(workspace_id)\n\n# List files\nfiles = await vfs.list_directory(\"/\")\n\n# Check if file exists\nexists = await vfs.exists(\"/path/to/file\")\n\n# Create directory\nawait vfs.create_directory(\"/new/path\")\n\n# Delete file\nawait vfs.delete_file(\"/old/file\")\n\n# Read file metadata\ninfo = await vfs.get_file_info(\"/file\")\n</code></pre>"},{"location":"guides/artifacts/#testing-with-artifacts","title":"Testing with Artifacts","text":"<pre><code>import pytest\nfrom chuk_mcp_server import set_artifact_store, clear_artifact_store\nfrom chuk_artifacts import ArtifactStore\n\n@pytest.fixture\ndef artifact_store():\n    \"\"\"Provide a clean artifact store for each test.\"\"\"\n    store = ArtifactStore()\n    set_artifact_store(store)\n    yield store\n    clear_artifact_store()\n\nasync def test_workspace_creation(artifact_store):\n    \"\"\"Test workspace creation.\"\"\"\n    ws = await create_workspace_namespace(\n        name=\"test-workspace\",\n        scope=StorageScope.SANDBOX\n    )\n\n    assert ws.name == \"test-workspace\"\n    assert ws.type == NamespaceType.WORKSPACE\n</code></pre>"},{"location":"guides/artifacts/#best-practices","title":"Best Practices","text":"<ol> <li>Initialize Once: Set up the artifact store once at application startup</li> <li>Use Scopes Wisely: Choose appropriate scopes for your data</li> <li>SESSION for temporary data</li> <li>USER for personal data</li> <li>GLOBAL sparingly and with proper access control</li> <li>Clean Up: Clear artifacts when sessions end (if using SESSION scope)</li> <li>Choose Right Backend:</li> <li>Memory for ephemeral/test data</li> <li>Filesystem for local development</li> <li>S3 for production cloud deployments</li> <li>Handle Errors: Always handle potential errors from storage operations</li> </ol>"},{"location":"guides/artifacts/#related-documentation","title":"Related Documentation","text":"<ul> <li>chuk-artifacts Documentation - Full artifact package docs</li> <li>Context Management - Working with request context</li> <li>OAuth Integration - Setting up user authentication</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"guides/context-management/","title":"Context Management","text":"<p>Access request context in your tools and resources to track sessions, authenticate users, and manage request-specific data.</p>"},{"location":"guides/context-management/#overview","title":"Overview","text":"<p>ChukMCPServer provides context management for: - Session tracking: MCP session IDs for request correlation - User authentication: OAuth user IDs for authenticated requests - Request metadata: Custom data for advanced scenarios</p>"},{"location":"guides/context-management/#basic-context-access","title":"Basic Context Access","text":"<pre><code>from chuk_mcp_server import tool, get_session_id, get_user_id\n\n@tool\ndef get_current_context() -&gt; dict:\n    \"\"\"Get information about the current request.\"\"\"\n    session = get_session_id()  # MCP session ID (or None)\n    user = get_user_id()        # OAuth user ID (or None)\n\n    return {\n        \"session_id\": session,\n        \"user_id\": user,\n        \"authenticated\": user is not None\n    }\n</code></pre>"},{"location":"guides/context-management/#require-authentication","title":"Require Authentication","text":"<p>Use <code>require_user_id()</code> to enforce OAuth authentication:</p> <pre><code>from chuk_mcp_server import tool, require_user_id, requires_auth\n\n@tool\n@requires_auth()\nasync def create_private_resource(name: str) -&gt; dict:\n    \"\"\"Create a user-specific resource.\"\"\"\n    # This will raise PermissionError if user is not authenticated\n    user_id = require_user_id()\n\n    # Now safely use user_id for user-specific operations\n    return {\n        \"created\": name,\n        \"owner\": user_id,\n        \"private\": True\n    }\n</code></pre>"},{"location":"guides/context-management/#context-manager-pattern","title":"Context Manager Pattern","text":"<p>Set context manually for testing or advanced scenarios:</p> <pre><code>from chuk_mcp_server import RequestContext\n\nasync with RequestContext(\n    session_id=\"test-session\",\n    user_id=\"user-123\",\n    metadata={\"source\": \"test\"}\n):\n    # All tools called within this block will have this context\n    result = await my_tool()\n</code></pre>"},{"location":"guides/context-management/#available-context-functions","title":"Available Context Functions","text":"<pre><code>from chuk_mcp_server import (\n    get_session_id,      # Get current MCP session ID\n    set_session_id,      # Set MCP session ID\n    get_user_id,         # Get current OAuth user ID (returns None if not authenticated)\n    set_user_id,         # Set OAuth user ID\n    require_user_id,     # Get user ID or raise PermissionError\n    RequestContext,      # Context manager for manual control\n)\n</code></pre>"},{"location":"guides/context-management/#use-cases","title":"Use Cases","text":"Function Purpose When to Use <code>get_user_id()</code> Check if user is authenticated (optional) When authentication is optional <code>require_user_id()</code> Enforce authentication (raises error if not authenticated) When authentication is required <code>get_session_id()</code> Track requests per MCP session For session-based state management <code>RequestContext</code> Manual context control Testing, background tasks, manual control"},{"location":"guides/context-management/#examples","title":"Examples","text":""},{"location":"guides/context-management/#optional-authentication","title":"Optional Authentication","text":"<pre><code>@tool\ndef get_user_data() -&gt; dict:\n    \"\"\"Get user-specific or public data.\"\"\"\n    user_id = get_user_id()\n\n    if user_id:\n        # Return personalized data\n        return {\"data\": \"private\", \"user\": user_id}\n    else:\n        # Return public data\n        return {\"data\": \"public\"}\n</code></pre>"},{"location":"guides/context-management/#required-authentication","title":"Required Authentication","text":"<pre><code>@tool\n@requires_auth()\nasync def delete_account() -&gt; dict:\n    \"\"\"Delete the authenticated user's account.\"\"\"\n    user_id = require_user_id()  # Will raise PermissionError if not authenticated\n\n    # Proceed with deletion\n    await delete_user(user_id)\n\n    return {\"deleted\": user_id}\n</code></pre>"},{"location":"guides/context-management/#session-tracking","title":"Session Tracking","text":"<pre><code>@tool\ndef track_request() -&gt; dict:\n    \"\"\"Track requests by session.\"\"\"\n    session_id = get_session_id()\n\n    # Store or log request by session\n    log_request(session_id=session_id)\n\n    return {\"session\": session_id, \"tracked\": True}\n</code></pre>"},{"location":"guides/context-management/#testing-with-context","title":"Testing with Context","text":"<pre><code>import pytest\nfrom chuk_mcp_server import RequestContext, require_user_id\n\nasync def test_authenticated_tool():\n    \"\"\"Test tool with authentication.\"\"\"\n    async with RequestContext(user_id=\"test-user-123\"):\n        # Tool will see user_id as \"test-user-123\"\n        user_id = require_user_id()\n        assert user_id == \"test-user-123\"\n\nasync def test_unauthenticated_tool():\n    \"\"\"Test tool without authentication.\"\"\"\n    with pytest.raises(PermissionError):\n        # No context set, should raise error\n        require_user_id()\n</code></pre>"},{"location":"guides/context-management/#architecture","title":"Architecture","text":"<p>For details on how context management is implemented, see Context Architecture.</p>"},{"location":"guides/context-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>OAuth Integration - Setting up OAuth authentication</li> <li>Artifacts - Using context with artifact storage</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"oauth/api-reference/","title":"OAuth Types and Exports","text":"<p>Complete reference for OAuth types, classes, and functions exported from chuk-mcp-server.</p>"},{"location":"oauth/api-reference/#core-oauth-module","title":"Core OAuth Module","text":""},{"location":"oauth/api-reference/#importing-oauth-components","title":"Importing OAuth Components","text":"<pre><code># Import OAuth components from oauth module\nfrom chuk_mcp_server.oauth import (\n    OAuthMiddleware,          # OAuth middleware for MCP server\n    TokenStore,               # Session-based token storage\n    BaseOAuthProvider,        # Base class for OAuth providers\n    BaseTokenStore,           # Base class for token stores\n\n    # OAuth models\n    AuthorizationParams,      # Authorization request parameters\n    OAuthToken,               # OAuth token response\n    OAuthClientInfo,          # Client registration info\n\n    # OAuth errors\n    AuthorizeError,           # Authorization errors\n    TokenError,               # Token errors\n    RegistrationError,        # Client registration errors\n\n    # Helper functions\n    setup_google_drive_oauth,       # One-line Google Drive OAuth setup\n    configure_storage_from_oauth,   # Convert OAuth tokens to storage config\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauth-provider-types","title":"OAuth Provider Types","text":""},{"location":"oauth/api-reference/#baseoauthprovider","title":"BaseOAuthProvider","text":"<p>Abstract base class for implementing OAuth providers.</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider, AuthorizationParams, OAuthToken\n\nclass MyOAuthProvider(BaseOAuthProvider):\n    async def authorize(self, params: AuthorizationParams) -&gt; dict[str, Any]:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        ...\n\n    async def exchange_authorization_code(\n        self,\n        code: str,\n        client_id: str,\n        redirect_uri: str,\n        code_verifier: str | None = None,\n    ) -&gt; OAuthToken:\n        \"\"\"Exchange authorization code for access token.\"\"\"\n        ...\n\n    async def exchange_refresh_token(\n        self,\n        refresh_token: str,\n        client_id: str,\n        scope: str | None = None,\n    ) -&gt; OAuthToken:\n        \"\"\"Refresh access token.\"\"\"\n        ...\n\n    async def validate_access_token(self, token: str) -&gt; dict[str, Any]:\n        \"\"\"Validate and load access token.\"\"\"\n        ...\n\n    async def register_client(self, client_metadata: dict[str, Any]) -&gt; OAuthClientInfo:\n        \"\"\"Register a new MCP client.\"\"\"\n        ...\n\n    async def handle_external_callback(self, code: str, state: str) -&gt; dict[str, Any]:\n        \"\"\"Handle callback from external OAuth provider.\"\"\"\n        ...\n</code></pre>"},{"location":"oauth/api-reference/#google-drive-provider-optional","title":"Google Drive Provider (Optional)","text":"<p>Available when <code>google_drive</code> extra is installed.</p> <pre><code>from chuk_mcp_server.oauth.providers import (\n    GoogleDriveOAuthProvider,    # Google Drive OAuth provider\n    GoogleDriveOAuthClient,      # Google Drive OAuth client\n)\n\n# Create provider\nprovider = GoogleDriveOAuthProvider(\n    google_client_id=\"...\",\n    google_client_secret=\"...\",\n    google_redirect_uri=\"http://localhost:8000/oauth/callback\",\n    oauth_server_url=\"http://localhost:8000\",\n    sandbox_id=\"my-app\",\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauth-model-types","title":"OAuth Model Types","text":""},{"location":"oauth/api-reference/#authorizationparams","title":"AuthorizationParams","text":"<p>Parameters for OAuth authorization requests.</p> <pre><code>from chuk_mcp_server.oauth import AuthorizationParams\n\nparams = AuthorizationParams(\n    response_type: str,                           # \"code\"\n    client_id: str,                               # Client ID\n    redirect_uri: str,                            # Redirect URI\n    scope: str | None = None,                     # Requested scopes\n    state: str | None = None,                     # CSRF protection\n    code_challenge: str | None = None,            # PKCE challenge\n    code_challenge_method: Literal[\"S256\", \"plain\"] | None = None,\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauthtoken","title":"OAuthToken","text":"<p>OAuth token response.</p> <pre><code>from chuk_mcp_server.oauth import OAuthToken\n\ntoken = OAuthToken(\n    access_token: str,           # Access token\n    token_type: str,             # \"Bearer\"\n    expires_in: int,             # Expiration time in seconds\n    refresh_token: str | None,   # Refresh token (optional)\n    scope: str | None,           # Granted scopes (optional)\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauthclientinfo","title":"OAuthClientInfo","text":"<p>Client registration information.</p> <pre><code>from chuk_mcp_server.oauth import OAuthClientInfo\n\nclient_info = OAuthClientInfo(\n    client_id: str,              # Client ID\n    client_secret: str,          # Client secret\n    client_name: str,            # Client name\n    redirect_uris: list[str],    # Registered redirect URIs\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauth-error-types","title":"OAuth Error Types","text":""},{"location":"oauth/api-reference/#authorizeerror","title":"AuthorizeError","text":"<p>Raised during authorization flow.</p> <pre><code>from chuk_mcp_server.oauth import AuthorizeError\n\nraise AuthorizeError(\n    error: str,                  # Error code (\"invalid_client\", etc.)\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"oauth/api-reference/#tokenerror","title":"TokenError","text":"<p>Raised during token operations.</p> <pre><code>from chuk_mcp_server.oauth import TokenError\n\nraise TokenError(\n    error: str,                  # Error code (\"invalid_grant\", etc.)\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"oauth/api-reference/#registrationerror","title":"RegistrationError","text":"<p>Raised during client registration.</p> <pre><code>from chuk_mcp_server.oauth import RegistrationError\n\nraise RegistrationError(\n    error: str,                  # Error code\n    error_description: str,      # Human-readable description\n)\n</code></pre>"},{"location":"oauth/api-reference/#oauth-middleware","title":"OAuth Middleware","text":""},{"location":"oauth/api-reference/#oauthmiddleware","title":"OAuthMiddleware","text":"<p>Adds OAuth endpoints to MCP server.</p> <pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.oauth import OAuthMiddleware, BaseOAuthProvider\n\nmcp = ChukMCPServer(\"my-server\")\nprovider: BaseOAuthProvider = ...  # Your OAuth provider\n\noauth = OAuthMiddleware(\n    mcp_server=mcp,\n    provider=provider,\n    oauth_server_url: str = \"http://localhost:8000\",\n    callback_path: str = \"/oauth/callback\",\n    scopes_supported: list[str] | None = None,\n    service_documentation: str | None = None,\n    provider_name: str = \"OAuth Provider\",\n)\n</code></pre> <p>Automatically registers these endpoints: - <code>GET /.well-known/oauth-authorization-server</code> - OAuth metadata - <code>GET /.well-known/oauth-protected-resource</code> - Protected resource metadata - <code>GET /oauth/authorize</code> - Authorization endpoint - <code>POST /oauth/token</code> - Token endpoint - <code>POST /oauth/register</code> - Client registration - <code>GET /oauth/callback</code> - External provider callback</p>"},{"location":"oauth/api-reference/#token-storage","title":"Token Storage","text":""},{"location":"oauth/api-reference/#tokenstore","title":"TokenStore","text":"<p>Session-based token storage using chuk-sessions.</p> <pre><code>from chuk_mcp_server.oauth import TokenStore\n\nstore = TokenStore(sandbox_id: str = \"default\")\n\n# Client management\nawait store.register_client(client_name, redirect_uris)\nawait store.validate_client(client_id, redirect_uri)\n\n# Authorization codes\nawait store.create_authorization_code(\n    user_id, client_id, redirect_uri, scope,\n    code_challenge, code_challenge_method\n)\nawait store.validate_authorization_code(\n    code, client_id, redirect_uri, code_verifier\n)\n\n# Access tokens\nawait store.create_access_token(user_id, client_id, scope)\nawait store.validate_access_token(token)\nawait store.refresh_access_token(refresh_token)\n\n# External provider tokens\nawait store.link_external_token(\n    user_id, access_token, refresh_token, expires_in, provider\n)\nawait store.get_external_token(user_id, provider)\nawait store.is_external_token_expired(user_id, provider)\nawait store.update_external_token(\n    user_id, access_token, refresh_token, expires_in, provider\n)\n</code></pre>"},{"location":"oauth/api-reference/#helper-functions","title":"Helper Functions","text":""},{"location":"oauth/api-reference/#setup_google_drive_oauth","title":"setup_google_drive_oauth()","text":"<p>One-line Google Drive OAuth setup.</p> <pre><code>from chuk_mcp_server import get_mcp_server, run\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\n# Setup OAuth (reads from environment)\noauth_hook = setup_google_drive_oauth(\n    mcp_server=get_mcp_server(),\n    client_id: str | None = None,        # Or env: GOOGLE_CLIENT_ID\n    client_secret: str | None = None,    # Or env: GOOGLE_CLIENT_SECRET\n    redirect_uri: str | None = None,     # Or env: GOOGLE_REDIRECT_URI\n    oauth_server_url: str | None = None, # Or env: OAUTH_SERVER_URL\n    sandbox_id: str | None = None,       # Defaults to server name\n)\n\n# Run with OAuth\nrun(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre> <p>Returns <code>None</code> if credentials not configured, or a callable that creates OAuth middleware.</p>"},{"location":"oauth/api-reference/#configure_storage_from_oauth","title":"configure_storage_from_oauth()","text":"<p>Convert OAuth token data to storage credentials.</p> <pre><code>from chuk_mcp_server.oauth.helpers import configure_storage_from_oauth\n\n# Get token data from OAuth provider\ntoken_data = await oauth_provider.validate_access_token(access_token)\n\n# Convert to storage config\nstorage_config = configure_storage_from_oauth(token_data)\n\n# Returns:\n{\n    \"credentials\": {\n        \"token\": \"...\",\n        \"refresh_token\": \"...\",\n        \"token_uri\": \"https://oauth2.googleapis.com/token\",\n        \"client_id\": \"...\",\n        \"client_secret\": \"...\",\n        \"scopes\": [\"...\"],\n    },\n    \"root_folder\": \"CHUK\",\n    \"user_id\": \"user-123\",\n}\n</code></pre>"},{"location":"oauth/api-reference/#mcp-server-helper","title":"MCP Server Helper","text":""},{"location":"oauth/api-reference/#get_mcp_server","title":"get_mcp_server()","text":"<p>Get the global MCP server instance.</p> <pre><code>from chuk_mcp_server import get_mcp_server\n\n# Get global server instance\nserver = get_mcp_server()\n\n# Use with OAuth setup\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\noauth_hook = setup_google_drive_oauth(get_mcp_server())\n</code></pre>"},{"location":"oauth/api-reference/#type-checking","title":"Type Checking","text":"<p>All OAuth types are fully typed and support static type checking:</p> <pre><code>from typing import TYPE_CHECKING\n\nif TYPE_CHECKING:\n    from chuk_mcp_server.oauth import (\n        BaseOAuthProvider,\n        OAuthToken,\n        AuthorizationParams,\n        OAuthClientInfo,\n    )\n</code></pre>"},{"location":"oauth/api-reference/#complete-example","title":"Complete Example","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool, run, get_mcp_server\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\n# Create MCP server\nmcp = ChukMCPServer(\"my-app\")\n\n# Register tools\n@mcp.tool\ndef my_tool(data: str) -&gt; dict:\n    \"\"\"Example tool.\"\"\"\n    return {\"data\": data}\n\n# Setup Google Drive OAuth (one line!)\noauth_hook = setup_google_drive_oauth(get_mcp_server())\n\n# Run server with OAuth\nif __name__ == \"__main__\":\n    run(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre>"},{"location":"oauth/api-reference/#environment-variables","title":"Environment Variables","text":"<p>Required for <code>setup_google_drive_oauth()</code>: <pre><code>export GOOGLE_CLIENT_ID=\"...\"\nexport GOOGLE_CLIENT_SECRET=\"...\"\n</code></pre></p> <p>Optional (with defaults): <pre><code>export GOOGLE_REDIRECT_URI=\"http://localhost:8000/oauth/callback\"\nexport OAUTH_SERVER_URL=\"http://localhost:8000\"\nexport GOOGLE_DRIVE_ROOT_FOLDER=\"CHUK\"\n</code></pre></p>"},{"location":"oauth/api-reference/#see-also","title":"See Also","text":"<ul> <li>OAUTH.md - Complete OAuth implementation guide</li> <li>OAUTH_PROVIDERS.md - Provider documentation</li> <li>API Reference - Full API docs</li> </ul>"},{"location":"oauth/custom-providers/","title":"Custom OAuth Providers","text":"<p>Create your own OAuth provider to integrate with any service that supports OAuth 2.0/2.1.</p>"},{"location":"oauth/custom-providers/#overview","title":"Overview","text":"<p>Custom providers allow you to integrate with: - LinkedIn - GitHub - Dropbox - Slack - Any OAuth 2.0/2.1 compliant service</p>"},{"location":"oauth/custom-providers/#provider-structure","title":"Provider Structure","text":"<p>A custom provider implements <code>BaseOAuthProvider</code> and handles: 1. Authorization requests from MCP clients 2. Redirects to external OAuth provider 3. Callback from external provider 4. Token exchange and storage 5. Token refresh and validation</p>"},{"location":"oauth/custom-providers/#basic-provider","title":"Basic Provider","text":"<pre><code>from chuk_mcp_server.oauth import (\n    BaseOAuthProvider,\n    AuthorizationParams,\n    OAuthToken,\n    OAuthClientInfo,\n    TokenStore,\n)\nfrom typing import Any\nimport secrets\n\nclass MyServiceProvider(BaseOAuthProvider):\n    \"\"\"OAuth provider for MyService.\"\"\"\n\n    def __init__(\n        self,\n        client_id: str,\n        client_secret: str,\n        redirect_uri: str,\n        oauth_server_url: str = \"http://localhost:8000\",\n        sandbox_id: str = \"my-service\",\n    ):\n        self.oauth_server_url = oauth_server_url\n        self.token_store = TokenStore(sandbox_id=sandbox_id)\n\n        # Your service's OAuth client\n        self.service_client = MyServiceOAuthClient(\n            client_id=client_id,\n            client_secret=client_secret,\n            redirect_uri=redirect_uri,\n        )\n\n        self._pending_authorizations = {}\n\n    async def authorize(self, params: AuthorizationParams) -&gt; dict[str, Any]:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        # Validate MCP client\n        if not await self.token_store.validate_client(\n            params.client_id,\n            redirect_uri=params.redirect_uri,\n        ):\n            from chuk_mcp_server.oauth.models import AuthorizeError\n            raise AuthorizeError(\n                error=\"invalid_client\",\n                error_description=\"Invalid client_id or redirect_uri\",\n            )\n\n        # Generate state for OAuth flow\n        state = secrets.token_urlsafe(32)\n\n        self._pending_authorizations[state] = {\n            \"mcp_client_id\": params.client_id,\n            \"mcp_redirect_uri\": params.redirect_uri,\n            \"mcp_state\": params.state,\n            \"mcp_scope\": params.scope,\n            \"mcp_code_challenge\": params.code_challenge,\n            \"mcp_code_challenge_method\": params.code_challenge_method,\n        }\n\n        # Get authorization URL from your service\n        auth_url = self.service_client.get_authorization_url(state=state)\n\n        return {\n            \"authorization_url\": auth_url,\n            \"state\": state,\n            \"requires_external_authorization\": True,\n        }\n\n    async def handle_external_callback(\n        self, code: str, state: str\n    ) -&gt; dict[str, Any]:\n        \"\"\"Handle callback from external OAuth provider.\"\"\"\n        pending = self._pending_authorizations.get(state)\n        if not pending:\n            raise ValueError(\"Invalid or expired state parameter\")\n\n        # Exchange code for token at external service\n        service_token = await self.service_client.exchange_code_for_token(code)\n\n        # Get user info from external service\n        user_info = await self.service_client.get_user_info(\n            service_token[\"access_token\"]\n        )\n        user_id = user_info[\"id\"]\n\n        # Store external token\n        await self.token_store.link_external_token(\n            user_id=user_id,\n            access_token=service_token[\"access_token\"],\n            refresh_token=service_token.get(\"refresh_token\"),\n            expires_in=service_token.get(\"expires_in\", 3600),\n            provider=\"my-service\",\n        )\n\n        # Create MCP authorization code\n        mcp_code = await self.token_store.create_authorization_code(\n            user_id=user_id,\n            client_id=pending[\"mcp_client_id\"],\n            redirect_uri=pending[\"mcp_redirect_uri\"],\n            scope=pending[\"mcp_scope\"],\n            code_challenge=pending[\"mcp_code_challenge\"],\n            code_challenge_method=pending[\"mcp_code_challenge_method\"],\n        )\n\n        # Clean up\n        del self._pending_authorizations[state]\n\n        return {\n            \"code\": mcp_code,\n            \"state\": pending[\"mcp_state\"],\n            \"redirect_uri\": pending[\"mcp_redirect_uri\"],\n        }\n\n    async def exchange_authorization_code(\n        self,\n        code: str,\n        client_id: str,\n        redirect_uri: str,\n        code_verifier: str | None = None,\n    ) -&gt; OAuthToken:\n        \"\"\"Exchange authorization code for access token.\"\"\"\n        # Validate code\n        code_data = await self.token_store.validate_authorization_code(\n            code=code,\n            client_id=client_id,\n            redirect_uri=redirect_uri,\n            code_verifier=code_verifier,\n        )\n\n        if not code_data:\n            from chuk_mcp_server.oauth.models import TokenError\n            raise TokenError(\n                error=\"invalid_grant\",\n                error_description=\"Invalid authorization code\",\n            )\n\n        # Create tokens\n        access_token, refresh_token = await self.token_store.create_access_token(\n            user_id=code_data[\"user_id\"],\n            client_id=client_id,\n            scope=code_data[\"scope\"],\n        )\n\n        return OAuthToken(\n            access_token=access_token,\n            token_type=\"Bearer\",\n            expires_in=3600,\n            refresh_token=refresh_token,\n            scope=code_data[\"scope\"],\n        )\n\n    async def exchange_refresh_token(\n        self, refresh_token: str, client_id: str, scope: str | None = None\n    ) -&gt; OAuthToken:\n        \"\"\"Refresh an access token.\"\"\"\n        # Get refresh token data\n        token_data = await self.token_store.get_refresh_token_data(\n            refresh_token, client_id\n        )\n\n        if not token_data:\n            from chuk_mcp_server.oauth.models import TokenError\n            raise TokenError(error=\"invalid_grant\")\n\n        # Create new access token\n        access_token, new_refresh = await self.token_store.create_access_token(\n            user_id=token_data[\"user_id\"],\n            client_id=client_id,\n            scope=scope or token_data[\"scope\"],\n        )\n\n        return OAuthToken(\n            access_token=access_token,\n            token_type=\"Bearer\",\n            expires_in=3600,\n            refresh_token=new_refresh,\n        )\n\n    async def validate_access_token(self, access_token: str) -&gt; dict[str, Any]:\n        \"\"\"Validate an access token.\"\"\"\n        token_data = await self.token_store.validate_access_token(access_token)\n\n        if not token_data:\n            from chuk_mcp_server.oauth.models import TokenError\n            raise TokenError(error=\"invalid_token\")\n\n        # Get external token\n        external_token = await self.token_store.get_external_token(\n            token_data[\"user_id\"], \"my-service\"\n        )\n\n        # Refresh if expired\n        if await self.token_store.is_external_token_expired(\n            token_data[\"user_id\"], \"my-service\"\n        ):\n            if external_token.get(\"refresh_token\"):\n                new_token = await self.service_client.refresh_access_token(\n                    external_token[\"refresh_token\"]\n                )\n                await self.token_store.update_external_token(\n                    token_data[\"user_id\"],\n                    \"my-service\",\n                    new_token[\"access_token\"],\n                    new_token.get(\"expires_in\", 3600),\n                )\n                external_token = new_token\n\n        return {\n            **token_data,\n            \"external_access_token\": external_token[\"access_token\"],\n        }\n\n    async def register_client(\n        self, client_metadata: dict[str, Any]\n    ) -&gt; OAuthClientInfo:\n        \"\"\"Register a new MCP client.\"\"\"\n        client_id, client_secret = await self.token_store.register_client(\n            client_name=client_metadata.get(\"client_name\", \"Unknown\"),\n            redirect_uris=client_metadata.get(\"redirect_uris\", []),\n        )\n\n        return OAuthClientInfo(\n            client_id=client_id,\n            client_secret=client_secret,\n            client_name=client_metadata.get(\"client_name\", \"Unknown\"),\n            redirect_uris=client_metadata.get(\"redirect_uris\", []),\n        )\n</code></pre>"},{"location":"oauth/custom-providers/#service-oauth-client","title":"Service OAuth Client","text":"<p>You also need a client for the external service:</p> <pre><code>import httpx\nfrom typing import Any\n\nclass MyServiceOAuthClient:\n    \"\"\"OAuth client for MyService API.\"\"\"\n\n    def __init__(self, client_id: str, client_secret: str, redirect_uri: str):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.redirect_uri = redirect_uri\n\n    def get_authorization_url(self, state: str) -&gt; str:\n        \"\"\"Generate authorization URL.\"\"\"\n        from urllib.parse import urlencode\n\n        params = {\n            \"client_id\": self.client_id,\n            \"redirect_uri\": self.redirect_uri,\n            \"response_type\": \"code\",\n            \"state\": state,\n            \"scope\": \"read write\",  # Your service's scopes\n        }\n\n        return f\"https://myservice.com/oauth/authorize?{urlencode(params)}\"\n\n    async def exchange_code_for_token(self, code: str) -&gt; dict[str, Any]:\n        \"\"\"Exchange authorization code for access token.\"\"\"\n        async with httpx.AsyncClient() as client:\n            response = await client.post(\n                \"https://myservice.com/oauth/token\",\n                data={\n                    \"grant_type\": \"authorization_code\",\n                    \"code\": code,\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"redirect_uri\": self.redirect_uri,\n                },\n            )\n            response.raise_for_status()\n            result: dict[str, Any] = response.json()\n            return result\n\n    async def refresh_access_token(self, refresh_token: str) -&gt; dict[str, Any]:\n        \"\"\"Refresh an access token.\"\"\"\n        async with httpx.AsyncClient() as client:\n            response = await client.post(\n                \"https://myservice.com/oauth/token\",\n                data={\n                    \"grant_type\": \"refresh_token\",\n                    \"refresh_token\": refresh_token,\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                },\n            )\n            response.raise_for_status()\n            result: dict[str, Any] = response.json()\n            return result\n\n    async def get_user_info(self, access_token: str) -&gt; dict[str, Any]:\n        \"\"\"Get user information.\"\"\"\n        async with httpx.AsyncClient() as client:\n            response = await client.get(\n                \"https://myservice.com/api/v1/user\",\n                headers={\"Authorization\": f\"Bearer {access_token}\"},\n            )\n            response.raise_for_status()\n            result: dict[str, Any] = response.json()\n            return result\n</code></pre>"},{"location":"oauth/custom-providers/#using-your-provider","title":"Using Your Provider","text":"<pre><code>from chuk_mcp_server import ChukMCPServer\nfrom chuk_mcp_server.oauth import OAuthMiddleware\nfrom my_provider import MyServiceProvider\n\nmcp = ChukMCPServer(\"my-app\")\n\ndef setup_oauth():\n    provider = MyServiceProvider(\n        client_id=\"your-client-id\",\n        client_secret=\"your-client-secret\",\n        redirect_uri=\"http://localhost:8000/oauth/callback\",\n        oauth_server_url=\"http://localhost:8000\",\n    )\n\n    return OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        scopes_supported=[\"read\", \"write\"],\n        provider_name=\"My Service\",\n    )\n\nmcp.run(transport=\"http\", port=8000, post_register_hook=setup_oauth)\n</code></pre>"},{"location":"oauth/custom-providers/#real-world-examples","title":"Real-World Examples","text":""},{"location":"oauth/custom-providers/#linkedin-provider","title":"LinkedIn Provider","text":"<p>See chuk-mcp-linkedin for a complete implementation.</p>"},{"location":"oauth/custom-providers/#key-features","title":"Key Features","text":"<ul> <li>Token refresh handling</li> <li>User profile access</li> <li>Post publishing</li> <li>Connection management</li> </ul>"},{"location":"oauth/custom-providers/#next-steps","title":"Next Steps","text":"<ul> <li>Protected Tools - Use your provider with tools</li> <li>Token Management - Understand token lifecycle</li> <li>Google Drive Provider - Reference implementation</li> </ul>"},{"location":"oauth/google-drive/","title":"OAuth Providers","text":"<p>ChukMCPServer provides pluggable OAuth providers that can be reused across different MCP servers. Instead of implementing OAuth from scratch for each service, you can use pre-built providers or create your own.</p>"},{"location":"oauth/google-drive/#available-providers","title":"Available Providers","text":""},{"location":"oauth/google-drive/#google-drive-provider","title":"Google Drive Provider","text":"<p>OAuth 2.1 integration with Google Drive API, providing secure access to user's Google Drive storage.</p> <p>Installation:</p> <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre> <p>Quick Setup (Using Helper):</p> <pre><code>from chuk_mcp_server import ChukMCPServer, run\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\nmcp = ChukMCPServer(\"my-server\")\n\n# ... register your tools ...\n\n# Setup Google Drive OAuth (reads from environment variables)\noauth_hook = setup_google_drive_oauth(mcp)\n\n# Run server with OAuth\nrun(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre> <p>Environment Variables:</p> <pre><code># Required\nexport GOOGLE_CLIENT_ID=\"your-client-id.apps.googleusercontent.com\"\nexport GOOGLE_CLIENT_SECRET=\"your-client-secret\"\n\n# Optional (with defaults)\nexport GOOGLE_REDIRECT_URI=\"http://localhost:8000/oauth/callback\"\nexport OAUTH_SERVER_URL=\"http://localhost:8000\"\nexport GOOGLE_DRIVE_ROOT_FOLDER=\"CHUK\"  # Folder in user's Drive\n</code></pre> <p>Manual Setup (Full Control):</p> <pre><code>from chuk_mcp_server import ChukMCPServer, run\nfrom chuk_mcp_server.oauth import OAuthMiddleware\nfrom chuk_mcp_server.oauth.providers import GoogleDriveOAuthProvider\n\nmcp = ChukMCPServer(\"my-server\")\n\ndef setup_oauth():\n    \"\"\"Set up Google Drive OAuth.\"\"\"\n    provider = GoogleDriveOAuthProvider(\n        google_client_id=\"your-client-id\",\n        google_client_secret=\"your-client-secret\",\n        google_redirect_uri=\"http://localhost:8000/oauth/callback\",\n        oauth_server_url=\"http://localhost:8000\",\n        sandbox_id=\"my-server-sandbox\",\n    )\n\n    oauth = OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        callback_path=\"/oauth/callback\",\n        scopes_supported=[\"drive.file\", \"userinfo.profile\"],\n        service_documentation=\"https://github.com/yourusername/my-server\",\n        provider_name=\"Google Drive\",\n    )\n\n    return oauth\n\nrun(transport=\"http\", port=8000, post_register_hook=setup_oauth)\n</code></pre> <p>Accessing Google Drive from Tools:</p> <pre><code>from chuk_mcp_server.oauth.helpers import configure_storage_from_oauth\nfrom chuk_virtual_fs.providers import GoogleDriveProvider\n\n# In your tool that requires authentication\n@tool\nasync def my_tool():\n    \"\"\"Tool that needs Google Drive access.\"\"\"\n    # Get token from request context (automatically injected by OAuth middleware)\n    access_token = get_access_token()  # From your request context\n\n    # Validate token and get user credentials\n    token_data = await oauth_provider.validate_access_token(access_token)\n\n    # Configure storage from OAuth token\n    storage_config = configure_storage_from_oauth(token_data)\n\n    # Create Google Drive provider\n    drive = GoogleDriveProvider(\n        credentials=storage_config[\"credentials\"],\n        root_folder=storage_config[\"root_folder\"],\n    )\n\n    await drive.initialize()\n\n    # Use Google Drive...\n    await drive.write_file(\"/myfile.txt\", b\"content\")\n</code></pre> <p>How It Works:</p> <ol> <li>Two-Layer Authentication:</li> <li>MCP Layer: Claude Desktop \u2194 Your MCP Server (OAuth tokens)</li> <li> <p>Google Layer: Your MCP Server \u2194 Google Drive (Google tokens)</p> </li> <li> <p>Token Management:</p> </li> <li>MCP client gets short-lived access tokens (15 min) and refresh tokens (1 day)</li> <li>Google Drive tokens stored server-side, auto-refreshed when expired</li> <li> <p>User only authorizes once via browser</p> </li> <li> <p>OAuth Flow: <pre><code>Claude Desktop \u2192 /oauth/authorize \u2192 Redirect to Google\nUser authorizes on Google \u2192 Google callback \u2192 Token exchange\nServer stores Google token \u2192 Returns MCP auth code \u2192 Claude gets access token\n</code></pre></p> </li> </ol> <p>Creating Google OAuth Credentials:</p> <ol> <li>Go to https://console.cloud.google.com/</li> <li>Create project (or select existing)</li> <li>Enable Google Drive API</li> <li>OAuth consent screen:</li> <li>User Type: External</li> <li>Add test users</li> <li>Credentials \u2192 Create OAuth 2.0 Client ID:</li> <li>Application type: Web application</li> <li>Authorized redirect URIs: <code>http://localhost:8000/oauth/callback</code></li> <li>Copy Client ID and Client Secret</li> </ol>"},{"location":"oauth/google-drive/#creating-custom-providers","title":"Creating Custom Providers","text":"<p>You can create your own OAuth provider for any service (GitHub, LinkedIn, Dropbox, etc.).</p> <p>Example: Custom Provider</p> <pre><code>from chuk_mcp_server.oauth import (\n    BaseOAuthProvider,\n    AuthorizationParams,\n    OAuthToken,\n    OAuthClientInfo,\n    TokenStore,\n)\n\nclass MyServiceOAuthProvider(BaseOAuthProvider):\n    \"\"\"OAuth provider for MyService.\"\"\"\n\n    def __init__(\n        self,\n        service_client_id: str,\n        service_client_secret: str,\n        service_redirect_uri: str,\n        oauth_server_url: str = \"http://localhost:8000\",\n        sandbox_id: str = \"my-service\",\n    ):\n        self.oauth_server_url = oauth_server_url\n        self.token_store = TokenStore(sandbox_id=sandbox_id)\n\n        # Initialize your service's OAuth client\n        self.service_client = MyServiceOAuthClient(\n            client_id=service_client_id,\n            client_secret=service_client_secret,\n            redirect_uri=service_redirect_uri,\n        )\n\n        self._pending_authorizations = {}\n\n    async def authorize(self, params: AuthorizationParams) -&gt; dict:\n        \"\"\"Handle authorization request from MCP client.\"\"\"\n        # Validate MCP client\n        if not await self.token_store.validate_client(\n            params.client_id,\n            redirect_uri=params.redirect_uri,\n        ):\n            raise AuthorizeError(\n                error=\"invalid_client\",\n                error_description=\"Invalid client_id or redirect_uri\",\n            )\n\n        # Check if user has external token\n        # ... (similar to Google Drive provider)\n\n        # Need external authorization - redirect to your service\n        import secrets\n        state = secrets.token_urlsafe(32)\n\n        self._pending_authorizations[state] = {\n            \"mcp_client_id\": params.client_id,\n            \"mcp_redirect_uri\": params.redirect_uri,\n            \"mcp_state\": params.state,\n            \"mcp_scope\": params.scope,\n            \"mcp_code_challenge\": params.code_challenge,\n            \"mcp_code_challenge_method\": params.code_challenge_method,\n        }\n\n        auth_url = self.service_client.get_authorization_url(state=state)\n\n        return {\n            \"authorization_url\": auth_url,\n            \"state\": state,\n            \"requires_external_authorization\": True,\n        }\n\n    async def handle_external_callback(self, code: str, state: str) -&gt; dict:\n        \"\"\"Handle callback from external service.\"\"\"\n        pending = self._pending_authorizations.get(state)\n        if not pending:\n            raise ValueError(\"Invalid or expired state parameter\")\n\n        # Exchange service code for token\n        service_token = await self.service_client.exchange_code_for_token(code)\n\n        # Get user info\n        user_info = await self.service_client.get_user_info(\n            service_token[\"access_token\"]\n        )\n        user_id = user_info[\"id\"]  # Or \"sub\" for OIDC\n\n        # Store service token\n        await self.token_store.link_external_token(\n            user_id=user_id,\n            access_token=service_token[\"access_token\"],\n            refresh_token=service_token.get(\"refresh_token\"),\n            expires_in=service_token.get(\"expires_in\", 3600),\n            provider=\"my-service\",\n        )\n\n        # Create MCP authorization code\n        mcp_code = await self.token_store.create_authorization_code(\n            user_id=user_id,\n            client_id=pending[\"mcp_client_id\"],\n            redirect_uri=pending[\"mcp_redirect_uri\"],\n            scope=pending[\"mcp_scope\"],\n            code_challenge=pending[\"mcp_code_challenge\"],\n            code_challenge_method=pending[\"mcp_code_challenge_method\"],\n        )\n\n        del self._pending_authorizations[state]\n\n        return {\n            \"code\": mcp_code,\n            \"state\": pending[\"mcp_state\"],\n            \"redirect_uri\": pending[\"mcp_redirect_uri\"],\n        }\n\n    # Implement other required methods:\n    # - exchange_authorization_code\n    # - exchange_refresh_token\n    # - validate_access_token\n    # - register_client\n</code></pre> <p>See OAUTH.md for complete OAuth implementation guide.</p>"},{"location":"oauth/google-drive/#examples","title":"Examples","text":"<p>chuk-mcp-stage: Uses Google Drive provider for persistent scene storage - See: https://github.com/chrishayuk/chuk-mcp-stage</p> <p>chuk-mcp-linkedin: Uses custom LinkedIn provider for profile/post access - See: https://github.com/chrishayuk/chuk-mcp-linkedin</p>"},{"location":"oauth/google-drive/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Use PKCE - Always require code_challenge for public clients</li> <li>Validate Redirect URIs - Only allow registered redirect URIs</li> <li>Short-Lived Tokens - MCP access tokens expire in 15 minutes</li> <li>Auto-Refresh - External provider tokens refreshed automatically</li> <li>Sandbox Isolation - Use unique sandbox IDs for multi-tenancy</li> <li>Environment Variables - Never hardcode credentials</li> <li>HTTPS in Production - Use HTTPS for all OAuth endpoints</li> </ol>"},{"location":"oauth/google-drive/#troubleshooting","title":"Troubleshooting","text":"<p>OAuth provider not loading: <pre><code>ImportError: cannot import name 'GoogleDriveOAuthProvider'\n</code></pre> Fix: Install the google_drive extra: <pre><code>pip install chuk-mcp-server[google_drive]\n</code></pre></p> <p>Browser doesn't open during OAuth flow: - OAuth only works in HTTP mode (not STDIO) - Run server with: <code>uv run my-server http</code> - Check that port 8000 is not blocked</p> <p>Invalid redirect URI error: - Ensure redirect URI in Google Cloud Console matches exactly - Should be: <code>http://localhost:8000/oauth/callback</code> - Protocol (http vs https) must match</p> <p>Token expired errors: - Tokens auto-refresh, but may need manual re-authorization - Check server logs for refresh errors - User may need to re-authorize via browser</p>"},{"location":"oauth/google-drive/#license","title":"License","text":"<p>MIT - See LICENSE</p>"},{"location":"oauth/overview/","title":"OAuth &amp; Authentication","text":"<p>ChukMCPServer provides full OAuth 2.1 support with PKCE, automatic token management, and RFC-compliant endpoints. Perfect for building authenticated MCP servers that integrate with LinkedIn, GitHub, Google, and other OAuth providers.</p>"},{"location":"oauth/overview/#what-is-oauth-in-mcp","title":"What is OAuth in MCP?","text":"<p>OAuth allows your MCP server to:</p> <ul> <li>Authenticate users before they can use tools</li> <li>Access external APIs on behalf of users</li> <li>Implement fine-grained permissions with scopes</li> <li>Securely manage user sessions and tokens</li> </ul>"},{"location":"oauth/overview/#quick-start","title":"Quick Start","text":""},{"location":"oauth/overview/#protected-tools","title":"Protected Tools","text":"<p>Mark tools as requiring authentication:</p> <pre><code>from chuk_mcp_server import ChukMCPServer, tool, requires_auth\n\nmcp = ChukMCPServer(\"my-oauth-server\")\n\n@mcp.tool\n@requires_auth()\nasync def publish_post(\n    content: str,\n    visibility: str = \"PUBLIC\",\n    _external_access_token: str | None = None\n) -&gt; dict:\n    \"\"\"Publish content using external OAuth provider.\"\"\"\n    # Token is automatically validated and injected\n    import httpx\n\n    headers = {\"Authorization\": f\"Bearer {_external_access_token}\"}\n    async with httpx.AsyncClient() as client:\n        response = await client.post(\n            \"https://api.example.com/v1/posts\",\n            headers=headers,\n            json={\"content\": content, \"visibility\": visibility}\n        )\n        return response.json()\n</code></pre>"},{"location":"oauth/overview/#setup-oauth-middleware","title":"Setup OAuth Middleware","text":"<pre><code>from chuk_mcp_server.oauth import OAuthMiddleware\nfrom my_provider import MyOAuthProvider\n\ndef setup_oauth():\n    provider = MyOAuthProvider(\n        client_id=\"your_client_id\",\n        client_secret=\"your_client_secret\",\n        redirect_uri=\"http://localhost:8000/oauth/callback\"\n    )\n\n    return OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        scopes_supported=[\"posts.write\", \"profile.read\"],\n        provider_name=\"My Service\"\n    )\n\nif __name__ == \"__main__\":\n    mcp.run(host=\"0.0.0.0\", port=8000, post_register_hook=setup_oauth)\n</code></pre>"},{"location":"oauth/overview/#oauth-features","title":"OAuth Features","text":""},{"location":"oauth/overview/#standards-compliance","title":"Standards Compliance","text":"<ul> <li>OAuth 2.1 - Latest OAuth standard with security improvements</li> <li>PKCE - RFC 7636 - Proof Key for Code Exchange</li> <li>Authorization Server Discovery - RFC 8414</li> <li>Protected Resource Metadata - RFC 9728</li> <li>JWT Access Tokens - RFC 9068</li> <li>Dynamic Client Registration - RFC 7591</li> </ul>"},{"location":"oauth/overview/#built-in-features","title":"Built-In Features","text":"<ul> <li>\u2705 Automatic token refresh</li> <li>\u2705 Token validation</li> <li>\u2705 Scope-based access control</li> <li>\u2705 Multi-tenant support with sandbox isolation</li> <li>\u2705 Session management</li> <li>\u2705 Redis backend for production</li> </ul>"},{"location":"oauth/overview/#oauth-endpoints","title":"OAuth Endpoints","text":"<p>When you enable OAuth, these endpoints are automatically registered:</p>"},{"location":"oauth/overview/#discovery-endpoints","title":"Discovery Endpoints","text":"<pre><code># Authorization Server Discovery (RFC 8414)\nGET /.well-known/oauth-authorization-server\n\n# Protected Resource Metadata (RFC 9728)\nGET /.well-known/oauth-protected-resource\n</code></pre>"},{"location":"oauth/overview/#oauth-flow-endpoints","title":"OAuth Flow Endpoints","text":"<pre><code># Authorization - Start OAuth flow\nGET /oauth/authorize?client_id={id}&amp;redirect_uri={uri}&amp;response_type=code&amp;code_challenge={challenge}&amp;code_challenge_method=S256\n\n# Token - Exchange code for access token\nPOST /oauth/token\nContent-Type: application/x-www-form-urlencoded\ngrant_type=authorization_code&amp;code={code}&amp;client_id={id}&amp;redirect_uri={uri}&amp;code_verifier={verifier}\n\n# Client Registration (RFC 7591)\nPOST /oauth/register\nContent-Type: application/json\n{\"client_name\": \"My Client\", \"redirect_uris\": [\"http://localhost:8080/callback\"]}\n\n# External Provider Callback\nGET /oauth/callback?code={code}&amp;state={state}\n</code></pre>"},{"location":"oauth/overview/#how-it-works","title":"How It Works","text":""},{"location":"oauth/overview/#two-layer-authentication","title":"Two-Layer Authentication","text":"<p>ChukMCPServer uses a two-layer OAuth architecture:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       OAuth        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      OAuth       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Claude    \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u2502 Your MCP     \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u2502  External   \u2502\n\u2502  Desktop    \u2502   (MCP Layer)       \u2502   Server     \u2502  (Provider Layer)\u2502  Provider   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     MCP Client                      OAuth Server                      (Google, etc.)\n</code></pre> <p>Layer 1 - MCP Layer: Claude Desktop \u2194 Your MCP Server - Short-lived access tokens (15 min default) - Refresh tokens (1 day default) - MCP client authentication</p> <p>Layer 2 - Provider Layer: Your MCP Server \u2194 External Service - External provider tokens (Google, LinkedIn, etc.) - Stored server-side - Auto-refreshed when expired</p>"},{"location":"oauth/overview/#oauth-flow","title":"OAuth Flow","text":"<ol> <li> <p>MCP Client Requests Authorization <pre><code>Claude Desktop \u2192 /oauth/authorize \u2192 MCP Server\n</code></pre></p> </li> <li> <p>Redirect to External Provider <pre><code>MCP Server \u2192 Redirect \u2192 Google/LinkedIn/etc.\n</code></pre></p> </li> <li> <p>User Authorizes <pre><code>User logs in and grants permissions\n</code></pre></p> </li> <li> <p>Callback &amp; Token Exchange <pre><code>Provider \u2192 /oauth/callback \u2192 MCP Server\nMCP Server stores external token\n</code></pre></p> </li> <li> <p>Return MCP Auth Code <pre><code>MCP Server \u2192 auth code \u2192 Claude Desktop\n</code></pre></p> </li> <li> <p>Exchange for Access Token <pre><code>Claude Desktop \u2192 /oauth/token \u2192 MCP Server\nMCP Server \u2192 access token + refresh token\n</code></pre></p> </li> <li> <p>Use Protected Tools <pre><code>Claude calls tools with access token\nServer validates token and injects external token\n</code></pre></p> </li> </ol>"},{"location":"oauth/overview/#using-oauth-providers","title":"Using OAuth Providers","text":""},{"location":"oauth/overview/#built-in-providers","title":"Built-In Providers","text":"<p>ChukMCPServer includes ready-to-use providers:</p> Google DriveCustom Provider <pre><code>from chuk_mcp_server import get_mcp_server, run\nfrom chuk_mcp_server.oauth.helpers import setup_google_drive_oauth\n\n# One line to add Google Drive OAuth!\noauth_hook = setup_google_drive_oauth(get_mcp_server())\n\nrun(transport=\"http\", port=8000, post_register_hook=oauth_hook)\n</code></pre> <p>See Google Drive Provider for complete guide.</p> <pre><code>from chuk_mcp_server.oauth import BaseOAuthProvider\n\nclass MyOAuthProvider(BaseOAuthProvider):\n    # Implement required methods\n    async def authorize(self, params):\n        ...\n\n    async def exchange_authorization_code(self, code, ...):\n        ...\n</code></pre> <p>See Custom Providers for implementation guide.</p>"},{"location":"oauth/overview/#token-management","title":"Token Management","text":""},{"location":"oauth/overview/#token-storage","title":"Token Storage","text":"<p>ChukMCPServer uses a flexible token storage system:</p> <p>Development (Memory Backend) <pre><code># Zero configuration - works out of the box\nfrom chuk_mcp_server.oauth import TokenStore\n\ntoken_store = TokenStore(sandbox_id=\"my-app\")\n</code></pre></p> <p>Production (Redis Backend) <pre><code># Set environment variables\nimport os\nos.environ[\"SESSION_PROVIDER\"] = \"redis\"\nos.environ[\"SESSION_REDIS_URL\"] = \"redis://localhost:6379/0\"\n\n# TokenStore automatically uses Redis\ntoken_store = TokenStore(sandbox_id=\"my-app\")\n</code></pre></p>"},{"location":"oauth/overview/#token-lifecycle","title":"Token Lifecycle","text":"<p>Configure token TTLs via environment variables:</p> <pre><code># Authorization codes - temporary codes for token exchange\nexport OAUTH_AUTH_CODE_TTL=600              # 10 minutes (default)\n\n# Access tokens - short-lived tokens for API calls\nexport OAUTH_ACCESS_TOKEN_TTL=900           # 15 minutes (default)\n\n# Refresh tokens - used to get new access tokens\nexport OAUTH_REFRESH_TOKEN_TTL=86400        # 1 day (default)\n\n# Client registrations - how long registered clients remain valid\nexport OAUTH_CLIENT_REGISTRATION_TTL=31536000  # 1 year (default)\n\n# External tokens - tokens from external providers (auto-refreshed)\nexport OAUTH_EXTERNAL_TOKEN_TTL=5184000     # 60 days (default)\n</code></pre>"},{"location":"oauth/overview/#security-best-practices","title":"Security Best Practices","text":""},{"location":"oauth/overview/#1-use-pkce","title":"1. Use PKCE","text":"<p>Always require PKCE for public clients:</p> <pre><code>oauth = OAuthMiddleware(\n    mcp_server=mcp,\n    provider=provider,\n    # PKCE is enabled by default\n)\n</code></pre>"},{"location":"oauth/overview/#2-validate-redirect-uris","title":"2. Validate Redirect URIs","text":"<p>Only allow registered redirect URIs:</p> <pre><code>class MyOAuthProvider(BaseOAuthProvider):\n    async def authorize(self, params):\n        # Validate redirect_uri is registered\n        if not await self.token_store.validate_client(\n            params.client_id,\n            redirect_uri=params.redirect_uri\n        ):\n            raise AuthorizeError(\"invalid_client\")\n</code></pre>"},{"location":"oauth/overview/#3-short-lived-tokens","title":"3. Short-Lived Tokens","text":"<p>Use short TTLs for access tokens:</p> <pre><code>export OAUTH_ACCESS_TOKEN_TTL=900  # 15 minutes\n</code></pre>"},{"location":"oauth/overview/#4-environment-variables","title":"4. Environment Variables","text":"<p>Never hardcode credentials:</p> <pre><code>import os\n\nprovider = MyOAuthProvider(\n    client_id=os.getenv(\"OAUTH_CLIENT_ID\"),\n    client_secret=os.getenv(\"OAUTH_CLIENT_SECRET\"),\n    redirect_uri=os.getenv(\"OAUTH_REDIRECT_URI\")\n)\n</code></pre>"},{"location":"oauth/overview/#5-https-in-production","title":"5. HTTPS in Production","text":"<p>Use HTTPS for all OAuth endpoints:</p> <pre><code>if __name__ == \"__main__\":\n    mcp.run(\n        host=\"0.0.0.0\",\n        port=443,  # HTTPS port\n        ssl_certfile=\"/path/to/cert.pem\",\n        ssl_keyfile=\"/path/to/key.pem\",\n        post_register_hook=setup_oauth\n    )\n</code></pre>"},{"location":"oauth/overview/#6-sandbox-isolation","title":"6. Sandbox Isolation","text":"<p>Use unique sandbox IDs for multi-tenancy:</p> <pre><code>token_store = TokenStore(\n    sandbox_id=f\"app-{tenant_id}\"  # Isolate by tenant\n)\n</code></pre>"},{"location":"oauth/overview/#examples","title":"Examples","text":""},{"location":"oauth/overview/#linkedin-integration","title":"LinkedIn Integration","text":"<p>See chuk-mcp-linkedin for a complete LinkedIn OAuth implementation.</p>"},{"location":"oauth/overview/#google-drive-integration","title":"Google Drive Integration","text":"<p>See chuk-mcp-stage for Google Drive OAuth with file storage.</p>"},{"location":"oauth/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Google Drive Provider - Ready-to-use Google Drive OAuth</li> <li>Custom Providers - Build your own OAuth provider</li> <li>Protected Tools - Using <code>@requires_auth</code></li> <li>Token Management - Deep dive into token lifecycle</li> <li>API Reference - Complete OAuth API docs</li> </ul>"},{"location":"oauth/overview/#troubleshooting","title":"Troubleshooting","text":""},{"location":"oauth/overview/#oauth-not-working-in-stdio-mode","title":"OAuth not working in STDIO mode?","text":"<p>OAuth requires HTTP transport (browser-based flow):</p> <pre><code>mcp.run(transport=\"http\", port=8000, post_register_hook=setup_oauth)\n</code></pre>"},{"location":"oauth/overview/#tokens-expiring-too-quickly","title":"Tokens expiring too quickly?","text":"<p>Adjust TTLs:</p> <pre><code>export OAUTH_ACCESS_TOKEN_TTL=3600  # 1 hour\nexport OAUTH_REFRESH_TOKEN_TTL=604800  # 7 days\n</code></pre>"},{"location":"oauth/overview/#redis-connection-errors","title":"Redis connection errors?","text":"<p>Check Redis is running and URL is correct:</p> <pre><code>redis-cli ping  # Should return PONG\nexport SESSION_REDIS_URL=\"redis://localhost:6379/0\"\n</code></pre>"},{"location":"oauth/overview/#external-provider-callback-not-working","title":"External provider callback not working?","text":"<p>Verify redirect URI matches exactly:</p> <pre><code># Must match what's registered with provider\nredirect_uri=\"http://localhost:8000/oauth/callback\"  # Exact match!\n</code></pre>"},{"location":"oauth/protected-tools/","title":"Protected Tools","text":"<p>Use the <code>@requires_auth</code> decorator to create tools that require OAuth authentication.</p>"},{"location":"oauth/protected-tools/#basic-protected-tool","title":"Basic Protected Tool","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, tool, requires_auth\n\nmcp = ChukMCPServer(\"my-app\")\n\n@mcp.tool\n@requires_auth()\nasync def publish_post(\n    content: str,\n    _external_access_token: str | None = None\n) -&gt; dict:\n    \"\"\"Publish a post (requires authentication).\"\"\"\n    import httpx\n\n    headers = {\"Authorization\": f\"Bearer {_external_access_token}\"}\n    async with httpx.AsyncClient() as client:\n        response = await client.post(\n            \"https://api.example.com/posts\",\n            headers=headers,\n            json={\"content\": content}\n        )\n        return response.json()\n</code></pre>"},{"location":"oauth/protected-tools/#how-it-works","title":"How It Works","text":"<ol> <li>User calls tool from Claude</li> <li>MCP server validates OAuth token</li> <li>External access token is injected into <code>_external_access_token</code></li> <li>Tool uses token to call external API</li> </ol>"},{"location":"oauth/protected-tools/#token-injection","title":"Token Injection","text":"<p>The <code>_external_access_token</code> parameter is special: - Always optional (<code>str | None</code>) - Automatically injected by OAuth middleware - Contains the external provider's access token</p> <pre><code>@mcp.tool\n@requires_auth()\nasync def get_profile(_external_access_token: str | None = None) -&gt; dict:\n    \"\"\"Get user profile.\"\"\"\n    # Token is automatically injected\n    assert _external_access_token is not None\n\n    headers = {\"Authorization\": f\"Bearer {_external_access_token}\"}\n    # Use token to call API...\n</code></pre>"},{"location":"oauth/protected-tools/#scope-based-access","title":"Scope-Based Access","text":"<p>Require specific scopes:</p> <pre><code>@mcp.tool\n@requires_auth(scopes=[\"posts.write\"])\nasync def publish_post(content: str, _external_access_token: str | None = None):\n    \"\"\"Publish post (requires posts.write scope).\"\"\"\n    ...\n\n@mcp.tool\n@requires_auth(scopes=[\"profile.read\"])\nasync def get_profile(_external_access_token: str | None = None):\n    \"\"\"Get profile (requires profile.read scope).\"\"\"\n    ...\n</code></pre>"},{"location":"oauth/protected-tools/#error-handling","title":"Error Handling","text":"<pre><code>@mcp.tool\n@requires_auth()\nasync def call_api(\n    endpoint: str,\n    _external_access_token: str | None = None\n) -&gt; dict:\n    \"\"\"Call external API.\"\"\"\n    import httpx\n\n    try:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(\n                f\"https://api.example.com/{endpoint}\",\n                headers={\"Authorization\": f\"Bearer {_external_access_token}\"}\n            )\n            response.raise_for_status()\n            return {\"status\": \"success\", \"data\": response.json()}\n    except httpx.HTTPStatusError as e:\n        if e.response.status_code == 401:\n            return {\"status\": \"error\", \"error\": \"Unauthorized - token may be expired\"}\n        return {\"status\": \"error\", \"error\": str(e)}\n</code></pre>"},{"location":"oauth/protected-tools/#complete-example","title":"Complete Example","text":"<pre><code>from chuk_mcp_server import ChukMCPServer, requires_auth\nfrom chuk_mcp_server.oauth import OAuthMiddleware\nfrom my_provider import MyOAuthProvider\n\nmcp = ChukMCPServer(\"social-app\")\n\n@mcp.tool\n@requires_auth(scopes=[\"posts.write\"])\nasync def create_post(\n    content: str,\n    visibility: str = \"PUBLIC\",\n    _external_access_token: str | None = None\n) -&gt; dict:\n    \"\"\"Create a new post.\"\"\"\n    import httpx\n\n    async with httpx.AsyncClient() as client:\n        response = await client.post(\n            \"https://api.example.com/v1/posts\",\n            headers={\"Authorization\": f\"Bearer {_external_access_token}\"},\n            json={\"content\": content, \"visibility\": visibility}\n        )\n        return response.json()\n\n@mcp.tool\n@requires_auth(scopes=[\"profile.read\"])\nasync def get_my_profile(_external_access_token: str | None = None) -&gt; dict:\n    \"\"\"Get current user's profile.\"\"\"\n    import httpx\n\n    async with httpx.AsyncClient() as client:\n        response = await client.get(\n            \"https://api.example.com/v1/me\",\n            headers={\"Authorization\": f\"Bearer {_external_access_token}\"}\n        )\n        return response.json()\n\n# Setup OAuth\ndef setup_oauth():\n    provider = MyOAuthProvider(\n        client_id=\"your-client-id\",\n        client_secret=\"your-client-secret\",\n        redirect_uri=\"http://localhost:8000/oauth/callback\"\n    )\n\n    return OAuthMiddleware(\n        mcp_server=mcp,\n        provider=provider,\n        oauth_server_url=\"http://localhost:8000\",\n        scopes_supported=[\"posts.write\", \"profile.read\"],\n    )\n\nmcp.run(transport=\"http\", port=8000, post_register_hook=setup_oauth)\n</code></pre>"},{"location":"oauth/protected-tools/#next-steps","title":"Next Steps","text":"<ul> <li>Token Management - Understanding token lifecycle</li> <li>Custom Providers - Build your own provider</li> <li>OAuth Overview - Complete OAuth guide</li> </ul>"},{"location":"oauth/tokens/","title":"Token Management","text":"<p>Understanding how ChukMCPServer manages OAuth tokens.</p>"},{"location":"oauth/tokens/#token-types","title":"Token Types","text":""},{"location":"oauth/tokens/#1-authorization-codes","title":"1. Authorization Codes","text":"<p>Temporary codes exchanged for access tokens.</p> <p>Lifetime: 10 minutes (default)</p> <pre><code>export OAUTH_AUTH_CODE_TTL=600  # 10 minutes\n</code></pre>"},{"location":"oauth/tokens/#2-access-tokens","title":"2. Access Tokens","text":"<p>Short-lived tokens for API calls.</p> <p>Lifetime: 15 minutes (default)</p> <pre><code>export OAUTH_ACCESS_TOKEN_TTL=900  # 15 minutes\n</code></pre>"},{"location":"oauth/tokens/#3-refresh-tokens","title":"3. Refresh Tokens","text":"<p>Used to obtain new access tokens.</p> <p>Lifetime: 1 day (default)</p> <pre><code>export OAUTH_REFRESH_TOKEN_TTL=86400  # 1 day\n</code></pre>"},{"location":"oauth/tokens/#4-external-tokens","title":"4. External Tokens","text":"<p>Tokens from external providers (Google, LinkedIn, etc.).</p> <p>Lifetime: 60 days (default, auto-refreshed)</p> <pre><code>export OAUTH_EXTERNAL_TOKEN_TTL=5184000  # 60 days\n</code></pre>"},{"location":"oauth/tokens/#token-storage","title":"Token Storage","text":""},{"location":"oauth/tokens/#development-memory","title":"Development (Memory)","text":"<pre><code>from chuk_mcp_server.oauth import TokenStore\n\n# Automatic - no configuration needed\ntoken_store = TokenStore(sandbox_id=\"my-app\")\n</code></pre>"},{"location":"oauth/tokens/#production-redis","title":"Production (Redis)","text":"<pre><code>export SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379/0\n</code></pre> <pre><code># Automatically uses Redis\ntoken_store = TokenStore(sandbox_id=\"my-app\")\n</code></pre>"},{"location":"oauth/tokens/#token-lifecycle","title":"Token Lifecycle","text":""},{"location":"oauth/tokens/#1-authorization-flow","title":"1. Authorization Flow","text":"<pre><code>Client \u2192 /oauth/authorize\n  \u2193\nServer generates auth code (10 min TTL)\n  \u2193\nClient \u2192 /oauth/token (exchanges code)\n  \u2193\nServer returns access + refresh tokens\n</code></pre>"},{"location":"oauth/tokens/#2-token-refresh","title":"2. Token Refresh","text":"<pre><code>Client \u2192 /oauth/token (with refresh token)\n  \u2193\nServer validates refresh token\n  \u2193\nServer returns new access + refresh tokens\n</code></pre>"},{"location":"oauth/tokens/#3-external-token-refresh","title":"3. External Token Refresh","text":"<pre><code>Tool call \u2192 validate access token\n  \u2193\nCheck external token expiry\n  \u2193\nIf expired: refresh with external provider\n  \u2193\nUpdate stored token\n  \u2193\nInject into tool\n</code></pre>"},{"location":"oauth/tokens/#configuration","title":"Configuration","text":"<p>All TTLs are configurable via environment variables:</p> <pre><code># Authorization codes\nexport OAUTH_AUTH_CODE_TTL=600              # 10 minutes\n\n# Access tokens\nexport OAUTH_ACCESS_TOKEN_TTL=900           # 15 minutes\n\n# Refresh tokens\nexport OAUTH_REFRESH_TOKEN_TTL=86400        # 1 day\n\n# External tokens\nexport OAUTH_EXTERNAL_TOKEN_TTL=5184000     # 60 days\n</code></pre>"},{"location":"oauth/tokens/#security-best-practices","title":"Security Best Practices","text":""},{"location":"oauth/tokens/#1-short-access-token-ttl","title":"1. Short Access Token TTL","text":"<p>Keep access tokens short-lived:</p> <pre><code>export OAUTH_ACCESS_TOKEN_TTL=900  # 15 minutes max\n</code></pre>"},{"location":"oauth/tokens/#2-rotate-refresh-tokens","title":"2. Rotate Refresh Tokens","text":"<p>New refresh token issued on each refresh:</p> <pre><code># Automatic - new refresh token returned\n</code></pre>"},{"location":"oauth/tokens/#3-secure-storage","title":"3. Secure Storage","text":"<p>Use Redis in production:</p> <pre><code>export SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379/0\n</code></pre>"},{"location":"oauth/tokens/#4-sandbox-isolation","title":"4. Sandbox Isolation","text":"<p>Isolate tokens by tenant:</p> <pre><code>token_store = TokenStore(sandbox_id=f\"app-{tenant_id}\")\n</code></pre>"},{"location":"oauth/tokens/#monitoring","title":"Monitoring","text":""},{"location":"oauth/tokens/#check-token-stats","title":"Check Token Stats","text":"<pre><code># In your provider\nstats = await token_store.get_stats()\nprint(f\"Active tokens: {stats['active_tokens']}\")\n</code></pre>"},{"location":"oauth/tokens/#cleanup-expired-tokens","title":"Cleanup Expired Tokens","text":"<p>Automatic in Redis (uses TTL). Manual cleanup for memory store:</p> <pre><code># Called automatically, but can trigger manually\nawait token_store.cleanup_expired()\n</code></pre>"},{"location":"oauth/tokens/#next-steps","title":"Next Steps","text":"<ul> <li>Protected Tools - Using tokens in tools</li> <li>Custom Providers - Implementing providers</li> <li>OAuth Overview - Complete guide</li> </ul>"},{"location":"performance/benchmarks/","title":"Performance Benchmarks","text":"<p>ChukMCPServer achieves world-class performance.</p>"},{"location":"performance/benchmarks/#results","title":"Results","text":"Metric Value Peak Throughput 36,348 RPS Average Latency 2.74ms p50 Latency 2-3ms p95 Latency 5-6ms Success Rate 100%"},{"location":"performance/benchmarks/#test-setup","title":"Test Setup","text":"<ul> <li>Transport: HTTP + SSE</li> <li>Hardware: MacBook Pro M2 Pro</li> <li>Python: 3.11.10</li> <li>Concurrency: 100 connections</li> <li>Duration: 60s with 10s warmup</li> </ul>"},{"location":"performance/benchmarks/#run-benchmarks","title":"Run Benchmarks","text":"<pre><code>python benchmarks/ultra_minimal_mcp_performance_test.py\n</code></pre>"},{"location":"performance/benchmarks/#next-steps","title":"Next Steps","text":"<ul> <li>Optimization Guide - Improve performance</li> <li>Comparison - vs other frameworks</li> <li>HTTP Mode - Configuration</li> </ul>"},{"location":"performance/comparison/","title":"Framework Comparison","text":"<p>How ChukMCPServer compares to alternatives.</p>"},{"location":"performance/comparison/#performance","title":"Performance","text":"<p>ChukMCPServer achieves: - 36,000+ RPS peak throughput - &lt;3ms average latency - 100% success rate under load</p>"},{"location":"performance/comparison/#vs-official-mcp-sdk","title":"vs Official MCP SDK","text":"<ul> <li>Performance: ChukMCPServer optimized for throughput</li> <li>Features: Built-in OAuth 2.1, cloud detection</li> <li>Developer UX: Decorator-based API</li> </ul>"},{"location":"performance/comparison/#vs-fastmcp","title":"vs FastMCP","text":"<ul> <li>Performance: Further optimized JSON-RPC path</li> <li>OAuth: Built-in OAuth 2.1 support</li> <li>Cloud: Auto-detection and adapters</li> </ul>"},{"location":"performance/comparison/#vs-typical-frameworks","title":"vs Typical Frameworks","text":"<p>Most add 5-50ms overhead per tool call. ChukMCPServer delivers &lt;3ms through: - Async I/O - Pre-serialization - uvloop optimization</p>"},{"location":"performance/comparison/#next-steps","title":"Next Steps","text":"<ul> <li>Benchmarks - Detailed results</li> <li>Optimization - Tuning guide</li> <li>Getting Started - Try it</li> </ul>"},{"location":"performance/optimization/","title":"Performance Optimization","text":"<p>Optimize your MCP server for maximum throughput.</p>"},{"location":"performance/optimization/#use-multiple-workers","title":"Use Multiple Workers","text":"<pre><code>mcp.run(workers=4)\n</code></pre>"},{"location":"performance/optimization/#enable-uvloop","title":"Enable uvloop","text":"<p>Automatically enabled on Linux/macOS:</p> <pre><code>pip install uvloop\n</code></pre>"},{"location":"performance/optimization/#use-async-tools","title":"Use Async Tools","text":"<p>For I/O-bound operations:</p> <pre><code>@tool\nasync def fetch_data(url: str):\n    async with httpx.AsyncClient() as client:\n        return await client.get(url)\n</code></pre>"},{"location":"performance/optimization/#redis-for-sessions","title":"Redis for Sessions","text":"<p>In production:</p> <pre><code>export SESSION_PROVIDER=redis\nexport SESSION_REDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"performance/optimization/#next-steps","title":"Next Steps","text":"<ul> <li>Benchmarks - Performance results</li> <li>Production Guide - Best practices</li> <li>HTTP Mode - Configuration</li> </ul>"},{"location":"tools/async/","title":"Async Tools","text":"<p>Handle asynchronous operations like HTTP requests, database queries, and file I/O.</p>"},{"location":"tools/async/#basic-async-tool","title":"Basic Async Tool","text":"<pre><code>from chuk_mcp_server import tool\nimport httpx\n\n@tool\nasync def fetch_data(url: str) -&gt; dict:\n    \"\"\"Fetch data from a URL.\"\"\"\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.json()\n</code></pre>"},{"location":"tools/async/#why-use-async","title":"Why Use Async?","text":"<ul> <li>HTTP requests - Non-blocking API calls</li> <li>Database queries - Concurrent database access</li> <li>File I/O - Async file operations</li> <li>Multiple operations - Parallel execution</li> </ul>"},{"location":"tools/async/#http-requests","title":"HTTP Requests","text":"<pre><code>import httpx\n\n@tool\nasync def get_weather(city: str) -&gt; dict:\n    \"\"\"Get weather for a city.\"\"\"\n    async with httpx.AsyncClient() as client:\n        response = await client.get(\n            f\"https://api.weather.com/v1/weather?city={city}\"\n        )\n        return response.json()\n</code></pre>"},{"location":"tools/async/#database-operations","title":"Database Operations","text":"<pre><code>import aiosqlite\n\n@tool\nasync def get_user(user_id: int) -&gt; dict:\n    \"\"\"Get user from database.\"\"\"\n    async with aiosqlite.connect(\"database.db\") as db:\n        cursor = await db.execute(\n            \"SELECT * FROM users WHERE id = ?\", (user_id,)\n        )\n        row = await cursor.fetchone()\n        return {\"id\": row[0], \"name\": row[1]}\n</code></pre>"},{"location":"tools/async/#parallel-operations","title":"Parallel Operations","text":"<pre><code>import asyncio\nimport httpx\n\n@tool\nasync def fetch_multiple(urls: list[str]) -&gt; list:\n    \"\"\"Fetch multiple URLs in parallel.\"\"\"\n    async with httpx.AsyncClient() as client:\n        tasks = [client.get(url) for url in urls]\n        responses = await asyncio.gather(*tasks)\n        return [r.json() for r in responses]\n</code></pre>"},{"location":"tools/async/#error-handling","title":"Error Handling","text":"<pre><code>@tool\nasync def safe_fetch(url: str) -&gt; dict:\n    \"\"\"Fetch with error handling.\"\"\"\n    try:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url, timeout=5.0)\n            response.raise_for_status()\n            return {\"status\": \"success\", \"data\": response.json()}\n    except httpx.TimeoutException:\n        return {\"status\": \"error\", \"error\": \"Request timed out\"}\n    except httpx.HTTPStatusError as e:\n        return {\"status\": \"error\", \"error\": f\"HTTP {e.response.status_code}\"}\n</code></pre>"},{"location":"tools/async/#next-steps","title":"Next Steps","text":"<ul> <li>Basic Tools - Synchronous tools</li> <li>Type Validation - Type system</li> <li>Error Handling - Error patterns</li> </ul>"},{"location":"tools/basic/","title":"Building Tools","text":"<p>Tools are the core of MCP - they're Python functions that Claude can call to perform actions. With ChukMCPServer, creating tools is as simple as adding a decorator.</p>"},{"location":"tools/basic/#your-first-tool","title":"Your First Tool","text":"<p>The simplest tool is just a function with <code>@tool</code>:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef greet(name: str) -&gt; str:\n    \"\"\"Greet someone by name.\"\"\"\n    return f\"Hello, {name}!\"\n\nrun()\n</code></pre> <p>That's it! Claude can now call your <code>greet</code> tool.</p>"},{"location":"tools/basic/#tool-anatomy","title":"Tool Anatomy","text":"<p>Every tool has:</p> <ol> <li>Decorator: <code>@tool</code> marks the function as a tool</li> <li>Function name: Becomes the tool name (e.g., <code>greet</code>)</li> <li>Parameters: Define what inputs the tool accepts</li> <li>Type hints: Automatically validated</li> <li>Docstring: Becomes the tool description (shown to Claude)</li> <li>Return value: What Claude receives back</li> </ol> <pre><code>@tool\ndef calculate_tip(bill: float, tip_percent: float = 15.0) -&gt; dict:\n    \"\"\"\n    Calculate tip amount and total bill.\n\n    Args:\n        bill: Total bill amount before tip\n        tip_percent: Tip percentage (default: 15%)\n\n    Returns:\n        Dictionary with tip amount and total\n    \"\"\"\n    tip = bill * (tip_percent / 100)\n    total = bill + tip\n\n    return {\n        \"bill\": bill,\n        \"tip_percent\": tip_percent,\n        \"tip_amount\": round(tip, 2),\n        \"total\": round(total, 2)\n    }\n</code></pre>"},{"location":"tools/basic/#type-validation","title":"Type Validation","text":"<p>ChukMCPServer automatically validates all inputs based on type hints:</p> <pre><code>@tool\ndef add_numbers(a: int, b: int) -&gt; int:\n    \"\"\"Add two integers.\"\"\"\n    return a + b\n\n# Claude calls with: add_numbers(5, \"hello\")\n# \u274c Automatic error: \"Expected int, got str for parameter 'b'\"\n</code></pre>"},{"location":"tools/basic/#supported-types","title":"Supported Types","text":"Type Example Validation <code>int</code> <code>42</code> Must be integer <code>float</code> <code>3.14</code> Must be number <code>str</code> <code>\"hello\"</code> Must be string <code>bool</code> <code>True</code> Must be boolean <code>list</code> <code>[1, 2, 3]</code> Must be array <code>dict</code> <code>{\"key\": \"value\"}</code> Must be object <code>Optional[T]</code> <code>None</code> or <code>T</code> Can be null <code>Union[A, B]</code> <code>A</code> or <code>B</code> Either type"},{"location":"tools/basic/#complex-types","title":"Complex Types","text":"<pre><code>from typing import Optional, List, Dict\n\n@tool\ndef process_data(\n    items: List[str],\n    options: Optional[Dict[str, Any]] = None,\n    threshold: float = 0.5\n) -&gt; Dict[str, Any]:\n    \"\"\"Process a list of items with options.\"\"\"\n    if options is None:\n        options = {}\n\n    return {\n        \"processed\": len(items),\n        \"threshold\": threshold,\n        \"options\": options\n    }\n</code></pre>"},{"location":"tools/basic/#default-values","title":"Default Values","text":"<p>Provide sensible defaults for optional parameters:</p> <pre><code>@tool\ndef search(\n    query: str,\n    limit: int = 10,\n    sort_by: str = \"relevance\"\n) -&gt; list:\n    \"\"\"\n    Search for items.\n\n    Args:\n        query: Search query (required)\n        limit: Maximum results to return (default: 10)\n        sort_by: Sort order (default: relevance)\n    \"\"\"\n    # Implementation\n    return [...]\n</code></pre> <p>Claude can call this as: - <code>search(\"python\")</code> - Uses defaults - <code>search(\"python\", 20)</code> - Custom limit - <code>search(\"python\", limit=5, sort_by=\"date\")</code> - Named args</p>"},{"location":"tools/basic/#return-values","title":"Return Values","text":""},{"location":"tools/basic/#simple-returns","title":"Simple Returns","text":"<pre><code>@tool\ndef get_status() -&gt; str:\n    \"\"\"Get system status.\"\"\"\n    return \"All systems operational\"\n</code></pre>"},{"location":"tools/basic/#structured-returns","title":"Structured Returns","text":"<p>Better to return structured data:</p> <pre><code>@tool\ndef get_status() -&gt; dict:\n    \"\"\"Get detailed system status.\"\"\"\n    return {\n        \"status\": \"operational\",\n        \"uptime\": 12345,\n        \"load\": 0.42,\n        \"services\": {\n            \"database\": \"healthy\",\n            \"cache\": \"healthy\",\n            \"queue\": \"degraded\"\n        }\n    }\n</code></pre>"},{"location":"tools/basic/#lists","title":"Lists","text":"<pre><code>@tool\ndef list_users() -&gt; list:\n    \"\"\"Get all users.\"\"\"\n    return [\n        {\"id\": 1, \"name\": \"Alice\", \"role\": \"admin\"},\n        {\"id\": 2, \"name\": \"Bob\", \"role\": \"user\"},\n    ]\n</code></pre>"},{"location":"tools/basic/#error-handling","title":"Error Handling","text":""},{"location":"tools/basic/#raising-errors","title":"Raising Errors","text":"<pre><code>@tool\ndef divide(a: float, b: float) -&gt; float:\n    \"\"\"Divide two numbers.\"\"\"\n    if b == 0:\n        raise ValueError(\"Cannot divide by zero\")\n    return a / b\n</code></pre>"},{"location":"tools/basic/#try-except","title":"Try-Except","text":"<pre><code>@tool\ndef fetch_user(user_id: int) -&gt; dict:\n    \"\"\"Fetch user by ID.\"\"\"\n    try:\n        # Database query\n        user = database.get_user(user_id)\n        if not user:\n            return {\n                \"status\": \"not_found\",\n                \"error\": f\"User {user_id} not found\"\n            }\n        return {\n            \"status\": \"success\",\n            \"user\": user\n        }\n    except DatabaseError as e:\n        return {\n            \"status\": \"error\",\n            \"error\": str(e)\n        }\n</code></pre>"},{"location":"tools/basic/#custom-error-messages","title":"Custom Error Messages","text":"<pre><code>@tool\ndef update_settings(key: str, value: str) -&gt; dict:\n    \"\"\"Update a setting.\"\"\"\n    valid_keys = [\"theme\", \"language\", \"timezone\"]\n\n    if key not in valid_keys:\n        raise ValueError(\n            f\"Invalid key '{key}'. Must be one of: {', '.join(valid_keys)}\"\n        )\n\n    # Save setting\n    return {\"key\": key, \"value\": value, \"updated\": True}\n</code></pre>"},{"location":"tools/basic/#multiple-tools","title":"Multiple Tools","text":"<p>Register multiple tools in one server:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef add(a: int, b: int) -&gt; int:\n    \"\"\"Add two numbers.\"\"\"\n    return a + b\n\n@tool\ndef subtract(a: int, b: int) -&gt; int:\n    \"\"\"Subtract b from a.\"\"\"\n    return a - b\n\n@tool\ndef multiply(a: int, b: int) -&gt; int:\n    \"\"\"Multiply two numbers.\"\"\"\n    return a * b\n\n@tool\ndef divide(a: float, b: float) -&gt; float:\n    \"\"\"Divide a by b.\"\"\"\n    if b == 0:\n        raise ValueError(\"Cannot divide by zero\")\n    return a / b\n\nrun()  # All 4 tools available\n</code></pre>"},{"location":"tools/basic/#naming-conventions","title":"Naming Conventions","text":""},{"location":"tools/basic/#tool-names","title":"Tool Names","text":"<p>Tool names are automatically derived from function names:</p> <pre><code>@tool\ndef get_user():  # Tool name: \"get_user\"\n    ...\n\n@tool\ndef calculateTax():  # Tool name: \"calculateTax\" (not recommended)\n    ...\n</code></pre> <p>Best practice: Use <code>snake_case</code> for consistency:</p> <pre><code>@tool\ndef calculate_tax():  # \u2705 Good\n    ...\n\n@tool\ndef fetchUserData():  # \u274c Inconsistent\n    ...\n</code></pre>"},{"location":"tools/basic/#custom-tool-names","title":"Custom Tool Names","text":"<p>Override the auto-generated name:</p> <pre><code>@tool(name=\"greet_user\")\ndef complex_greeting_function(name: str) -&gt; str:\n    \"\"\"Greet a user.\"\"\"\n    return f\"Hello, {name}!\"\n</code></pre>"},{"location":"tools/basic/#documentation","title":"Documentation","text":""},{"location":"tools/basic/#docstrings","title":"Docstrings","text":"<p>Write clear docstrings - Claude sees them:</p> <pre><code>@tool\ndef search_products(\n    query: str,\n    category: Optional[str] = None,\n    max_price: Optional[float] = None\n) -&gt; list:\n    \"\"\"\n    Search for products in the catalog.\n\n    This tool searches the product database and returns matching items.\n    You can filter by category and maximum price.\n\n    Args:\n        query: Search query (product name, description, or keywords)\n        category: Optional category filter (e.g., \"electronics\", \"books\")\n        max_price: Maximum price in USD (e.g., 99.99)\n\n    Returns:\n        List of matching products with name, price, and category\n\n    Examples:\n        - search_products(\"laptop\") - Find all laptops\n        - search_products(\"laptop\", category=\"electronics\", max_price=1000)\n    \"\"\"\n    # Implementation\n    ...\n</code></pre>"},{"location":"tools/basic/#parameter-descriptions","title":"Parameter Descriptions","text":"<p>Use clear, concise descriptions:</p> <pre><code>@tool\ndef create_user(\n    username: str,      # Short, unique username (3-20 chars)\n    email: str,         # Valid email address\n    role: str = \"user\"  # User role: \"admin\", \"user\", or \"guest\"\n) -&gt; dict:\n    \"\"\"Create a new user account.\"\"\"\n    ...\n</code></pre>"},{"location":"tools/basic/#tool-organization","title":"Tool Organization","text":""},{"location":"tools/basic/#global-api-simple","title":"Global API (Simple)","text":"<p>For quick scripts:</p> <pre><code>from chuk_mcp_server import tool, run\n\n@tool\ndef tool1():\n    ...\n\n@tool\ndef tool2():\n    ...\n\nrun()\n</code></pre>"},{"location":"tools/basic/#server-based-api-recommended","title":"Server-Based API (Recommended)","text":"<p>For larger applications:</p> <pre><code>from chuk_mcp_server import ChukMCPServer\n\nmcp = ChukMCPServer(\"my-app\")\n\n@mcp.tool\ndef tool1():\n    ...\n\n@mcp.tool\ndef tool2():\n    ...\n\nif __name__ == \"__main__\":\n    mcp.run()\n</code></pre>"},{"location":"tools/basic/#modular-organization","title":"Modular Organization","text":"<pre><code># tools/math.py\ndef register_math_tools(mcp):\n    @mcp.tool\n    def add(a: int, b: int) -&gt; int:\n        return a + b\n\n    @mcp.tool\n    def multiply(a: int, b: int) -&gt; int:\n        return a * b\n\n# tools/string.py\ndef register_string_tools(mcp):\n    @mcp.tool\n    def uppercase(text: str) -&gt; str:\n        return text.upper()\n\n    @mcp.tool\n    def reverse(text: str) -&gt; str:\n        return text[::-1]\n\n# main.py\nfrom chuk_mcp_server import ChukMCPServer\nfrom tools.math import register_math_tools\nfrom tools.string import register_string_tools\n\nmcp = ChukMCPServer(\"my-app\")\n\nregister_math_tools(mcp)\nregister_string_tools(mcp)\n\nmcp.run()\n</code></pre>"},{"location":"tools/basic/#best-practices","title":"Best Practices","text":""},{"location":"tools/basic/#1-single-responsibility","title":"1. Single Responsibility","text":"<p>Each tool should do one thing well:</p> <pre><code># \u274c Bad: Tool does too much\n@tool\ndef manage_user(action: str, user_id: int, data: dict) -&gt; dict:\n    if action == \"create\":\n        ...\n    elif action == \"update\":\n        ...\n    elif action == \"delete\":\n        ...\n\n# \u2705 Good: Separate tools\n@tool\ndef create_user(username: str, email: str) -&gt; dict:\n    ...\n\n@tool\ndef update_user(user_id: int, data: dict) -&gt; dict:\n    ...\n\n@tool\ndef delete_user(user_id: int) -&gt; dict:\n    ...\n</code></pre>"},{"location":"tools/basic/#2-descriptive-names","title":"2. Descriptive Names","text":"<p>Use clear, action-oriented names:</p> <pre><code># \u274c Bad\n@tool\ndef user(id: int):\n    ...\n\n# \u2705 Good\n@tool\ndef get_user(user_id: int):\n    ...\n\n@tool\ndef fetch_user_profile(user_id: int):\n    ...\n</code></pre>"},{"location":"tools/basic/#3-type-everything","title":"3. Type Everything","text":"<p>Always use type hints:</p> <pre><code># \u274c Bad\n@tool\ndef process(data):\n    ...\n\n# \u2705 Good\n@tool\ndef process_data(data: dict) -&gt; dict:\n    ...\n</code></pre>"},{"location":"tools/basic/#4-handle-errors-gracefully","title":"4. Handle Errors Gracefully","text":"<p>Return structured error information:</p> <pre><code>@tool\ndef risky_operation(param: str) -&gt; dict:\n    \"\"\"Perform a risky operation.\"\"\"\n    try:\n        result = do_something_risky(param)\n        return {\n            \"status\": \"success\",\n            \"result\": result\n        }\n    except SpecificError as e:\n        return {\n            \"status\": \"error\",\n            \"error_type\": \"specific_error\",\n            \"message\": str(e)\n        }\n    except Exception as e:\n        return {\n            \"status\": \"error\",\n            \"error_type\": \"unknown\",\n            \"message\": \"An unexpected error occurred\"\n        }\n</code></pre>"},{"location":"tools/basic/#5-use-enums-for-fixed-sets","title":"5. Use Enums for Fixed Sets","text":"<pre><code>from enum import Enum\n\nclass Status(str, Enum):\n    ACTIVE = \"active\"\n    INACTIVE = \"inactive\"\n    PENDING = \"pending\"\n\n@tool\ndef update_status(user_id: int, status: Status) -&gt; dict:\n    \"\"\"Update user status.\"\"\"\n    # status is guaranteed to be valid\n    return {\"user_id\": user_id, \"status\": status.value}\n</code></pre>"},{"location":"tools/basic/#next-steps","title":"Next Steps","text":"<ul> <li>Async Tools - Handle async operations</li> <li>Type Validation - Advanced type system</li> <li>Error Handling - Robust error handling</li> <li>Testing Tools - Test your tools</li> <li>Examples - Real-world examples</li> </ul>"},{"location":"tools/errors/","title":"Error Handling","text":"<p>Best practices for handling errors in MCP tools.</p>"},{"location":"tools/errors/#return-error-objects","title":"Return Error Objects","text":"<p>Prefer returning error information over raising exceptions:</p> <pre><code>@tool\ndef divide(a: float, b: float) -&gt; dict:\n    \"\"\"Divide with error handling.\"\"\"\n    if b == 0:\n        return {\n            \"status\": \"error\",\n            \"error\": \"Cannot divide by zero\"\n        }\n\n    return {\n        \"status\": \"success\",\n        \"result\": a / b\n    }\n</code></pre>"},{"location":"tools/errors/#try-except-patterns","title":"Try-Except Patterns","text":"<pre><code>@tool\ndef fetch_user(user_id: int) -&gt; dict:\n    \"\"\"Fetch user with error handling.\"\"\"\n    try:\n        user = database.get(user_id)\n        if not user:\n            return {\"status\": \"not_found\"}\n\n        return {\"status\": \"success\", \"user\": user}\n    except DatabaseError as e:\n        return {\"status\": \"error\", \"error\": str(e)}\n</code></pre>"},{"location":"tools/errors/#validation-errors","title":"Validation Errors","text":"<pre><code>@tool\ndef update_settings(key: str, value: str) -&gt; dict:\n    \"\"\"Update setting with validation.\"\"\"\n    valid_keys = [\"theme\", \"language\"]\n\n    if key not in valid_keys:\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Invalid key. Must be one of: {', '.join(valid_keys)}\"\n        }\n\n    # Update setting...\n    return {\"status\": \"success\", \"key\": key, \"value\": value}\n</code></pre>"},{"location":"tools/errors/#structured-errors","title":"Structured Errors","text":"<pre><code>from enum import Enum\n\nclass ErrorCode(str, Enum):\n    NOT_FOUND = \"not_found\"\n    INVALID_INPUT = \"invalid_input\"\n    PERMISSION_DENIED = \"permission_denied\"\n\n@tool\ndef get_resource(resource_id: str) -&gt; dict:\n    \"\"\"Get resource with structured errors.\"\"\"\n    if not resource_id:\n        return {\n            \"status\": \"error\",\n            \"code\": ErrorCode.INVALID_INPUT,\n            \"message\": \"Resource ID is required\"\n        }\n\n    resource = find_resource(resource_id)\n    if not resource:\n        return {\n            \"status\": \"error\",\n            \"code\": ErrorCode.NOT_FOUND,\n            \"message\": f\"Resource {resource_id} not found\"\n        }\n\n    return {\"status\": \"success\", \"resource\": resource}\n</code></pre>"},{"location":"tools/errors/#next-steps","title":"Next Steps","text":"<ul> <li>Basic Tools - Tool fundamentals</li> <li>Testing - Test error cases</li> <li>Examples - Real examples</li> </ul>"},{"location":"tools/testing/","title":"Testing Tools","text":"<p>Test your MCP tools to ensure reliability.</p>"},{"location":"tools/testing/#basic-testing","title":"Basic Testing","text":"<pre><code>import pytest\nfrom my_server import mcp\n\ndef test_add():\n    \"\"\"Test addition tool.\"\"\"\n    tool = mcp._tool_handlers[\"add\"].func\n    assert tool(5, 3) == 8\n    assert tool(-5, 3) == -2\n</code></pre>"},{"location":"tools/testing/#testing-async-tools","title":"Testing Async Tools","text":"<pre><code>import pytest\n\n@pytest.mark.asyncio\nasync def test_fetch_data():\n    \"\"\"Test async tool.\"\"\"\n    tool = mcp._tool_handlers[\"fetch_data\"].func\n    result = await tool(\"https://api.example.com/data\")\n    assert result[\"status\"] == \"success\"\n</code></pre>"},{"location":"tools/testing/#mocking-external-apis","title":"Mocking External APIs","text":"<pre><code>from unittest.mock import patch, AsyncMock\n\n@pytest.mark.asyncio\nasync def test_api_call():\n    \"\"\"Test tool with mocked API.\"\"\"\n    tool = mcp._tool_handlers[\"fetch_weather\"].func\n\n    with patch(\"httpx.AsyncClient.get\") as mock_get:\n        mock_response = AsyncMock()\n        mock_response.json.return_value = {\"temp\": 72}\n        mock_get.return_value = mock_response\n\n        result = await tool(\"San Francisco\")\n        assert result[\"temp\"] == 72\n</code></pre>"},{"location":"tools/testing/#testing-error-cases","title":"Testing Error Cases","text":"<pre><code>def test_divide_by_zero():\n    \"\"\"Test division by zero.\"\"\"\n    tool = mcp._tool_handlers[\"divide\"].func\n    result = tool(10, 0)\n    assert result[\"status\"] == \"error\"\n    assert \"zero\" in result[\"error\"].lower()\n</code></pre>"},{"location":"tools/testing/#integration-tests","title":"Integration Tests","text":"<pre><code>import httpx\n\n@pytest.mark.asyncio\nasync def test_server_integration():\n    \"\"\"Test full server integration.\"\"\"\n    async with httpx.AsyncClient() as client:\n        response = await client.post(\n            \"http://localhost:8000/mcp\",\n            json={\n                \"jsonrpc\": \"2.0\",\n                \"id\": 1,\n                \"method\": \"tools/call\",\n                \"params\": {\n                    \"name\": \"add\",\n                    \"arguments\": {\"a\": 5, \"b\": 3}\n                }\n            }\n        )\n        result = response.json()\n        assert result[\"result\"] == 8\n</code></pre>"},{"location":"tools/testing/#next-steps","title":"Next Steps","text":"<ul> <li>Basic Tools - Build tools</li> <li>Error Handling - Handle errors</li> <li>Examples - Complete examples</li> </ul>"},{"location":"tools/types/","title":"Type Validation","text":"<p>ChukMCPServer automatically validates all tool inputs based on Python type hints.</p>"},{"location":"tools/types/#supported-types","title":"Supported Types","text":"Type Example Validation <code>int</code> <code>42</code> Must be integer <code>float</code> <code>3.14</code> Must be number <code>str</code> <code>\"hello\"</code> Must be string <code>bool</code> <code>True</code> Must be boolean <code>list</code> <code>[1, 2, 3]</code> Must be array <code>dict</code> <code>{\"key\": \"value\"}</code> Must be object"},{"location":"tools/types/#optional-parameters","title":"Optional Parameters","text":"<pre><code>from typing import Optional\n\n@tool\ndef greet(name: str, title: Optional[str] = None) -&gt; str:\n    \"\"\"Greet with optional title.\"\"\"\n    if title:\n        return f\"Hello, {title} {name}\"\n    return f\"Hello, {name}\"\n</code></pre>"},{"location":"tools/types/#union-types","title":"Union Types","text":"<pre><code>from typing import Union\n\n@tool\ndef process(value: Union[int, str]) -&gt; str:\n    \"\"\"Process int or string.\"\"\"\n    return str(value)\n</code></pre>"},{"location":"tools/types/#complex-types","title":"Complex Types","text":"<pre><code>from typing import List, Dict, Any\n\n@tool\ndef analyze(\n    items: List[str],\n    options: Dict[str, Any]\n) -&gt; Dict[str, Any]:\n    \"\"\"Analyze items with options.\"\"\"\n    return {\n        \"count\": len(items),\n        \"options\": options\n    }\n</code></pre>"},{"location":"tools/types/#validation-errors","title":"Validation Errors","text":"<p>Invalid types are rejected automatically:</p> <pre><code>@tool\ndef add(a: int, b: int) -&gt; int:\n    return a + b\n\n# Claude calls: add(5, \"hello\")\n# Error: Expected int for parameter 'b', got str\n</code></pre>"},{"location":"tools/types/#next-steps","title":"Next Steps","text":"<ul> <li>Basic Tools - Tool fundamentals</li> <li>Error Handling - Handle errors</li> <li>Testing - Test your tools</li> </ul>"}]}